!function(e){e.jqx.jqxWidget("jqxTextArea","",{}),e.extend(e.jqx._jqxTextArea.prototype,{defineInstance:function(){var t=this,a={disabled:!1,filter:t._filter,sort:t._sort,highlight:t._highlight,dropDownWidth:null,renderer:t._renderer,opened:!1,$popup:e("<ul></ul>"),source:[],roundedCorners:!0,searchMode:"default",placeHolder:"",width:null,height:null,rtl:!1,displayMember:"",valueMember:"",popupZIndex:2e4,items:8,item:'<li><a href="#"></a></li>',minLength:1,maxLength:null,scrollBarSize:e.jqx.utilities.scrollBarSize,query:"",changeType:null,events:["change","select","open","close"]};e.extend(!0,t,a)},createInstance:function(){var e=this;e.render(),e.isInitialized=!0},render:function(){var t=this,a=t.element.id;if(!0===t.isInitialized)return void t.refresh();15!==e.jqx.utilities.scrollBarSize&&(t.scrollBarSize=e.jqx.utilities.scrollBarSize);var r=e('<div id="panelWrapper'+a+'" style="overflow: hidden; width: 100%; height: 100%; background-color: transparent; -webkit-appearance: none; outline: none; align:left; border: 0px; padding: 0px; margin: 0px; left: 0px; top: 0px; valign:top; position: relative;"></div>'),s=e('<div id="verticalScrollBar'+a+'" style="align: left; valign: top; left: 0px; top: 0px; position: absolute;"></div>');if(t._id=t.element.id,"div"===t.element.tagName.toLowerCase())t._baseHost=t.host,t.host.append(r),r.append('<textarea id="area'+a+'" class="'+t.toThemeProperty("jqx-text-area-element")+'"></textarea>'),r.append(s);else if("textarea"===t.element.tagName.toLowerCase()){t._baseHost=e(t.element),t._baseHost.wrap("<div></div>"),t._baseHost.wrap(r),t._baseHost.after(s);var l=t.host.data();t.host=t._baseHost.parent().parent(),t.host.data(l),t.host[0].style.cssText=t.element.style.cssText,t.element.style.cssText="",t._baseHost.addClass(t.toThemeProperty("jqx-text-area-element"))}var o=t.host;if(t.wrapper=r,t.textarea=o.find("textarea"),t._addClasses(),!o.jqxButton)throw new Error("jqxTextArea: Missing reference to jqxbuttons.js.");if(!o.jqxScrollBar)throw new Error("jqxTextArea: Missing reference to jqxscrollbar.js.");null===t.width&&o[0].style&&null!==o[0].style.width&&(t.width=o[0].style.width),null===t.height&&o[0].style&&null!==o[0].style.height&&(t.height=o[0].style.height),t._setSize(),t.vScrollBar=s,s.jqxScrollBar({vertical:!0,width:15,height:"100%",max:t.height,theme:t.theme}),""===e.trim(t.textarea.val())&&t.textarea.val(""),t.textarea.attr("placeholder",t.placeHolder),null!==t.maxLength&&t.textarea.attr("maxlength",t.maxLength),e.jqx.browser.msie&&e.jqx.browser.version<10&&""===t.textarea.val()&&t.textarea.val(t.placeHolder),(t.source instanceof Array&&t.source.length||t.source._source||e.isFunction(t.source))&&(t._oldsource=t.source,t._updateSource(),t._addPopupClasses(),e.jqx.aria(t,"aria-haspopup",!0)),t._arrange(),t._addHandlers()},refresh:function(e){if(!0!==e){var t=this;t._setSize(),t._arrange(),t._removeHandlers(),t._addHandlers(),!0===t.opened&&t.open()}},_arrange:function(){var e=this,t=e.textarea,a=t[0].scrollHeight-t.height(),r=t[0].scrollHeight-t.height();r<0&&(r=0),e.vScrollBar.jqxScrollBar({max:r,value:t[0].scrollTop}),a<5?(t.width(e.host.width()),e.vScrollBar.css("visibility","hidden")):(t.width(e.host.width()-e.scrollBarSize),e.vScrollBar.css("visibility","visible"),e._arrangeScrollbars(e.scrollBarSize))},val:function(t){var a,r=this,s=r.textarea,l=s[0].value;if(e.jqx.browser.msie&&e.jqx.browser.version<10&&l===r.placeHolder&&(l=""),0===arguments.length||"object"==typeof t&&!0===e.isEmptyObject(t))return""!==r.displayMember&&""!==r.valueMember&&r.selectedItem?""===l?"":r.selectedItem:l;if(t&&t.label){if(r.selectedItem&&t.label===r.selectedItem.label&&t.value===r.selectedItem.value)return t.label;r.selectedItem={label:t.label,value:t.value},r.host.attr("data-value",t.value),r.host.attr("data-label",t.label),s[0].value=t.label,a=t.label}else{if(l===t)return t;s[0].value=t,r.host.attr("data-value",t),r.host.attr("data-label",t),a=t}return r._arrange(),r._raiseEvent("0"),a},focus:function(){this.textarea.focus()},selectAll:function(){var e=this.textarea;setTimeout(function(){if("selectionStart"in e[0])e[0].focus(),e[0].setSelectionRange(0,e[0].value.length);else{var t=e[0].createTextRange();t.collapse(!0),t.moveEnd("character",e[0].value.length),t.moveStart("character",0),t.select()}},10)},_arrangeScrollbars:function(t){var a=this,r=a.host.width(),s=a.host.height(),l=a.vScrollBar,o="hidden"!==l[0].style.visibility;if(l.width(t),l.height(parseInt(s,10)-2+"px"),l.css({left:parseInt(r,10)-parseInt(t,10)-2-2+"px",top:"0px"}),a.rtl){l.css({left:"0px"});var n=o?parseInt(t,10)-2+"px":0;if("rtl"!==a.textarea.children().css("direction")){var i=!1;e.jqx.browser.msie&&e.jqx.browser.version<8&&(i=!0),i||a.textarea.css("padding-left",n)}}else"hidden"!==l.css("visibility")&&a.textarea.css("width",a.host.width()-a.vScrollBar.outerWidth());l.jqxScrollBar("refresh")},destroy:function(){var e=this;e.opened&&e._removeItemHandlers(),e.$popup.remove(),e.vScrollBar.jqxScrollBar("destroy"),e._removeHandlers(),e.host.remove()},propertiesChangedHandler:function(e,t,a){a&&a.width&&a.height&&2==Object.keys(a).length&&(e.host.css("width",e.width),e.host.css("height",e.height),e._arrange())},propertyChangedHandler:function(t,a,r,s){if(void 0!==t.isInitialized&&!1!==t.isInitialized&&!(t.batchUpdate&&t.batchUpdate.width&&t.batchUpdate.height&&2==Object.keys(t.batchUpdate).length)&&s!==r)switch(a){case"theme":t.vScrollBar.jqxScrollBar({theme:t.theme});break;case"width":t.host.css("width",s),t._arrange();break;case"height":t.host.css("height",s),t._arrange();break;case"source":t._oldsource=s,t._updateSource();break;case"displayMember":case"valueMember":t.source=t._oldsource,t._updateSource();break;case"opened":!0===s?t.open():t.close();break;case"maxLength":t.textarea.attr("maxlength",s);break;case"placeHolder":t.textarea.attr("placeholder",s),e.jqx.browser.msie&&e.jqx.browser.version<10&&t.textarea.val()===r&&t.textarea.val(s);break;case"scrollBarSize":t._arrange();break;case"dropDownWidth":t.$popup.width(s);break;case"roundedCorners":!0===s?t.host.add(t.$popup).addClass(t.toThemeProperty("jqx-rc-all")):t.host.add(t.$popup).removeClass(t.toThemeProperty("jqx-rc-all"));break;case"disabled":t.vScrollBar.jqxScrollBar({disabled:s}),!0===s?(t.host.addClass(t.toThemeProperty("jqx-fill-state-disabled")),t.textarea.attr("disabled","")):(t.host.removeClass(t.toThemeProperty("jqx-fill-state-disabled")),t.textarea.removeAttr("disabled")),e.jqx.aria(t,"aria-disabled",s);break;case"rtl":!0===s?t.textarea.addClass(t.toThemeProperty("jqx-text-area-element-rtl")):t.textarea.removeClass(t.toThemeProperty("jqx-text-area-element-rtl")),t._arrange();break;default:t.refresh()}},_raiseEvent:function(t,a){var r=this;void 0===a&&(a={owner:null});var s=r.events[t];a.owner=r;var l=new e.Event(s);l.owner=r,0==t&&(a.type=this.changeType,this.changeType=null),l.args=a,l.preventDefault&&l.preventDefault();var o;return o="change"===s||"div"===r._baseHost[0].tagName.toLowerCase()?r.host:r._baseHost,o.trigger(l)},_addHandlers:function(){var t=this,a=t.element.id,r=t.host,s=t.textarea;e.jqx.utilities.resize(t._baseHost,function(){t._ttimer=setTimeout(function(){t._arrange()},100)},!1,!0);var l=e.jqx.browser.mozilla?"wheel":"mousewheel";t.addHandler(r,l+".jqxTextArea"+a,function(e){t.wheel(e,t)}),t.addHandler(r,"mouseenter.jqxTextArea"+a,function(){t.focused=!0}),t.addHandler(r,"mouseleave.jqxTextArea"+a,function(){t.focused=!1}),t.addHandler(r,"focus.jqxTextArea"+a,function(){t.focused=!0}),t.addHandler(r,"blur.jqxTextArea"+a,function(){t.focused=!1}),t.addHandler(t.wrapper,"scroll.jqxTextArea"+a,function(){0!==t.wrapper[0].scrollTop&&(t.wrapper[0].scrollTop=0),0!==t.wrapper[0].scrollLeft&&(t.wrapper[0].scrollLeft=0)}),t.addHandler(s,"change.jqxTextArea"+a,function(e){e.stopPropagation(),e.preventDefault(),t._arrange(),t._raiseEvent("0")}),t.addHandler(s,"select.jqxTextArea"+a,function(e){e.stopPropagation(),e.preventDefault()}),t.addHandler(s,"scroll.jqxTextArea"+a,function(){t._arrange()}),t.addHandler(s,"focus.jqxTextArea"+a,function(){t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),e.jqx.browser.msie&&e.jqx.browser.version<10&&t.textarea.val()===t.placeHolder&&t.textarea.val("")}),t.addHandler(s,"blur.jqxTextArea"+a,function(){if(t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus")),e.jqx.browser.msie&&e.jqx.browser.version<10){var a=t.textarea.val();""===a?t.textarea.val(t.placeHolder):null!==t.maxLength&&a.length>t.maxLength&&t.textarea.val(a.substr(0,t.maxLength))}}),t.addHandler(s,"keydown.jqxTextArea"+a,function(a){t._suppressKeyPressRepeat=~e.inArray(a.keyCode,[40,38,9,13,27]),t.changeType="keyboard",t._move(a)}),t.addHandler(s,"keypress.jqxTextArea"+a,function(a){if(null!==t.maxLength&&e.jqx.browser.msie&&e.jqx.browser.version<10&&s.val().length>t.maxLength)return!1;t._suppressKeyPressRepeat||t._move(a)}),t.addHandler(s,"keyup.jqxTextArea"+a,function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!t.opened)return;t._select();break;case 27:if(!t.opened)return;t.close();break;default:t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){t._suggest()},300)}e.stopPropagation(),e.preventDefault(),t._arrange()}),t.addHandler(t.vScrollBar,"valueChanged.jqxTextArea"+a,function(e){s.scrollTop(e.currentValue)}),t.addHandler(t.$popup,"mousedown.jqxTextArea"+a,function(e){e.stopPropagation(),e.preventDefault(),t.changeType="mouse",t._select()})},_removeHandlers:function(){var t=this,a=t.element.id,r=t.host,s=t.textarea;e.jqx.utilities.resize(t._baseHost,null,!0),t.removeHandler(r,"mousewheel.jqxTextArea"+a),t.removeHandler(r,"mouseenter.jqxTextArea"+a),t.removeHandler(r,"mouseleave.jqxTextArea"+a),t.removeHandler(r,"focus.jqxTextArea"+a),t.removeHandler(r,"blur.jqxTextArea"+a),t.removeHandler(t.wrapper,"scroll.jqxTextArea"+a),t.removeHandler(s,"change.jqxTextArea"+a),t.removeHandler(s,"select.jqxTextArea"+a),t.removeHandler(s,"scroll.jqxTextArea"+a),t.removeHandler(s,"focus.jqxTextArea"+a),t.removeHandler(s,"blur.jqxTextArea"+a),t.removeHandler(s,"keydown.jqxTextArea"+a),t.removeHandler(s,"keypress.jqxTextArea"+a),t.removeHandler(s,"keyup.jqxTextArea"+a),t.removeHandler(t.vScrollBar,"valueChanged.jqxTextArea"+a),t.removeHandler(t.$popup,"mousedown.jqxTextArea"+a)},_addItemHandlers:function(){var t=this;t.addHandler(t.$popup.find("li"),"mouseenter.jqxTextArea"+t.element.id,function(a){t.$popup.find(".jqx-fill-state-pressed").removeClass(t.toThemeProperty("jqx-fill-state-pressed")),e(a.currentTarget).addClass(t.toThemeProperty("jqx-fill-state-pressed"))})},_removeItemHandlers:function(){var e=this;e.removeHandler(e.$popup.find("li"),"mouseenter.jqxTextArea"+e.element.id)},wheel:function(t,a){var r=0;if(t.originalEvent&&e.jqx.browser.msie&&t.originalEvent.wheelDelta&&(r=t.originalEvent.wheelDelta/120),t||(t=window.event),t.wheelDelta?r=t.wheelDelta/120:t.detail?r=-t.detail/3:t.originalEvent.wheelDelta?r=t.originalEvent.wheelDelta/120:t.originalEvent.detail?r=-t.originalEvent.detail/3:t.originalEvent.deltaY&&(r=-t.originalEvent.deltaY/3),r){var s=a._handleDelta(r);return s||t.preventDefault&&t.preventDefault(),!s&&s}t.preventDefault&&t.preventDefault(),t.returnValue=!1},_handleDelta:function(e){var t=this,a=t.vScrollBar.jqxScrollBar("getInstance");if(t.focused){var r=a.value;e<0?t.scrollDown():t.scrollUp();if(r!==a.value)return!1}return!0},scrollDown:function(){var e=this;if("hidden"===e.vScrollBar.css("visibility"))return!1;var t=e.vScrollBar.jqxScrollBar("getInstance"),a=Math.min(t.value+t.largestep,t.max);return t.setPosition(a),e._arrange(),!0},scrollUp:function(){var e=this;if("hidden"===e.vScrollBar.css("visibility"))return!1;var t=e.vScrollBar.jqxScrollBar("getInstance"),a=Math.max(t.value-t.largestep,t.min);return t.setPosition(a),e._arrange(),!0},_setSize:function(){var e=this;e.host.css("width",e.width),e.host.css("height",e.height)},_addClasses:function(){var t=this;t.host.addClass(t.toThemeProperty("jqx-panel")),t.host.addClass(t.toThemeProperty("jqx-widget")),t.host.addClass(t.toThemeProperty("jqx-widget-content")),t.host.addClass(t.toThemeProperty("jqx-text-area")),t.textarea.addClass(t.toThemeProperty("jqx-widget")),t.textarea.addClass(t.toThemeProperty("jqx-widget-content")),!0===t.roundedCorners&&t.host.addClass(t.toThemeProperty("jqx-rc-all")),!0===t.disabled?(t.host.addClass(t.toThemeProperty("jqx-fill-state-disabled")),t.textarea.attr("disabled",""),e.jqx.aria(t,"aria-disabled",!0)):e.jqx.aria(t,"aria-disabled",!1),!0===t.rtl&&t.textarea.addClass(t.toThemeProperty("jqx-text-area-element-rtl"))},_addPopupClasses:function(){var t=this,a=t.$popup;a.addClass(t.toThemeProperty("jqx-popup")),e.jqx.browser.msie&&a.addClass(t.toThemeProperty("jqx-noshadow")),a.addClass(t.toThemeProperty("jqx-input-popup")),a.addClass(t.toThemeProperty("jqx-menu")),a.addClass(t.toThemeProperty("jqx-menu-vertical")),a.addClass(t.toThemeProperty("jqx-menu-dropdown")),a.addClass(t.toThemeProperty("jqx-widget")),a.addClass(t.toThemeProperty("jqx-widget-content")),t.roundedCorners&&a.addClass(t.toThemeProperty("jqx-rc-all"))},_updateSource:function(){var t=this,a=function(a){return e.map(a,function(e){if(void 0===e)return null;if("string"==typeof e||e instanceof String)return{label:e,value:e};if("string"!=typeof e&&e instanceof String==!1){var a="",r="";return""!==t.displayMember&&void 0!==t.displayMember&&e[t.displayMember]&&(a=e[t.displayMember]),""!==t.valueMember&&void 0!==t.valueMember&&(r=e[t.valueMember]),""===a&&(a=e.label),""===r&&(r=e.value),{label:a,value:r}}return e})};if(t.source&&t.source._source){if(t.adapter=t.source,t.adapter._source.localdata)t.adapter.unbindBindingUpdate(t.element.id),t.adapter.bindBindingUpdate(t.element.id,function(){t.source=a(t.adapter.records)});else{var r={};t.adapter._options.data?e.extend(t.adapter._options.data,r):(t.source._source.data&&e.extend(r,t.source._source.data),t.adapter._options.data=r),t.adapter.unbindDownloadComplete(t.element.id),t.adapter.bindDownloadComplete(t.element.id,function(){t.source=a(t.adapter.records)})}return void t.source.dataBind()}e.isFunction(t.source)||(t.source=a(t.source))},open:function(){var t=this;if(!e.jqx.isHidden(t.host)){var a=e.extend({},t.host.coord(!0),{height:t.host[0].offsetHeight});if(0===t.$popup.parent().length){var r=t._id+"_popup";t.$popup[0].id=r,e.jqx.aria(t,"aria-owns",r)}t.$popup.appendTo(e(document.body)).css({position:"absolute",zIndex:t.popupZIndex,top:a.top+a.height,left:a.left}).show();var s=0,l=t.$popup.children();return e.each(l,function(){s+=e(this).outerHeight(!0)-1}),t.$popup.height(s),t.opened=!0,t._raiseEvent("2",{popup:t.$popup}),e.jqx.aria(t,"aria-expanded",!0),t._addItemHandlers(),t}},close:function(){var t=this;return t._removeItemHandlers(),t.$popup.hide(),t.opened=!1,t._raiseEvent("3",{popup:t.$popup}),e.jqx.aria(t,"aria-expanded",!1),t},_suggest:function(){var t,a=this;return a.query=a.textarea[0].value,!a.query||a.query.length<a.minLength?a.opened?a.close():a:(t=e.isFunction(a.source)?a.source(a.query,e.proxy(a._load,this)):a.source,t?a._load(t):a)},_load:function(t){var a=this;return t=e.grep(t,function(e){return a.filter(e)}),t=a.sort(t),t.length?a._render(t.slice(0,a.items)).open():a.opened?a.close():a},_filter:function(t){var a=this,r=a.query,s=t;switch(void 0!==t.label?s=t.label:a.displayMember&&(s=t[a.displayMember]),a.searchMode){case"none":break;case"contains":return e.jqx.string.contains(s,r);case"equals":return e.jqx.string.equals(s,r);case"equalsignorecase":return e.jqx.string.equalsIgnoreCase(s,r);case"startswith":return e.jqx.string.startsWith(s,r);case"startswithignorecase":return e.jqx.string.startsWithIgnoreCase(s,r);case"endswith":return e.jqx.string.endsWith(s,r);case"endswithignorecase":return e.jqx.string.endsWithIgnoreCase(s,r);default:return e.jqx.string.containsIgnoreCase(s,r)}},_sort:function(e){for(var t=this,a=[],r=[],s=[],l=0;l<e.length;l++){var o=e[l],n=o;o.label?n=o.label:t.displayMember&&(n=o[t.displayMember]),0===n.toString().toLowerCase().indexOf(t.query.toString().toLowerCase())?a.push(o):n.toString().indexOf(t.query)>=0?r.push(o):n.toString().toLowerCase().indexOf(t.query.toString().toLowerCase())>=0&&s.push(o)}return a.concat(r,s)},_render:function(t){var a=this;return t=e(t).map(function(t,r){var s=r;t=void 0!==r.value?void 0!==r.label?e(a.item).attr({"data-name":r.label,"data-value":r.value}):e(a.item).attr({"data-name":r.value,"data-value":r.value}):void 0!==r.label?e(a.item).attr({"data-value":r.label,"data-name":r.label}):void 0!==a.displayMember&&""!==a.displayMember?e(a.item).attr({"data-name":r[a.displayMember],"data-value":r[a.valueMember]}):e(a.item).attr({"data-value":r,"data-name":r}),r.label?s=r.label:a.displayMember&&(s=r[a.displayMember]),t.find("a").html(a.highlight(s));var l="",o="";return!0===a.roundedCorners&&(l=" "+a.toThemeProperty("jqx-rc-all")),a.rtl&&(o=" "+a.toThemeProperty("jqx-rtl")),t[0].className=a.toThemeProperty("jqx-item")+" "+a.toThemeProperty("jqx-menu-item")+l+o,t[0]}),t.first().addClass(a.toThemeProperty("jqx-fill-state-pressed")),a.$popup.html(t),a.dropDownWidth?a.$popup.width(a.dropDownWidth):a.$popup.width(a.host.outerWidth()-6),a},_highlight:function(e){var t=this.query;t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var a=new RegExp("("+t+")","ig");return e.replace(a,function(e,t){return"<b>"+t+"</b>"})},_select:function(){var e=this,t=e.$popup.find(".jqx-fill-state-pressed").attr("data-value"),a=e.$popup.find(".jqx-fill-state-pressed").attr("data-name");return e.textarea[0].value=e.renderer(a,e.textarea[0].value),e.selectedItem={label:a,value:t},e.host.attr("data-value",t),e.host.attr("data-label",a),e._raiseEvent("1",{item:{label:a,value:t}}),e._arrange(),e.textarea[0].scrollTop=e.textarea[0].scrollHeight,e._raiseEvent("0"),e.close()},_renderer:function(e){return e},_move:function(e){var t=this;if(t.opened){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.shiftKey||(e.preventDefault(),t._prev());break;case 40:e.shiftKey||(e.preventDefault(),t._next())}e.stopPropagation()}},_next:function(){var t=this,a=t.$popup.find(".jqx-fill-state-pressed").removeClass(t.toThemeProperty("jqx-fill-state-pressed")),r=a.next();r.length||(r=e(t.$popup.find("li")[0])),r.addClass(t.toThemeProperty("jqx-fill-state-pressed"))},_prev:function(){var e=this,t=e.$popup.find(".jqx-fill-state-pressed").removeClass(e.toThemeProperty("jqx-fill-state-pressed")),a=t.prev();a.length||(a=e.$popup.find("li").last()),a.addClass(e.toThemeProperty("jqx-fill-state-pressed"))}})}(jqxBaseFramework);