!function(e){e.extend(e.jqx._jqxGrid.prototype,{_handledblclick:function(t,i){if(null!=t.target&&!i.disabled&&!e(t.target).ischildof(this.columnsheader)){var l;if(t.which?l=3==t.which:t.button&&(l=2==t.button),!l){var o;if(t.which?o=2==t.which:t.button&&(o=1==t.button),!o){var d=this.showheader?this.columnsheader.height()+2:0,a=this._groupsheader()?this.groupsheader.height():0;a+=this.showtoolbar?this.toolbarheight:0;var s=this.host.offset(),r=t.pageX-s.left,n=t.pageY-d-s.top-a,c=this._hittestrow(r,n);if(c){var h=c.row,u=c.index,p=t.target.className,f=this.table[0].rows[u];if(null!=f){i.mousecaptured=!0,i.mousecaptureposition={left:t.pageX,top:t.pageY-a};for(var v=this.hScrollInstance,m=v.value,x=0,w=(this.groupable&&this.groups.length,0);w<f.cells.length;w++){var b=parseInt(e(this.columnsrow[0].cells[w]).css("left")),g=b-m;i.columns.records[w].pinned&&(g=b);var y=this._getcolumnat(w);if(null==y||!y.hidden){if(g+e(this.columnsrow[0].cells[w]).width()>=r&&r>=g){x=w;break}}}if(null!=h){var y=this._getcolumnat(x);-1==p.indexOf("jqx-grid-group-expand")&&-1==p.indexOf("jqx-grid-group-collapse")&&-1!=h.boundindex&&i.begincelledit(i.getboundindex(h),y.datafield,y.defaulteditorvalue)}}}}}}},_getpreveditablecolumn:function(e){for(var t=this;e>0;){e--;var i=t.getcolumnat(e);if(!i)return null;if(i.editable&&!i.hidden)return i}return null},_getnexteditablecolumn:function(e){for(var t=this;e<this.columns.records.length;){e++;var i=t.getcolumnat(e);if(!i)return null;if(i.editable&&!i.hidden)return i}return null},_handleeditkeydown:function(t,i){if(i.handlekeyboardnavigation){if(1==i.handlekeyboardnavigation(t))return!0}var l=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(i.showfilterrow&&i.filterable&&this.filterrow&&e(t.target).ischildof(this.filterrow))return!0;if(t.target.className&&t.target.className.indexOf("jqx-grid-widget")>=0)return!0;if(i.pageable&&e(t.target).ischildof(this.pager))return!0;if(this.showtoolbar&&e(t.target).ischildof(this.toolbar))return!0;if(this.showeverpresentrow){if(this.addnewrowtop&&e(t.target).ischildof(this.addnewrowtop))return!0;if(this.addnewrowbottom&&e(t.target).ischildof(this.addnewrowbottom))return!0}if(this.showstatusbar&&e(t.target).ischildof(this.statusbar))return!0;if(this.rowdetails&&e(t.target).ischildof(this.content.find("[role='rowgroup']")))return!0;if(this.editcell){if("selectedrow"===this.editmode){if(13===l?this.endrowedit(this.editcell.row,!1):27===l&&this.endrowedit(this.editcell.row,!0),32==l&&this._currentColumn&&"checkbox"==this.getcolumn(this._currentColumn).columntype){var o=this.getcolumn(this._currentColumn);if(o.editable){var d=!this.getcellvalue(this.editcell.row,o.datafield),a=this.getrowdata(this.editcell.row),s=this.editcell.row,a=i.getrowdata(i.editcell.row);this.setcellvalue(this.editcell.row,o.datafield,d,!1);var r=this._focusedColumn,n=this._currentColumn,c=this._currentEditableColumn;if(this.endrowedit(this.editcell.row,!1),this.beginrowedit(s,!1),this._currentColumn=n,this._focusedColumn=r,this._currentEditableColumn=c,this._renderrows(),this.selectcell(s,o.datafield),this._oldselectedcell=this.selectedcell,r){var h=this;setTimeout(function(){h.selectcell(s,o.datafield),h._oldselectedcell=h.selectedcell,e(h._checkboxCells[o.datafield].checkbox).jqxCheckBox("focus")},25)}return!1}}if(9===l){var u=this.editcell.datafield,p=this._getcolumnindex(u);this._currentEditableColumn?p=this._currentEditableColumn:this._currentEditableColumn=p;var o=this._getnexteditablecolumn(p);if(t.shiftKey&&(o=this._getpreveditablecolumn(p)),o){var p=this._getcolumnindex(o.datafield);if(this.editcell[o.datafield]){this._currentEditableColumn=p;var f=this.editcell[o.datafield].editor;f&&(f.data().jqxWidget&&f.data().jqxWidget.focus?f.data().jqxWidget.focus():f.focus()),this._focusedColumn=o.datafield,this._currentColumn=o.datafield}else if("checkbox"==o.columntype)return this._currentColumn=o.datafield,this._currentEditableColumn=p,this.selectcell(this.editcell.row,o.datafield),this._oldselectedcell=this.selectedcell,this._checkboxCells[o.datafield]&&e(this._checkboxCells[o.datafield].checkbox).jqxCheckBox("focus"),!1}return!1}return!0}if(null==this.editcell.columntype||"textbox"==this.editcell.columntype||"numberinput"==this.editcell.columntype||"combobox"==this.editcell.columntype||"datetimeinput"==this.editcell.columntype){if(l>=33&&l<=40&&"multiplecellsadvanced"==i.selectionmode){var f="textbox"==this.editcell.columntype||null==this.editcell.columntype?this.editcell.editor:this.editcell.editor.find("input"),v=i._selection(f),m=f.val().length;v.length>0&&"datetimeinput"!=this.editcell.columntype&&(i._cancelkeydown=!0),v.start>0&&37==l&&(i._cancelkeydown=!0),v.start<m&&39==l&&"datetimeinput"!=this.editcell.columntype&&(i._cancelkeydown=!0),"datetimeinput"==this.editcell.columntype&&39==l&&v.start+v.length<m&&(i._cancelkeydown=!0)}}else"dropdownlist"==this.editcell.columntype?(37==l||39==l&&"multiplecellsadvanced"==i.selectionmode)&&(i._cancelkeydown=!1):"multiplecellsadvanced"==this.selectionmode&&"textbox"!=this.editcell.columntype&&"numberinput"!=this.editcell.columntype&&(i._cancelkeydown=!0);if(32==l&&"checkbox"==i.editcell.columntype){var o=i.getcolumn(i.editcell.datafield);if(o.editable){var d=!i.getcellvalue(i.editcell.row,i.editcell.column);if(o.cellbeginedit){var x=o.cellbeginedit(i.editcell.row,o.datafield,o.columntype,!d);if(0==x)return!1}var a=i.getrowdata(i.editcell.row);return i.setcellvalue(i.editcell.row,i.editcell.column,d,!0),i._raiseEvent(18,{rowindex:i.editcell.row,row:a,datafield:i.editcell.column,oldvalue:!d,value:d,columntype:"checkbox"}),!1}}if(9==l){var w=this.editcell.row,u=this.editcell.column,b=u,p=i._getcolumnindex(u),g=!1,y=i.getrowvisibleindex(w);this.editchar="";var _=this.editcell.validated;if(!this.editcell.validated)var _=this.endcelledit(this.editcell.row,this.editcell.column,!1,!0,!1);if(0!=_){if(t.shiftKey){var o=i._getpreveditablecolumn(p);if(o)u=o.datafield,g=!0,-1!=i.selectionmode.indexOf("cell")&&(i.selectprevcell(w,b),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(y,u)},10));else{var q=i._getlastvisiblecolumn();g=!0,u=q.displayfield,w--,-1!=i.selectionmode.indexOf("cell")&&(i.clearselection(),i.selectcell(w,u),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(y,u)},10))}}else{var o=i._getnexteditablecolumn(p);if(o)u=o.datafield,g=!0,-1!=i.selectionmode.indexOf("cell")&&(i.selectnextcell(w,b),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(y,u)},10));else{var j=i._getfirstvisiblecolumn();g=!0,u=j.displayfield,w++,-1!=i.selectionmode.indexOf("cell")&&(i.clearselection(),i.selectcell(w,u),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(y,u)},10))}}if(!g)return null!=this.editcell&&(i.endcelledit(w,u,!1),this._renderrows(this.virtualsizeinfo)),!0;i.begincelledit(w,u),null!=this.editcell&&"checkbox"==this.editcell.columntype&&this._renderrows(this.virtualsizeinfo)}return!1}if(13==l){var I=this.selectedcell;if(I)var D=this.getrowvisibleindex(I.rowindex);if(this.endcelledit(this.editcell.row,this.editcell.column,!1,!0),"multiplecellsadvanced"==this.selectionmode){var C=i.getselectedcell();if(null!=C&&i.selectcell&&null==this.editcell&&C.rowindex+1<this.dataview.totalrecords)if(this.sortcolumn!=C.datafield){var y=this.getrowvisibleindex(C.rowindex),k=this.dataview.loadedrecords[y+1];if(k&&(!this.pageable||this.pageable&&y+1<(this.dataview.pagenum+1)*this.pagesize)){this.clearselection(!1),this.selectcell(this.getboundindex(k),C.datafield);var C=this.getselectedcell();this.ensurecellvisible(k.visibleindex,C.datafield)}}else if(null!=I){var T=this.dataview.loadedrecords[D+1];if(T)if(!this.pageable||this.pageable&&D+1<this.pagesize)this.clearselection(!1),this.selectcell(this.getboundindex(T),C.datafield);else if(this.pageable&&D+1>=this.pagesize){this.clearselection(!1);var T=this.dataview.loadedrecords[D];this.selectcell(this.getboundindex(T),C.datafield)}}}return!1}if(27==l)return this.endcelledit(this.editcell.row,this.editcell.column,!0,!0),!1}else{var S=!1;if(113==l&&(S=!0),!t.ctrlKey&&!t.altKey&&!t.metaKey){if(l>=48&&l<=57&&(this.editchar=String.fromCharCode(l),S=!0),l>=65&&l<=90){this.editchar=String.fromCharCode(l);var B=!1;t.shiftKey?B=t.shiftKey:t.modifiers&&(B=!!(4&t.modifiers)),B||(this.editchar=this.editchar.toLowerCase()),S=!0}else l>=96&&l<=105&&(this.editchar=l-96,this.editchar=this.editchar.toString(),S=!0);var z=e(".jqx-grid").length;S=S&&(1==z||z>1&&i.focused);var O=e.data(document.body,"jqxgrid.edit");if(void 0!==O&&""!==O&&(13===l||S)&&O!=i.element.id)return!0}if((13==l||S)&&i.getselectedrowindex){var w=i.getselectedrowindex();switch(i.selectionmode){case"singlerow":case"multiplerows":case"multiplerowsextended":if(w>=0){for(var u="",N=0;N<i.columns.records.length;N++){var o=i.getcolumnat(N);if(o.editable){u=o.datafield;break}}i.begincelledit(w,u)}break;case"singlecell":case"multiplecells":case"multiplecellsextended":var C=i.getselectedcell();if(null!=C){var o=i._getcolumnbydatafield(C.datafield);"checkbox"!=o.columntype&&i.begincelledit(C.rowindex,C.datafield)}break;case"multiplecellsadvanced":var C=i.getselectedcell();if(null!=C)if(13==l){if(i.selectcell&&C.rowindex+1<i.dataview.totalrecords){var y=this.getrowvisibleindex(C.rowindex),k=this.dataview.loadedrecords[y+1];if(k){this.clearselection(!1),this.selectcell(this.getboundindex(k),C.datafield);var C=this.getselectedcell();this.ensurecellvisible(k.visibleindex,C.datafield)}}}else"selectedrow"!==i.editmode&&i.begincelledit(C.rowindex,C.datafield)}return!1}if(46==l){var L=i.getselectedcells();if(-1==i.selectionmode.indexOf("cell")&&i._getcellsforcopypaste&&(L=i._getcellsforcopypaste()),null!=L&&L.length>0){for(var E=0;E<L.length;E++){var C=L[E];if(C.datafield){var o=i.getcolumn(C.datafield),H=i.getcellvalue(C.rowindex,C.datafield);if(""!==H&&o.editable&&i.enablekeyboarddelete){var P=null;if("checkbox"==o.columntype&&(o.threestatecheckbox||(P=!1)),o.cellbeginedit){var x=o.cellbeginedit(C.rowindex,o.datafield,o.columntype,P);if(0==x)return!1}var a=i.getrowdata(C.rowindex);if(i._raiseEvent(17,{rowindex:C.rowindex,row:a,datafield:C.datafield,value:H}),E==L.length-1?(i.setcellvalue(C.rowindex,C.datafield,P,!0),o.displayfield!=o.datafield&&i.setcellvalue(C.rowindex,o.displayfield,P,!0)):(i.setcellvalue(C.rowindex,C.datafield,P,!1),o.displayfield!=o.datafield&&i.setcellvalue(C.rowindex,o.displayfield,P,!0)),o.cellendedit){o.cellendedit(C.rowindex,o.datafield,o.columntype,P)}i._raiseEvent(18,{rowindex:C.rowindex,row:a,datafield:C.datafield,oldvalue:H,value:P})}}}return this.dataview.updateview(),this._renderrows(this.virtualsizeinfo),!1}}if(32==l){var C=i.getselectedcell();if(null!=C){var o=i.getcolumn(C.datafield);if("checkbox"==o.columntype&&o.editable){var d=!i.getcellvalue(C.rowindex,C.datafield);if(o.cellbeginedit){var x=o.cellbeginedit(C.rowindex,o.datafield,o.columntype,!d);if(0==x)return!1}var a=i.getrowdata(C.rowindex);return i._raiseEvent(17,{rowindex:C.rowindex,row:a,datafield:C.datafield,value:!d,columntype:"checkbox"}),i.setcellvalue(C.rowindex,C.datafield,d,!0),i._raiseEvent(18,{rowindex:C.rowindex,row:a,datafield:C.datafield,oldvalue:!d,value:d,columntype:"checkbox"}),!1}}}}return!0},begincelledit:function(t,i,l,o,d){var a=this.getcolumn(i);if(this._cellscache=new Array,null!=i&&"number"!=a.columntype&&"button"!=a.columntype&&!a.createwidget){if(this.groupable){if(this.groups.indexOf(i)>=0)return;if(this.groups.indexOf(a.displayfield)>=0)return}if(void 0==this.editrow){if(this.editcell){if(this.editcell.row==t&&this.editcell.column==i)return!0;if("selectedrow"===this.editmode&&this.editcell.row==t)return;if(0==this.endcelledit(this.editcell.row,this.editcell.column,!1,!0,!1))return}var s="checkbox"==a.columntype||"button"==a.columntype||a.createwidget;if(this.host.removeClass("jqx-disableselect"),this.content.removeClass("jqx-disableselect"),a.editable){if(a.cellbeginedit){var r=this.getcell(t,i);if(0==a.cellbeginedit(t,i,a.columntype,null!=r?r.value:null))return}var n=this.getrowvisibleindex(t);if(this.editcell=this.getcell(t,i),this.editcell&&(this.editcell.visiblerowindex=n,!this.editcell.editing)){if(s||(this.editcell.editing=!0),this.editcell.columntype=a.columntype,this.editcell.defaultvalue=l,void 0!=a.defaultvalue&&(this.editcell.defaultvalue=a.defaultvalue),this.editcell.init=!0,"checkbox"!=a.columntype&&"selectedrow"!=this.editmode){var c=this.getrowdata(t);this._raiseEvent(17,{rowindex:t,row:c,datafield:a.datafield,value:this.editcell.value,columntype:a.columntype})}if(e.data(document.body,"jqxgrid.edit",this.element.id),!s){var h=this.getrowvisibleindex(t);!1!==o&&(this.autorowheight||this.ensurecellvisible(h,a.datafield)),!1!==d&&this._renderrows(this.virtualsizeinfo)}if(this.editcell)return this.editcell.init=!1,!0}}else{if(!this.editcell)return;this.editcell.editor=null,this.editcell.editing=!1,!1!==d&&this._renderrows(this.virtualsizeinfo),this.editcell=null}}}},getScrollTop:function(){if(this._py)return pageYOffset;if(this._py="undefined"!=typeof pageYOffset,this._py)return pageYOffset;var e=document.body,t=document.documentElement;return t=t.clientHeight?t:e,t.scrollTop},getScrollLeft:function(){if("undefined"!=typeof pageXOffset)return pageXOffset;var e=document.body,t=document.documentElement;return t=t.clientHeight?t:e,t.scrollLeft},endcelledit:function(t,i,l,o,d){if(void 0!=t&&void 0!=i||(this.editcell&&(t=this.editcell.row,i=this.editcell.column),void 0==l&&(l=!0)),this.editcell){var a=this.getcolumn(i),s=this;if("selectedrow"===s.editmode)return void this.endrowedit(t,l);var r=function(){if(0!=d){if(s.isTouchDevice())return;if(!s.isNestedGrid){var e=s.getScrollTop(),t=s.getScrollLeft();try{s.element.focus(),s.content.focus(),e!=s.getScrollTop()&&window.scrollTo(t,e),setTimeout(function(){s.element.focus(),s.content.focus(),e!=s.getScrollTop()&&window.scrollTo(t,e)},10)}catch(e){}}}};if("checkbox"==a.columntype||"button"==a.columntype||a.createwidget)return this.editcell&&(this.editcell.editor=null,this.editcell.editing=!1,this.editcell=null),!0;var n=this._geteditorvalue(a),c=function(e){if(e._hidecelleditor(),a.cellendedit&&a.cellendedit(t,i,a.columntype,e.editcell.value,n),e.editchar=null,a.displayfield!=a.datafield){var l=e.getcellvalue(e.editcell.row,a.displayfield),d=e.editcell.value;oldvalue={value:d,label:l}}else oldvalue=e.editcell.value;var s=e.getrowdata(t);e._raiseEvent(18,{rowindex:t,row:s,datafield:i,displayfield:a.displayfield,oldvalue:n,value:n,columntype:a.columntype}),e.editcell.editor=null,e.editcell.editing=!1,e.editcell=null,(o||void 0==o)&&e._renderrows(e.virtualsizeinfo),r(),e.enablebrowserselection||(e.host.addClass("jqx-disableselect"),e.content.addClass("jqx-disableselect"))};if(l)return c(this),!1;if(this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide()),a.cellvaluechanging){var h=a.cellvaluechanging(t,i,a.columntype,this.editcell.value,n);void 0!=h&&(n=h)}if(a.validation){var u=this.getcell(t,i);try{var p=a.validation(u,n),f=this.gridlocalization.validationstring;void 0!=p.message&&(f=p.message);if(!("boolean"==typeof p?p:p.result))return void 0!=p.showmessage&&1!=p.showmessage||this._showvalidationpopup(t,i,f),this.editcell.validated=!1,!1}catch(e){return this._showvalidationpopup(t,i,this.gridlocalization.validationstring),this.editcell.validated=!1,!1}}if(a.displayfield!=a.datafield){var v=this.getcellvalue(this.editcell.row,a.displayfield),m=this.editcell.value;oldvalue={value:m,label:v}}else oldvalue=this.editcell.value;var x=this.getrowdata(t);if(a.cellendedit){if(0==a.cellendedit(t,i,a.columntype,this.editcell.value,n))return this._raiseEvent(18,{rowindex:t,row:x,datafield:i,displayfield:a.displayfield,oldvalue:oldvalue,value:oldvalue,columntype:a.columntype}),c(this),!1}return this._raiseEvent(18,{rowindex:t,row:x,datafield:i,displayfield:a.displayfield,oldvalue:oldvalue,value:n,columntype:a.columntype}),this._hidecelleditor(!1),void 0!=this.editcell&&(this.editcell.editor=null,this.editcell.editing=!1),this.editcell=null,this.editchar=null,this.setcellvalue(t,i,n,o),this.enablebrowserselection||(this.host.addClass("jqx-disableselect"),this.content.addClass("jqx-disableselect")),e.jqx.browser.msie||r(),e.data(document.body,"jqxgrid.edit",""),!0}},beginrowedit:function(t){var i=this;i._oldselectedrow=t,this._cellscache=new Array;var l=!1;if("selectedrow"!=this.editmode&&(l=!0),l){var o=this.editmode;this.editmode="selectedrow"}var d=null;e.each(this.columns.records,function(e,l){if(i.editable&&this.editable){d||(d=this.datafield);var o=i.getcell(t,this.datafield);i.begincelledit(t,this.datafield,null,!1,!1);var a=i.getrowdata(t);i._raiseEvent(17,{rowindex:t,row:a,datafield:this.datafield,value:o.value,columntype:this.columntype})}}),i.editcell&&(i.editcell.init=!0),this._renderrows(this.virtualsizeinfo),l&&(this.editmode=o),d&&setTimeout(function(){var e=i.editcell[d].editor;e&&(e.data().jqxWidget&&e.data().jqxWidget.focus?e.data().jqxWidget.focus():e.focus())},25)},endrowedit:function(t,i){var l=this;if(this._currentEditableColumn=0,this._focusedColumn=null,this._currentColumn=null,this._checkboxCells=[],!this.editcell)return!1;if(void 0==this.editcell.editor)return!1;var o=!1;if("selectedrow"!=this.editmode&&(o=!0),o){var d=this.editmode;this.editmode="selectedrow"}var a=!1,s={};this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide());for(var r=0;r<this.columns.records.length;r++){var n=this.columns.records[r];if(n.editable&&(!n.hidden&&"checkbox"!=n.columntype&&!n.createwidget)){var c=this._geteditorvalue(n),h=function(e){e._hidecelleditor();var i=e.getcellvalue(e.editcell.row,n.displayfield);if(n.cellendedit&&n.cellendedit(t,f,n.columntype,i,c),e.editchar=null,n.displayfield!=n.datafield){var l=e.getcellvalue(e.editcell.row,n.displayfield);u={value:i,label:l}}else u=i;var o=e.getrowdata(t);e._raiseEvent(18,{rowindex:t,row:o,datafield:f,displayfield:n.displayfield,oldvalue:i,value:i,columntype:n.columntype}),e.editcell.editing=!1};if(i)h(this);else{if(n.cellvaluechanging){var u=this.getcellvalue(this.editcell.row,n.displayfield),p=n.cellvaluechanging(t,f,n.columntype,u,c);void 0!=p&&(c=p)}var f=n.datafield;if(n.validation){var v=this.getcell(t,n.datafield);try{var m=n.validation(v,c),x=this.gridlocalization.validationstring;void 0!=m.message&&(x=m.message);var w="boolean"==typeof m?m:m.result;if(!w){void 0!=m.showmessage&&1!=m.showmessage||this._showvalidationpopup(t,f,x),a=!0,this.editcell[n.datafield].validated=!1;continue}}catch(e){this._showvalidationpopup(t,f,this.gridlocalization.validationstring),this.editcell[n.datafield].validated=!1,a=!0;continue}}if(n.displayfield!=n.datafield){var b=this.getcellvalue(this.editcell.row,n.displayfield),g=this.editcell.value;u={value:g,label:b}}else u=this.getcellvalue(this.editcell.row,n.displayfield);s[n.datafield]={newvalue:c,oldvalue:u}}}}var y={},_={};if(!a){this._hidecelleditor(!1);for(var r=0;r<this.columns.records.length;r++){var n=this.columns.records[r],f=n.datafield;if(!n.hidden&&n.editable){var q=this.getrowdata(t);if(!n.createwidget)if("checkbox"!=n.columntype){if(s[n.datafield]){var c=s[n.datafield].newvalue,u=s[n.datafield].oldvalue;if(n.cellendedit){var j=n.cellendedit(t,f,n.columntype,u,c);if(0==j){this._raiseEvent(18,{rowindex:t,row:q,datafield:f,displayfield:n.displayfield,oldvalue:u,value:u,columntype:n.columntype}),h(this);continue}}this.source.updaterow||this._raiseEvent(18,{rowindex:t,row:q,datafield:n.datafield,displayfield:n.displayfield,oldvalue:u,value:c,columntype:n.columntype}),y[n.datafield]=c,_[n.datafield]=u}}else{var c=this.getcellvalue(t,n.displayfield);this._raiseEvent(18,{rowindex:t,row:q,datafield:n.datafield,displayfield:n.displayfield,oldvalue:c,value:c,columntype:n.columntype})}}}var I=this.getrowid(t),q=this.getrowdata(t);if(e.each(y,function(e,t){if(t&&void 0!=t.label){var i=l.getcolumn(e);q[i.displayfield]=t.label,q[i.datafield]=t.value}else q[e]=t}),this.enablebrowserselection||(this.host.addClass("jqx-disableselect"),this.content.addClass("jqx-disableselect")),e.data(document.body,"jqxgrid.edit",""),this.editcell=null,this.editchar=null,this.source.updaterow){var D=!1,l=this,w=function(i){var o=l.source.updaterow;l.source.updaterow=null,0==i?(e.each(_,function(e,t){if(t&&void 0!=t.label){var i=l.getcolumn(e);q[i.displayfield]=t.label,q[i.datafield]=t.value}else q[e]=t}),l.updaterow(I,q)):l.updaterow(I,q);for(var d=0;d<l.columns.records.length;d++){var a=l.columns.records[d];a.datafield;l._raiseEvent(18,{rowindex:t,datafield:a.datafield,row:q,displayfield:a.displayfield,oldvalue:_[a.datafield],value:q[a.displayfield],columntype:a.columntype})}l.source.updaterow=o};try{D=this.source.updaterow(I,q,w),void 0==D&&(D=!0)}catch(e){return void(D=!1)}}else this.updaterow(I,q),this._renderrows(this.virtualsizeinfo)}return o&&(this.editmode=d),a},_selection:function(e){if("selectionStart"in e[0]){var t=e[0],i=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:i,text:t.value}}var l=document.selection.createRange();if(null==l)return{start:0,end:t.value.length,length:0};var o=e[0].createTextRange(),d=o.duplicate();o.moveToBookmark(l.getBookmark()),d.setEndPoint("EndToStart",o);var i=l.text.length;return{start:d.text.length,end:d.text.length+l.text.length,length:i,text:l.text}},_setSelection:function(e,t,i){if("selectionStart"in i[0])i[0].focus(),i[0].setSelectionRange(e,t);else{var l=i[0].createTextRange();l.collapse(!0),l.moveEnd("character",t),l.moveStart("character",e),l.select()}},findRecordIndex:function(e,t,i){var i=i;if(t)for(var l=i.length,o=0;o<l;o++){var d=i[o],a=d.label;if(e==a)return o}return-1},_destroyeditors:function(){var t=this;this.columns.records&&(e.each(this.columns.records,function(i,l){var o=e.trim(this.datafield).split(" ").join("");switch(this.columntype){case"dropdownlist":var d=t.editors["dropdownlist_"+o];d&&(d.jqxDropDownList("destroy"),t.editors["dropdownlist_"+o]=null);break;case"combobox":var a=t.editors["combobox_"+o];a&&(a.jqxComboBox("destroy"),t.editors["combobox_"+o]=null);break;case"datetimeinput":var s=t.editors["datetimeinput_"+this.datafield];s&&(s.jqxDateTimeInput("destroy"),t.editors["datetimeinput_"+o]=null);break;case"numberinput":var r=t.editors["numberinput_"+o];r&&(r.jqxNumberInput("destroy"),t.editors["numberinput_"+o]=null);break;case"custom":case"template":if(t.destroyeditor&&t.editors["templateeditor_"+o]&&(t.destroyeditor(t.editors["templateeditor_"+o]),t.editors["templateeditor_"+o]=null),t.destroyeditor)for(var n=t.getrows.length(),c=0;c<n;c++)t.editors["customeditor_"+o+"_"+c]&&(t.destroyeditor(t.editors["customeditor_"+o+"_"+c],c),t.editors["customeditor_"+o+"_"+c]=null);break;case"textbox":default:var h=t.editors["textboxeditor_"+o];h&&(t.removeHandler(h,"keydown"),t.editors["textbox_"+o]=null)}}),t.editors=new Array)},_showcelleditor:function(t,i,l,o,d){if(void 0!=l&&null!=this.editcell){if("checkbox"==i.columntype&&i.editable)return void("selectedrow"==this.editmode&&(this._checkboxCells||(this._checkboxCells=[]),this._checkboxCells[i.datafield]=l));void 0==d&&(d=!0),"selectedrow"==this.editmode&&(this.editchar="",d=!1);var a=i.datafield,s=e(l),r=this,n=this.editcell.editor,c=this.getcellvalue(t,a),h=this.getcelltext(t,a),u=this.hScrollInstance,p=u.value,f=parseInt(p);this.columns.records.indexOf(i);if(this.editcell.element=l,0==this.editcell.validated){var v="";this.validationpopup&&(v=this.validationpopup.text()),this._showvalidationpopup(t,a,v)}var m=function(e){r.hScrollInstance.isScrolling()||r.vScrollInstance.isScrolling()||d&&(r.isTouchDevice()||(e&&e.focus(),0!=r.gridcontent[0].scrollTop&&(r.scrolltop(Math.abs(r.gridcontent[0].scrollTop)),r.gridcontent[0].scrollTop=0),0!=r.gridcontent[0].scrollLeft&&(r.gridcontent[0].scrollLeft=0)))};switch(i.columntype){case"dropdownlist":if(this.host.jqxDropDownList){l.innerHTML="";var x=e.trim(i.datafield).split(" ").join(""),w=e.trim(i.displayfield).split(" ").join("");-1!=x.indexOf(".")&&(x=x.replace(".","")),-1!=w.indexOf(".")&&(w=w.replace(".",""));var b=this.editors["dropdownlist_"+x];if(n=void 0==b?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 99999; top: 0px; left: 0px; position: absolute;' id='dropdownlisteditor'></div>"):b,n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-f+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",f+parseInt(e(l).position().left)),void 0==b){n.prependTo(this.table),n[0].id="dropdownlisteditor"+this.element.id+x;var g=!!this.source._source,y=null;if(g){var _={localdata:this.source.records,datatype:this.source.datatype,async:!1};y=new e.jqx.dataAdapter(_,{autoBind:!1,async:!1,uniqueDataFields:[w],autoSort:!0,autoSortField:w})}else y=new e.jqx.dataAdapter(this.source,{autoBind:!1,uniqueDataFields:[w],async:!1,autoSort:!0,autoSortField:w});var q=!i.createeditor;n.jqxDropDownList({enableBrowserBoundsDetection:!0,keyboardSelection:!1,source:y,rtl:this.rtl,autoDropDownHeight:q,theme:this.theme,width:s.width()-2,height:s.height()-2,displayMember:w,valueMember:a}),this.editors["dropdownlist_"+x]=n,i.createeditor&&i.createeditor(t,c,n)}i._requirewidthupdate&&n.jqxDropDownList({width:s.width()-2});var j=n.jqxDropDownList("listBox").visibleItems;i.createeditor||(j.length<8?n.jqxDropDownList("autoDropDownHeight",!0):n.jqxDropDownList("autoDropDownHeight",!1));var c=this.getcellvalue(t,w),I=this.findRecordIndex(c,w,j);if(o&&(""!=c?n.jqxDropDownList("selectIndex",I,!0):n.jqxDropDownList("selectIndex",-1)),!this.editcell)return;void 0!=this.editcell.defaultvalue&&n.jqxDropDownList("selectIndex",this.editcell.defaultvalue,!0),d&&n.jqxDropDownList("focus")}break;case"combobox":if(this.host.jqxComboBox){l.innerHTML="";var x=e.trim(i.datafield).split(" ").join(""),w=e.trim(i.displayfield).split(" ").join("");-1!=x.indexOf(".")&&(x=x.replace(".","")),-1!=w.indexOf(".")&&(w=w.replace(".",""));var D=this.editors["combobox_"+x];if(n=void 0==D?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 99999; top: 0px; left: 0px; position: absolute;' id='comboboxeditor'></div>"):D,n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-f+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",f+parseInt(e(l).position().left)),void 0==D){n.prependTo(this.table),n[0].id="comboboxeditor"+this.element.id+x;var g=!!this.source._source,y=null;if(g){var _={localdata:this.source.records,datatype:this.source.datatype,async:!1};y=new e.jqx.dataAdapter(_,{autoBind:!1,async:!1,uniqueDataFields:[w],autoSort:!0,autoSortField:w})}else y=new e.jqx.dataAdapter(this.source,{autoBind:!1,uniqueDataFields:[w],async:!1,autoSort:!0,autoSortField:w});var q=!i.createeditor;n.jqxComboBox({enableBrowserBoundsDetection:!0,keyboardSelection:!1,source:y,rtl:this.rtl,autoDropDownHeight:q,theme:this.theme,width:s.width()-2,height:s.height()-2,displayMember:w,valueMember:a}),n.removeAttr("tabindex"),n.find("div").removeAttr("tabindex"),this.editors["combobox_"+x]=n,i.createeditor&&i.createeditor(t,c,n)}i._requirewidthupdate&&n.jqxComboBox({width:s.width()-2});var j=n.jqxComboBox("listBox").visibleItems;i.createeditor||(j.length<8?n.jqxComboBox("autoDropDownHeight",!0):n.jqxComboBox("autoDropDownHeight",!1));var c=this.getcellvalue(t,w),I=this.findRecordIndex(c,w,j);if(o&&(""!=c?(n.jqxComboBox("selectIndex",I,!0),n.jqxComboBox("val",c)):(n.jqxComboBox("selectIndex",-1),n.jqxComboBox("val",c))),!this.editcell)return;void 0!=this.editcell.defaultvalue&&n.jqxComboBox("selectIndex",this.editcell.defaultvalue,!0),this.editchar&&this.editchar.length>0&&n.jqxComboBox("input").val(this.editchar),d&&setTimeout(function(){if(m(n.jqxComboBox("input")),n)if(n.jqxComboBox("_setSelection",0,0),r.editchar)n.jqxComboBox("_setSelection",1,1),r.editchar=null;else if(n.jqxComboBox("input")){var e=n.jqxComboBox("input").val();n.jqxComboBox("_setSelection",0,e.length)}},10)}break;case"datetimeinput":if(this.host.jqxDateTimeInput){l.innerHTML="";var x=e.trim(i.datafield).split(" ").join("");-1!=x.indexOf(".")&&(x=x.replace(".",""));var C=this.editors["datetimeinput_"+x];if(n=void 0==C?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 99999; top: 0px; left: 0px; position: absolute;' id='datetimeeditor'></div>"):C,n.show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-f+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",f+parseInt(e(l).position().left)),void 0==C){n.prependTo(this.table),n[0].id="datetimeeditor"+this.element.id+x;var k={calendar:this.gridlocalization};n.jqxDateTimeInput({firstDayOfWeek:this.gridlocalization.firstDay,enableBrowserBoundsDetection:!0,localization:k,_editor:!0,theme:this.theme,rtl:this.rtl,width:s.width(),height:s.height(),formatString:i.cellsformat}),this.editors["datetimeinput_"+x]=n,i.createeditor&&i.createeditor(t,c,n)}if(i._requirewidthupdate&&n.jqxDateTimeInput({width:s.width()-2}),o){if(""!=c&&null!=c){var T=new Date(c);"Invalid Date"==T&&this.source.getvaluebytype&&(T=this.source.getvaluebytype(c,{name:i.datafield,type:"date"})),n.jqxDateTimeInput("setDate",T)}else n.jqxDateTimeInput("setDate",null);void 0!=this.editcell.defaultvalue&&n.jqxDateTimeInput("setDate",this.editcell.defaultvalue)}d&&setTimeout(function(){m(n.jqxDateTimeInput("dateTimeInput"))},10)}break;case"numberinput":if(this.host.jqxNumberInput){l.innerHTML="";var x=e.trim(i.datafield).split(" ").join("");-1!=x.indexOf(".")&&(x=x.replace(".",""));var S=this.editors["numberinput_"+x];if(n=void 0==S?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 99999; top: 0px; left: 0px; position: absolute;' id='numbereditor'></div>"):S,n.show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-f+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",f+parseInt(e(l).position().left)),void 0==S){n.prependTo(this.table),n[0].id="numbereditor"+this.element.id+x;var B="",z="left",O=2;i.cellsformat?-1!=i.cellsformat.indexOf("c")?(B=this.gridlocalization.currencysymbol,z=this.gridlocalization.currencysymbolposition,z="before"==z?"left":"right",i.cellsformat.length>1&&(O=parseInt(i.cellsformat.substring(1),10))):-1!=i.cellsformat.indexOf("p")&&(B=this.gridlocalization.percentsymbol,z="right",i.cellsformat.length>1&&(O=parseInt(i.cellsformat.substring(1),10))):O=0,n.jqxNumberInput({decimalSeparator:this.gridlocalization.decimalseparator,decimalDigits:O,inputMode:"simple",theme:this.theme,rtl:this.rtl,width:s.width()-1,height:s.height()-1,spinButtons:!0,symbol:B,symbolPosition:z}),this.editors["numberinput_"+x]=n,i.createeditor&&i.createeditor(t,c,n)}if(i._requirewidthupdate&&n.jqxNumberInput({width:s.width()-2}),o){if(""!=c&&null!=c){var N=c;n.jqxNumberInput("setDecimal",N)}else n.jqxNumberInput("setDecimal",0);if(void 0!=this.editcell.defaultvalue&&n.jqxNumberInput("setDecimal",this.editcell.defaultvalue),this.editchar&&this.editchar.length>0){var L=parseInt(this.editchar);isNaN(L)||n.jqxNumberInput("setDecimal",L)}d&&setTimeout(function(){if(m(n.jqxNumberInput("numberInput")),n.jqxNumberInput("_setSelectionStart",0),r.editchar)i.cellsformat.length>0?n.jqxNumberInput("_setSelectionStart",2):n.jqxNumberInput("_setSelectionStart",1),r.editchar=null;else{if(n.jqxNumberInput("spinButtons")){var e=n.jqxNumberInput("numberInput").val();r._setSelection(n.jqxNumberInput("numberInput")[0],e.length,e.length)}else{var e=n.jqxNumberInput("numberInput").val();r._setSelection(n.jqxNumberInput("numberInput")[0],0,e.length)}n.jqxNumberInput("selectAll")}},10)}}break;case"custom":l.innerHTML="";var x=e.trim(i.datafield).split(" ").join("");-1!=x.indexOf(".")&&(x=x.replace(".",""));var E=this.editors["customeditor_"+x+"_"+t]
;if(n=void 0==E?e("<div style='overflow: hidden; border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 99999; top: 0px; left: 0px; position: absolute;' id='customeditor'></div>"):E,n.show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-f+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",f+parseInt(e(l).position().left)),void 0==E){n.prependTo(this.table),n[0].id="customeditor"+this.element.id+x+"_"+t,this.editors["customeditor_"+x+"_"+t]=n;var H=s.width()-1,P=s.height()-1;n.width(H),n.height(P),i.createeditor&&i.createeditor(t,c,n,h,H,P,this.editchar)}i._requirewidthupdate&&n.width(s.width()-2);break;case"template":l.innerHTML="";var x=e.trim(i.datafield).split(" ").join("");-1!=x.indexOf(".")&&(x=x.replace(".",""));var M=this.editors["templateeditor_"+x];if(n=void 0==M?e("<div style='overflow: hidden; border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 99999; top: 0px; left: 0px; position: absolute;' id='templateeditor'></div>"):M,n.show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-f+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",f+parseInt(e(l).position().left)),void 0==M){n.prependTo(this.table),n[0].id="templateeditor"+this.element.id+x,this.editors["templateeditor_"+x]=n;var H=s.width()-1,P=s.height()-1;n.width(H),n.height(P),i.createeditor&&i.createeditor(t,c,n,h,H,P,this.editchar)}i._requirewidthupdate&&n.width(s.width()-2);break;case"textbox":default:l.innerHTML="",n=this.editors["textboxeditor_"+i.datafield]||e("<input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='textbox' id='textboxeditor'/>"),n[0].id="textboxeditor"+this.element.id+i.datafield,n.appendTo(s),this.rtl&&n.css("direction","rtl"),(o||""==n[0].className)&&(n.addClass(this.toThemeProperty("jqx-input")),n.addClass(this.toThemeProperty("jqx-widget-content")),this.editchar&&this.editchar.length>0?n.val(this.editchar):(""!=i.cellsformat&&(c=this.getcelltext(t,a)),void 0==c&&(c=""),n.val(c)),void 0!=this.editcell.defaultvalue&&n.val(this.editcell.defaultvalue),n.width(s.width()+1),n.height(s.height()+1),i.createeditor&&i.createeditor(t,c,n),""!=i.cellsformat&&(-1==i.cellsformat.indexOf("p")&&-1==i.cellsformat.indexOf("c")&&-1==i.cellsformat.indexOf("n")&&-1==i.cellsformat.indexOf("f")||this.editors["textboxeditor_"+i.datafield]||n.keydown(function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0,l=String.fromCharCode(t),o=parseInt(l);if(isNaN(o))return!0;if(r._selection(n).length>0)return!0;var d="",a=n.val();if(i.cellsformat.length>1){var s=parseInt(i.cellsformat.substring(1));isNaN(s)&&(s=0)}else var s=0;if(s>0&&-1!=a.indexOf(r.gridlocalization.decimalseparator)&&r._selection(n).start>a.indexOf(r.gridlocalization.decimalseparator))return!0;for(var c=0;c<a.length-s;c++){var h=a.substring(c,c+1);null!=h.match(/^[0-9]+$/)&&(d+=h)}return!(d.length>=11)&&void 0}))),this.editors["textboxeditor_"+i.datafield]=n,o&&d&&setTimeout(function(){m(n),r.editchar?(r._setSelection(n[0],1,1),r.editchar=null):r._setSelection(n[0],0,n.val().length)},25)}n&&(n[0].style.zIndex=1+l.style.zIndex,e.jqx.browser.msie&&e.jqx.browser.version<8&&(n[0].style.zIndex=1+this.columns.records.length+l.style.zIndex),n.css("display","block"),this.editcell.editor=n,this.editcell[a]?this.editcell[a].editor=n:(this.editcell[a]={},this.editcell[a].editor=n)),o&&i.initeditor&&i.initeditor(t,c,n,h,this.editchar),r.isTouchDevice()||setTimeout(function(){r.content&&(r.content[0].scrollTop=0,r.content[0].scrollLeft=0),r.gridcontent&&(r.gridcontent[0].scrollLeft=0,r.gridcontent[0].scrollTop=0)},10)}},_setSelection:function(e,t,i){try{if("selectionStart"in e)e.setSelectionRange(t,i);else{var l=e.createTextRange();l.collapse(!0),l.moveEnd("character",i),l.moveStart("character",t),l.select()}}catch(e){}},_hideeditors:function(){if(null!=this.editcells){var e=this;for(var t in this.editcells)e.editcell=e.editcells[t],e._hidecelleditor()}},_hidecelleditor:function(e){if(this.editcell){if("selectedrow"===this.editmode){for(var t=0;t<this.columns.records.length;t++){var i=this.columns.records[t];if(this.editcell[i.datafield]&&this.editcell[i.datafield].editor){this.editcell[i.datafield].editor.hide();var l=this.editcell[i.datafield].editor;switch(i.columntype){case"dropdownlist":l.jqxDropDownList({closeDelay:0}),l.jqxDropDownList("hideListBox"),l.jqxDropDownList({closeDelay:300});break;case"combobox":l.jqxComboBox({closeDelay:0}),l.jqxComboBox("hideListBox"),l.jqxComboBox({closeDelay:300});break;case"datetimeinput":l.jqxDateTimeInput("isOpened")&&(l.jqxDateTimeInput({closeDelay:0}),l.jqxDateTimeInput("hideCalendar"),l.jqxDateTimeInput({closeDelay:300}))}}}return void(this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide()))}if("checkbox"!=this.editcell.columntype){if(this.editcell.editor)switch(this.editcell.editor.hide(),this.editcell.columntype){case"dropdownlist":this.editcell.editor.jqxDropDownList({closeDelay:0}),this.editcell.editor.jqxDropDownList("hideListBox"),this.editcell.editor.jqxDropDownList({closeDelay:300});break;case"combobox":this.editcell.editor.jqxComboBox({closeDelay:0}),this.editcell.editor.jqxComboBox("hideListBox"),this.editcell.editor.jqxComboBox({closeDelay:300});break;case"datetimeinput":var o=this.editcell.editor;o.jqxDateTimeInput("isOpened")&&(o.jqxDateTimeInput({closeDelay:0}),o.jqxDateTimeInput("hideCalendar"),o.jqxDateTimeInput({closeDelay:300}))}this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide()),this.isNestedGrid||0!=e&&this.element.focus()}}},_geteditorvalue:function(t){var i=new String;if(!this.editcell)return null;var l=this.editcell.editor;if("selectedrow"==this.editmode&&this.editcell[t.datafield])var l=this.editcell[t.datafield].editor;if(l){switch(t.columntype){case"textbox":default:if(i=l.val(),""!=t.cellsformat){var o="string",d=this.source.datafields||(this.source._source?this.source._source.datafields:null);if(d){var a="";e.each(d,function(){if(this.name==t.displayfield)return this.type&&(a=this.type),!1}),a&&(o=a)}var s="number"===o||"float"===o||"int"===o||"integer"===o,r="date"===o||"time"===o;if(s||"string"===o&&(-1!=t.cellsformat.indexOf("p")||-1!=t.cellsformat.indexOf("c")||-1!=t.cellsformat.indexOf("n")||-1!=t.cellsformat.indexOf("f"))){if(""===i&&t.nullable)return"";i.indexOf(this.gridlocalization.currencysymbol)>-1&&(i=i.replace(this.gridlocalization.currencysymbol,""));var n=i;if(n=new Number(n),!isNaN(n))return n;i=function(e,t,i){var l=e;if(t==i)return e;for(var o=l.indexOf(t);-1!=o;)l=l.replace(t,i),o=l.indexOf(t);return l}(i,this.gridlocalization.thousandsseparator,""),i=i.replace(this.gridlocalization.decimalseparator,"."),i.indexOf(this.gridlocalization.percentsymbol)>-1&&(i=i.replace(this.gridlocalization.percentsymbol,""));for(var c="",h=0;h<i.length;h++){var u=i.substring(h,h+1);"-"===u&&(c+="-"),"."===u&&(c+="."),null!=u.match(/^[0-9]+$/)&&(c+=u)}i=c,i=i.replace(/ /g,""),i=new Number(i),isNaN(i)&&(i="")}if(r||"string"===o&&(-1!=t.cellsformat.indexOf("H")||-1!=t.cellsformat.indexOf("m")||-1!=t.cellsformat.indexOf("M")||-1!=t.cellsformat.indexOf("y")||-1!=t.cellsformat.indexOf("h")||-1!=t.cellsformat.indexOf("d"))){if(""===i&&t.nullable)return"";var p=i;e.jqx.dataFormat&&(i=e.jqx.dataFormat.tryparsedate(p,this.gridlocalization)),"Invalid Date"!=i&&null!=i||(i="")}}t.displayfield!=t.datafield&&(i={label:i,value:i});break;case"checkbox":l.jqxCheckBox&&(i=l.jqxCheckBox("checked"));break;case"datetimeinput":if(l.jqxDateTimeInput){if(l.jqxDateTimeInput({isEditing:!1}),l.jqxDateTimeInput("_validateValue"),null==(i=l.jqxDateTimeInput("getDate")))return null;i=new Date(i.toString()),t.displayfield!=t.datafield&&(i={label:i,value:i})}break;case"dropdownlist":if(l.jqxDropDownList){var f=l.jqxDropDownList("selectedIndex"),v=l.jqxDropDownList("listBox").getVisibleItem(f);i=t.displayfield!=t.datafield?v?{label:v.label,value:v.value}:"":v?v.label:"",null==i&&(i="")}break;case"combobox":if(l.jqxComboBox){if(i=l.jqxComboBox("val"),t.displayfield!=t.datafield){var v=l.jqxComboBox("getSelectedItem");null!=v&&(i={label:v.label,value:v.value})}null==i&&(i="")}break;case"numberinput":if(l.jqxNumberInput){this.touchdevice&&l.jqxNumberInput("_doTouchHandling");var m=l.jqxNumberInput("getDecimal");i=new Number(m),i=parseFloat(i),isNaN(i)&&(i=0),null===m&&(i=null),t.displayfield!=t.datafield&&(i={label:i,value:i})}}t.geteditorvalue&&(i="selectedrow"==this.editmode?t.geteditorvalue(this.editcell.row,this.getcellvalue(this.editcell.row,t.datafield),l):t.geteditorvalue(this.editcell.row,this.editcell.value,l))}return i},hidevalidationpopups:function(){this.popups&&(e.each(this.popups,function(){this.validation.remove(),this.validationrow.remove()}),this.popups=new Array),this.validationpopup&&(this.validationpopuparrow.hide(),this.validationpopup.hide())},showvalidationpopup:function(t,i,l){if(void 0==l)var l=this.gridlocalization.validationstring;var o=e("<div style='z-index: 99999; top: 0px; left: 0px; position: absolute;'></div>"),d=e("<div style='width: 20px; height: 20px; z-index: 999999; top: 0px; left: 0px; position: absolute;'></div>");o.html(l),d.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),o.addClass(this.toThemeProperty("jqx-grid-validation")),o.addClass(this.toThemeProperty("jqx-rc-all")),o.prependTo(this.table),d.prependTo(this.table);for(var a=this.hScrollInstance,s=a.value,r=parseInt(s),n=this.getcolumn(i).uielement,c=null,h=0;h<this.hittestinfo.length;h++)t===this.hittestinfo[h].row.visibleindex&&(c=this.hittestinfo[h]);if(!c){this.ensurerowvisible(t);var u=this;return o.remove(),d.remove(),void setTimeout(function(){for(var e=null,o=0;o<u.hittestinfo.length;o++)t===u.hittestinfo[o].row.visibleindex&&(e=u.hittestinfo[o]);e&&u.showvalidationpopup(t,i,l)},25)}var p=e(c.visualrow);o.css("top",parseInt(p.position().top)+30+"px");var f=parseInt(o.css("top"));d.css("top",f-12),d.removeClass(),d.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up"));var v=!1;f>=this._gettableheight()&&(d.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),d.addClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),f=parseInt(p.position().top)-this.rowsheight-5,f<0&&(f=0,this.validationpopuparrow.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),v=!0),o.css("top",f+"px"),d.css("top",f+o.outerHeight()-9));var m=-r+parseInt(e(n).position().left);d.css("left",r+m+30);var x=o.width();if(x+m>this.host.width()-20){m-=x+m-this.host.width()+40}v?o.css("left",r+parseInt(e(n).position().left)-o.outerWidth()):o.css("left",r+m),o.show(),d.show(),this.popups||(this.popups=new Array),this.popups[this.popups.length]={validation:o,validationrow:d}},_showvalidationpopup:function(t,i,l){var o=this.editcell,d=this.editcell.editor;if("selectedrow"==this.editmode){var o=this.editcell[i];o&&o.editor&&(d=o.editor,o.element=d)}if(d&&!(this.validationpopup&&e.jqx.isHidden(this.validationpopup)&&(this.validationpopup.remove&&(this.validationpopup.remove(),this.validationpopuparrow.remove()),this.validationpopup=null,this.validationpopuparrow=null,void 0===i&&void 0===l&&this.editors&&0===this.editors.length))){if(this.validationpopup)this.validationpopup.html(l);else{var a=e("<div style='z-index: 99999; top: 0px; left: 0px; position: absolute;'></div>"),s=e("<div style='width: 20px; height: 20px; z-index: 999999; top: 0px; left: 0px; position: absolute;'></div>");a.html(l),s.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),a.addClass(this.toThemeProperty("jqx-grid-validation")),a.addClass(this.toThemeProperty("jqx-rc-all")),a.prependTo(this.table),s.prependTo(this.table),this.validationpopup=a,this.validationpopuparrow=s}var r=this.hScrollInstance,n=r.value,c=parseInt(n);"selectedrow"==this.editmode?this.visiblerows&&this.visiblerows[this.editcell.visiblerowindex]?this.validationpopup.css("top",this.visiblerows[this.editcell.visiblerowindex].top+(this.rowsheight+5)+"px"):this.validationpopup.css("top",parseInt(e(o.editor).position().top)+(this.rowsheight+5)+"px"):this.validationpopup.css("top",parseInt(e(o.element).parent().position().top)+(this.rowsheight+5)+"px");var h=parseInt(this.validationpopup.css("top"));this.validationpopuparrow.css("top",h-11),this.validationpopuparrow.removeClass(),this.validationpopuparrow.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up"));var u=this._gettableheight(),p=!1;h>=u&&(this.validationpopuparrow.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),this.validationpopuparrow.addClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),h=parseInt(e(o.element).parent().position().top)-this.rowsheight-5,"selectedrow"==this.editmode&&(h=this.visiblerows&&this.visiblerows[this.editcell.visiblerowindex]?this.visiblerows[this.editcell.visiblerowindex].top-this.rowsheight-5:parseInt(e(o.editor).position().top)-this.rowsheight-5),h<0&&(h=0,this.validationpopuparrow.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),p=!0),this.validationpopup.css("top",h+"px"),this.validationpopuparrow.css("top",h+this.validationpopup.outerHeight()-9));var f=-c+parseInt(e(o.element).position().left);this.validationpopuparrow.css("left",c+f+30);var v=this.validationpopup.width();if(v+f>this.host.width()-20){f-=v+f-this.host.width()+40}p?this.validationpopup.css("left",c+parseInt(e(o.element).position().left)-this.validationpopup.outerWidth()):this.validationpopup.css("left",c+f),"none"==this.editcell.editor.css("display")?(this.validationpopup.hide(),this.validationpopuparrow.hide()):(this.validationpopup.show(),this.validationpopuparrow.show())}}})}(jqxBaseFramework);