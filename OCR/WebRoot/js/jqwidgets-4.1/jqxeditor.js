!function(e){e.jqx.jqxWidget("jqxEditor","",{}),e.extend(e.jqx._jqxEditor.prototype,{defineInstance:function(){var t={width:null,height:null,disabled:!1,pasteMode:"html",editable:!0,lineBreak:"default",changeType:null,toolbarPosition:"top",fontFamily:"sans-serif",commands:{bold:{tooltip:"Bold",command:"bold",type:"toggleButton"},italic:{tooltip:"Italic",command:"italic",type:"toggleButton"},underline:{tooltip:"Underline",command:"underline",type:"toggleButton"},format:{placeHolder:"Format Block",tooltip:"Format Block",command:"formatblock",value:[{value:"p",label:"Paragraph"},{value:"h1",label:"Header 1"},{value:"h2",label:"Header 2"},{value:"h3",label:"Header 3"},{value:"h4",label:"Header 4"}],type:"list",width:120,dropDownWidth:190,height:25},font:{placeHolder:"Font",tooltip:"Font Name",command:"fontname",value:[{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Comic Sans MS",value:'"Comic Sans MS", cursive, sans-serif'},{label:"Courier New",value:'"Courier New", Courier, monospace'},{label:"Georgia",value:"Georgia,serif"},{label:"Impact",value:"Impact,Charcoal,sans-serif"},{label:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{label:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{label:"Times New Roman",value:"'Times New Roman',Times,serif"},{label:"Trebuchet MS",value:'"Trebuchet MS",Helvetica,sans-serif'},{label:"Verdana",value:"Verdana,Geneva,sans-serif"}],type:"list",width:160,height:25,dropDownWidth:160},size:{placeHolder:"Size",tooltip:"Font Size",command:"fontsize",value:[{label:"1 (8pt)",value:"xx-small"},{label:"2 (10pt)",value:"x-small"},{label:"3 (12pt)",value:"small"},{label:"4 (14pt)",value:"medium"},{label:"5 (18pt)",value:"large"},{label:"6 (24pt)",value:"x-large"},{label:"7 (36pt)",value:"xx-large"}],type:"list",width:45,height:25,dropDownWidth:160},color:{tooltip:"Text Color",command:"forecolor",value:"#000",type:"colorPicker"},background:{tooltip:"Fill Color",command:"backcolor",value:"#fff",type:"colorPicker"},left:{tooltip:"Align Left",command:"justifyleft",type:"toggleButton"},center:{tooltip:"Align Center",command:"justifycenter",type:"toggleButton"},right:{tooltip:"Align Right",command:"justifyright",type:"toggleButton"},outdent:{tooltip:"Indent Less",command:"outdent",type:"button"},indent:{tooltip:"Indent More",command:"indent",type:"button"},ul:{tooltip:"Insert unordered list",command:"insertunorderedlist",type:"toggleButton"},ol:{tooltip:"Insert ordered list",command:"insertorderedlist",type:"toggleButton"},image:{tooltip:"Insert image",command:"insertimage",type:"button"},link:{tooltip:"Insert link",command:"createlink",type:"toggleButton"},html:{tooltip:"View source",command:"viewsource",type:"toggleButton"},clean:{tooltip:"Remove Formatting",command:"removeformat",type:"button"}},createCommand:null,defaultLocalization:{bold:"Bold",italic:"Italic",underline:"Underline",format:"Format Block",font:"Font Name",size:"Font Size",color:"Text Color",background:"Fill Color",left:"Align Left",center:"Align Center",right:"Align Right",outdent:"Indent Less",indent:"Indent More",ul:"Insert unordered list",ol:"Insert ordered list",image:"Insert image",link:"Insert link",html:"View source",clean:"Remove Formatting",Remove:"Remove",Ok:"Ok",Cancel:"Cancel",Change:"Change","Go to link":"Go to link","Open in a new window/tab":"Open in a new window/tab",Align:"Align",VSpace:"VSpace",HSpace:"HSpace",Width:"Width",Height:"Height",Title:"Title",URL:"URL","Insert Image":"Insert Image","Insert Link":"Insert Link","Alt Text":"Alt Text","not set":"&ltnot set&gt",Left:"Left",Right:"Right",Paragraph:"Paragraph",Header:"Header",Arial:"Arial","Comic Sans MS":"Comic Sans MS","Courier New":"Courier New",Georgia:"Georgia",Impact:"Impact","Lucida Console":"Lucida Console",Tahoma:"Tahoma","Times New Roman":"Times New Roman","Trebuchet MS":"Trebuchet MS",Verdana:"Verdana"},localization:null,tools:"bold italic underline | format font size | color background | left center right | outdent indent | ul ol | image | link | clean | html",readOnly:!1,stylesheets:new Array,rtl:!1,colorPickerTemplate:'<div class="jqx-editor-color-picker"><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (0, 0, 0)"><div title="RGB (0, 0, 0)" style="background-color: rgb(0, 0, 0);"></div></td><td aria-label="RGB (68, 68, 68)"><div title="RGB (68, 68, 68)" style="background-color: rgb(68, 68, 68);"></div></td><td aria-label="RGB (102, 102, 102)"><div title="RGB (102, 102, 102)" style="background-color: rgb(102, 102, 102);"></div></td><td aria-label="RGB (153, 153, 153)"><div title="RGB (153, 153, 153)" style="background-color: rgb(153, 153, 153);"></div></td><td aria-label="RGB (204, 204, 204)"><div title="RGB (204, 204, 204)" style="background-color: rgb(204, 204, 204);"></div></td><td aria-label="RGB (238, 238, 238)"><div title="RGB (238, 238, 238)" style="background-color: rgb(238, 238, 238);"></div></td><td aria-label="RGB (243, 243, 243)"><div title="RGB (243, 243, 243)" style="background-color: rgb(243, 243, 243);"></div></td><td aria-label="RGB (255, 255, 255)"><div title="RGB (255, 255, 255)" style="background-color: rgb(255, 255, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (255, 0, 0)"><div title="RGB (255, 0, 0)" style="background-color: rgb(255, 0, 0);"></div></td><td aria-label="RGB (255, 153, 0)"><div title="RGB (255, 153, 0)" style="background-color: rgb(255, 153, 0);"></div></td><td aria-label="RGB (255, 255, 0)"><div title="RGB (255, 255, 0)" style="background-color: rgb(255, 255, 0);"></div></td><td aria-label="RGB (0, 255, 0)"><div title="RGB (0, 255, 0)" style="background-color: rgb(0, 255, 0);"></div></td><td aria-label="RGB (0, 255, 255)"><div title="RGB (0, 255, 255)" style="background-color: rgb(0, 255, 255);"></div></td><td aria-label="RGB (0, 0, 255)"><div title="RGB (0, 0, 255)" style="background-color: rgb(0, 0, 255);"></div></td><td aria-label="RGB (153, 0, 255)"><div title="RGB (153, 0, 255)" style="background-color: rgb(153, 0, 255);"></div></td><td aria-label="RGB (255, 0, 255)"><div title="RGB (255, 0, 255)" style="background-color: rgb(255, 0, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (244, 204, 204)"><div title="RGB (244, 204, 204)" style="background-color: rgb(244, 204, 204);"></div></td><td aria-label="RGB (252, 229, 205)"><div title="RGB (252, 229, 205)" style="background-color: rgb(252, 229, 205);"></div></td><td aria-label="RGB (255, 242, 204)"><div title="RGB (255, 242, 204)" style="background-color: rgb(255, 242, 204);"></div></td><td aria-label="RGB (217, 234, 211)"><div title="RGB (217, 234, 211)" style="background-color: rgb(217, 234, 211);"></div></td><td aria-label="RGB (208, 224, 227)"><div title="RGB (208, 224, 227)" style="background-color: rgb(208, 224, 227);"></div></td><td aria-label="RGB (207, 226, 243)"><div title="RGB (207, 226, 243)" style="background-color: rgb(207, 226, 243);"></div></td><td aria-label="RGB (217, 210, 233)"><div title="RGB (217, 210, 233)" style="background-color: rgb(217, 210, 233);"></div></td><td aria-label="RGB (234, 209, 220)"><div title="RGB (234, 209, 220)" style="background-color: rgb(234, 209, 220);"></div></td></tr><tr><td id="T-Kw-Jn88" aria-label="RGB (234, 153, 153)"><div title="RGB (234, 153, 153)" style="background-color: rgb(234, 153, 153);"></div></td><td aria-label="RGB (249, 203, 156)"><div title="RGB (249, 203, 156)" style="background-color: rgb(249, 203, 156);"></div></td><td aria-label="RGB (255, 229, 153)"><div title="RGB (255, 229, 153)" style="background-color: rgb(255, 229, 153);"></div></td><td aria-label="RGB (182, 215, 168)"><div title="RGB (182, 215, 168)" style="background-color: rgb(182, 215, 168);"></div></td><td aria-label="RGB (162, 196, 201)"><div title="RGB (162, 196, 201)" style="background-color: rgb(162, 196, 201);"></div></td><td aria-label="RGB (159, 197, 232)"><div title="RGB (159, 197, 232)" style="background-color: rgb(159, 197, 232);"></div></td><td aria-label="RGB (180, 167, 214)"><div title="RGB (180, 167, 214)" style="background-color: rgb(180, 167, 214);"></div></td><td aria-label="RGB (213, 166, 189)"><div title="RGB (213, 166, 189)" style="background-color: rgb(213, 166, 189);"></div></td></tr><tr><td aria-label="RGB (224, 102, 102)"><div title="RGB (224, 102, 102)" style="background-color: rgb(224, 102, 102);"></div></td><td aria-label="RGB (246, 178, 107)"><div title="RGB (246, 178, 107)" style="background-color: rgb(246, 178, 107);"></div></td><td aria-label="RGB (255, 217, 102)"><div title="RGB (255, 217, 102)" style="background-color: rgb(255, 217, 102);"></div></td><td aria-label="RGB (147, 196, 125)"><div title="RGB (147, 196, 125)" style="background-color: rgb(147, 196, 125);"></div></td><td aria-label="RGB (118, 165, 175)"><div title="RGB (118, 165, 175)" style="background-color: rgb(118, 165, 175);"></div></td><td aria-label="RGB (111, 168, 220)"><div title="RGB (111, 168, 220)" style="background-color: rgb(111, 168, 220);"></div></td><td aria-label="RGB (142, 124, 195)"><div title="RGB (142, 124, 195)" style="background-color: rgb(142, 124, 195);"></div></td><td aria-label="RGB (194, 123, 160)"><div title="RGB (194, 123, 160)" style="background-color: rgb(194, 123, 160);"></div></td></tr><tr><td id="T-Kw-Jn104" aria-label="RGB (204, 0, 0)"><div title="RGB (204, 0, 0)" style="background-color: rgb(204, 0, 0);"></div></td><td aria-label="RGB (230, 145, 56)"><div title="RGB (230, 145, 56)" style="background-color: rgb(230, 145, 56);"></div></td><td aria-label="RGB (241, 194, 50)"><div title="RGB (241, 194, 50)" style="background-color: rgb(241, 194, 50);"></div></td><td aria-label="RGB (106, 168, 79)"><div title="RGB (106, 168, 79)" style="background-color: rgb(106, 168, 79);"></div></td><td aria-label="RGB (69, 129, 142)"><div title="RGB (69, 129, 142)" style="background-color: rgb(69, 129, 142);"></div></td><td aria-label="RGB (61, 133, 198)"><div title="RGB (61, 133, 198)" style="background-color: rgb(61, 133, 198);"></div></td><td aria-label="RGB (103, 78, 167)"><div title="RGB (103, 78, 167)" style="background-color: rgb(103, 78, 167);"></div></td><td aria-label="RGB (166, 77, 121)"><div title="RGB (166, 77, 121)" style="background-color: rgb(166, 77, 121);"></div></td></tr><tr><td aria-label="RGB (153, 0, 0)"><div title="RGB (153, 0, 0)" style="background-color: rgb(153, 0, 0);"></div></td><td aria-label="RGB (180, 95, 6)"><div title="RGB (180, 95, 6)" style="background-color: rgb(180, 95, 6);"></div></td><td aria-label="RGB (191, 144, 0)"><div title="RGB (191, 144, 0)" style="background-color: rgb(191, 144, 0);"></div></td><td aria-label="RGB (56, 118, 29)"><div title="RGB (56, 118, 29)" style="background-color: rgb(56, 118, 29);"></div></td><td aria-label="RGB (19, 79, 92)"><div title="RGB (19, 79, 92)" style="background-color: rgb(19, 79, 92);"></div></td><td aria-label="RGB (11, 83, 148)"><div title="RGB (11, 83, 148)" style="background-color: rgb(11, 83, 148);"></div></td><td aria-label="RGB (53, 28, 117)"><div title="RGB (53, 28, 117)" style="background-color: rgb(53, 28, 117);"></div></td><td aria-label="RGB (116, 27, 71)"><div title="RGB (116, 27, 71)" style="background-color: rgb(116, 27, 71);"></div></td></tr><tr><td aria-label="RGB (102, 0, 0)"><div title="RGB (102, 0, 0)" style="background-color: rgb(102, 0, 0);"></div></td><td aria-label="RGB (120, 63, 4)"><div title="RGB (120, 63, 4)" style="background-color: rgb(120, 63, 4);"></div></td><td aria-label="RGB (127, 96, 0)"><div title="RGB (127, 96, 0)" style="background-color: rgb(127, 96, 0);"></div></td><td aria-label="RGB (39, 78, 19)"><div title="RGB (39, 78, 19)" style="background-color: rgb(39, 78, 19);"></div></td><td aria-label="RGB (12, 52, 61)"><div title="RGB (12, 52, 61)" style="background-color: rgb(12, 52, 61);"></div></td><td aria-label="RGB (7, 55, 99)"><div title="RGB (7, 55, 99)" style="background-color: rgb(7, 55, 99);"></div></td><td aria-label="RGB (32, 18, 77)"><div title="RGB (32, 18, 77)" style="background-color: rgb(32, 18, 77);"></div></td><td aria-label="RGB (76, 17, 48)"><div title="RGB (76, 17, 48)" style="background-color: rgb(76, 17, 48);"></div></td></tr></tbody></table></div></div>',touchMode:!1,keyPressed:null,events:["change"]};return e.extend(!0,this,t),this.localization=this.defaultLocalization,t},createInstance:function(o){var i=this;i.textArea=i.host;var r=i.host.attr("contenteditable");if(i.host.addClass(i.toThemeProperty("jqx-widget")),1==r||"true"==r){i.inline=!0,i.widget=i.host,i.editorDocument=document,i.selection=new t(i.editorDocument);var n=e("<div class='jqx-editor-toolbar-container' unselectable='on' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div>");n.insertBefore(i.host),i.toolbarContainer=n,i.toolbar=n.find(".jqx-editor-toolbar"),i.editor=i.host,i.contentEditableElement=i.element}else{var a=e("<div class='jqx-editor'><div class='jqx-editor-container'><div class='jqx-editor-toolbar-container' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div></div><div class='jqx-editor-content'><iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe></div></div></div>");i.widget=a,i.widget[0].className=i.widget[0].className+" "+i.element.className;try{i.widget[0].style=i.element.style}catch(e){}var l=e.trim(i.host.html())+"&#8203;";"default"==i.lineBreak||"div"==i.lineBreak?l="<div>"+l+"</div>":"p"==i.lineBreak&&(l="<p>"+l+"</p>"),l=l.replace(/&lt;/gi,"<"),l=l.replace(/&gt;/gi,">"),i.host.css("display","none"),i.host.after(a),a.find("iframe").after(i.host),i.container=a.find(".jqx-editor-container"),i.toolbarContainer=a.find(".jqx-editor-toolbar-container"),i.toolbar=a.find(".jqx-editor-toolbar"),i.iframe=a.find("iframe"),i.content=a.find(".jqx-editor-content");var d=function(){i.editorDocument=i.iframe[0].contentWindow.document,i.selection=new t(i.editorDocument);var o=0;i.addHandler(i.iframe,"load",function(){if(++o>1){i.iframe.off("load"),i.content.find("iframe").remove();e("<iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe>").appendTo(i.content);i.iframe=a.find("iframe"),d()}}),e.jqx.browser.mozilla||(i.editorDocument.designMode="On"),i.editorDocument.open();var r=i.rtl?"direction:rtl;":"",n=e.jqx.browser.msie?"::selection{color: #fff; background: #328EFD;};::-moz-selection{color: #fff; background: #328eD;};::selection:window-inactive {background: #c7c7c7; color: #000;}::-moz-selection:window-inactive {background: #c7c7c7; color: #000;}html{font-size:13px; height:100%;}body{padding-top:1px;margin-top:-1px; padding-right: 1px; overflow-x: hidden;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;":"";if(i.editorDocument.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0; margin:0; font-size: 13px; font-family: "+i.fontFamily+"; background:#fff; min-height:100%; "+r+"}"+n+"}h1{font-size:2em;margin:.67em 0}h2{font-size: 1.5em; margin: .75em 0}h3{font-size: 1.17em; margin: .83em 0}h4{font-size:1em; margin: 1.12em 0 }h5{font-size: .83em; margin: 1.5em 0}h6{font-size: .75em; margin: 1.67em 0}p{margin: 0px;padding:0 .2em}ul,ol{padding-left:2.5em}a{color:#00a}code{font-size:1.23em}.jqx-editor-paste-element {position: absolute; left: -1000px; height: 1px; overflow: hidden; top: -1000px;}.jqx-editor-focus {border: 1px solid #aaa !important;}</style>"+e.map(i.stylesheets,function(e){return"<link rel='stylesheet' href='"+e+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),i.contentEditableElement=i.editorDocument.body,i.host.is("textarea")){i._textArea=i.element;var s=i.host.data();s.jqxEditor.host=a,s.jqxEditor.element=a[0],i.element=a[0],a[0].id=i._textArea.id,i._textArea.id=i._textArea.id+"TextArea",e(i.element).addClass(i.toThemeProperty("jqx-widget")),i.host=e(i.element),i.host.data(s)}else{var s=i.host.data();s.jqxEditor.host=a,s.jqxEditor.element=a[0],i.element=a[0],i.host=e(i.element),i.host.data(s)}try{i.editorDocument.execCommand("useCSS",!1,!1),i.editorDocument.execCommand("enableInlineTableEditing",null,!1)}catch(e){}try{i.editorDocument.execCommand("styleWithCSS",0,!0)}catch(e){}i.editorDocument.close(),i.editor=e(i.editorDocument.body),i.editor.html(l).attr("spellcheck",!1).attr("autocorrect","off")};d(),e.jqx.utilities.resize(i.host,function(){i.widget.css("width",i.width),i.widget.css("height",i.height),i._arrange()})}},focus:function(){var t=this;e.jqx.browser.mozilla&&(t.focused||(t.iframe&&t.iframe.focus(),t.selection.selectNode(t.editor[0].firstChild,!0),t.selection.getRange().collapse(!0))),t.editor.focus();var o=null!=t.range?t.range:t.getRange();t.selectRange(o)},print:function(){var e=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");e.document.open(),e.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this.val()+"</body></html>"),e.document.close()},refresh:function(t){var o=this;e.each(this.defaultLocalization,function(e,t){o.localization[e]||(o.localization[e]=t)}),o._removeHandlers(),o.toolbar.addClass(o.toThemeProperty("jqx-widget-header")),o.content?(o.widget.css("width",o.width),o.widget.css("height",o.height),o.widget.addClass(o.toThemeProperty("jqx-editor")),o.widget.addClass(o.toThemeProperty("jqx-widget")),o.widget.addClass(o.toThemeProperty("jqx-rc-all")),o.widget.addClass(o.toThemeProperty("jqx-widget-header")),o.content.addClass(o.toThemeProperty("jqx-widget-content")),o.container.addClass(o.toThemeProperty("jqx-editor-container"))):(o.toolbarContainer.addClass(o.toThemeProperty("jqx-widget-header")),o.toolbarContainer.addClass(o.toThemeProperty("jqx-editor-toolbar-inline")),o.toolbarContainer.addClass(o.toThemeProperty("jqx-widget")),o.toolbarContainer.addClass(o.toThemeProperty("jqx-rc-all")),o.toolbarContainer.hide(),o.toolbarContainer.css("position","absolute"),o.editor.addClass(o.toThemeProperty("jqx-editor-inline")),o.toolbarContainer.css("width",o.host.outerWidth()+"px"));var i=o.toolbarContainer.index();if("top"==o.toolbarPosition&&0!=i||"bottom"==o.toolbarPosition&&1!=i)switch(o.toolbarPosition){case"bottom":o.toolbarContainer.insertAfter(o.content);break;case"top":default:o.toolbarContainer.insertBefore(o.content)}var r=o.tools;if(!1!==r){var n=r.split(" "),a=r.split(" | "),l=function(t,i){e.each(i,function(r,n){var a=o.commands[this];if(a){if(o.createCommand){var l=o.createCommand(this.toString());a=e.extend(a,l)}}else{if(!o.createCommand)return!0;if(!(a=o.createCommand(this.toString())))return!0;o.commands[this]||(o.commands[this]=a)}switch(o.localization[this]&&(a.tooltip=o.localization[this]),a.type){case"list":a.widget&&a.widget.jqxDropDownList("destroy");var d=function(e,t,o){return"formatblock"==a.command?"<"+o+' unselectable="on" style="padding: 0px; margin: 0px;">'+t+"</"+o+">":"fontname"==a.command?'<span unselectable="on" style="font-family: '+o+';">'+t+"<span>":"fontsize"==a.command?'<span unselectable="on" style="font-size: '+o+';">'+t+"<span>":void 0},s=function(){return"<div unselectable='on' style='margin-top: 0px; padding:0px;' class='"+o.toThemeProperty("jqx-editor-toolbar-icon")+" "+o.toThemeProperty("jqx-editor-toolbar-icon-"+a.command)+"'></div>"},c="formatblock"==a.command||"fontname"==a.command||"fontsize"==a.command,u=a.value||[],g=new Array,p=a.placeHolder||"Please Choose:";"fontname"==a.command?e.each(u,function(){var e=o.localization[this.label];g.push({label:e,value:this.value})}):"formatblock"==a.command?(p=o.localization.format,e.each(u,function(){if(this.label.indexOf("Header")>=0)var e=this.label.replace("Header",o.localization.Header);else var e=o.localization[this.label];g.push({label:e,value:this.value})})):g=u;var h={enableBrowserBoundsDetection:!0,touchMode:o.touchMode,width:a.width||100,height:a.height||25,dropDownWidth:a.dropDownWidth||"auto",autoDropDownHeight:(a.value&&a.value.length)<12,placeHolder:p,source:g,theme:o.theme,keyboardSelection:!1,focusable:!1,disabled:o.disabled,rtl:o.rtl,selectionRenderer:"fontsize"==a.command?s:null,renderer:c?d:null},m="jqx-disableselect "+o.toThemeProperty("jqx-editor-dropdownlist")+" "+o.toThemeProperty("jqx-editor-toolbar-item"),f=e("<div unselectable='on' class='"+m+"'></div>");f.appendTo(t),f.jqxDropDownList(h),a.init&&a.init(f);var n=null,v=null,b="";o.addHandler(f,"mousedown",function(t){if(e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0){var o=e(".jqx-editor-dropdownlist");e.each(o,function(t,o){o!=f[0]&&e(o).jqxDropDownList("close")})}}),o.addHandler(f,"open",function(e){o.focused||o.focus(),o.updating=!0,o.activeElement=f,n=f.val(),b=""}),o.addHandler(f,"change",function(t){o.updating=!1,o.activeElement=null,v=f.val(),b=t.args.type,e.jqx.browser.msie&&e.jqx.browser.version<9&&o.focus()}),o.addHandler(f,"close",function(e){o.updating=!1,o.activeElement=null,n!=v&&("mouse"!=b&&"keyboard"!=b||o._refreshTools())}),o._addCommandHandler(f,"change",a.command,null,a);break;case"colorPicker":a.widget&&(e(a.colorPicker).remove(),a.widget.jqxDropDownButton("destroy"));var x=e('<div unselectable="on" style="padding-top: 4px;"></div>').attr("id","picker-"+a.command),m="jqx-disableselect "+o.toThemeProperty("jqx-editor-dropdownpicker")+" "+o.toThemeProperty("jqx-editor-toolbar-item"),f=e("<div unselectable='on' class='"+m+"'></div>");f.appendTo(t),f.append(x),f.jqxDropDownButton({touchMode:o.touchMode,disabled:o.disabled,enableBrowserBoundsDetection:!0,width:a.width||45,height:a.height||25,rtl:o.rtl,focusable:!1,theme:o.theme});var y=e('<div unselectable="on" style="z-index: 55;">'),w=o.toThemeProperty("jqx-editor-toolbar-icon")+" "+o.toThemeProperty("jqx-editor-toolbar-icon-"+a.command),k=e("<div unselectable='on' class='"+w+"'></div>");y.append(k);var _=e('<div unselectable="on" class="jqx-editor-color-bar">').attr("id","bar-"+a.command).css("background-color",a.value);y.append(_),f.jqxDropDownButton("setContent",y),x.append(e(o.colorPickerTemplate)),a.colorPicker=x,a.init&&a.init(f),x.find("tr").attr("role","row").attr("unselectable","on"),x.find("td").attr("role","gridcell").attr("unselectable","on").css("-webkit-user-select","none"),x.find("div").attr("unselectable","on"),o.addHandler(f,"mousedown",function(t){if(e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),e(".jqx-editor-dropdownpicker").length>0){var o=e(".jqx-editor-dropdownpicker");e.each(o,function(t,o){o!=f[0]&&e(o).jqxDropDownButton("close")})}}),o.addHandler(f,"open",function(){o.focused||o.focus(),o.updating=!0,o.activeElement=x}),o.addHandler(f,"close",function(e){o.updating=!1,o.activeElement=null,n!=v&&("mouse"!=b&&"keyboard"!=b||o._refreshTools())}),o.addHandler(x,"keydown",function(t){var o=t.keyCode,i=e(x).find(".jqx-editor-color-picker-selected-cell"),r=x.find("tr"),n=r.length,l=i.parent().children().length,d=i.index(),s=-999,c=i.parent();switch(e.each(r,function(e,t){if(this==c[0])return s=e,!1}),o){case 27:f.jqxDropDownButton("close");break;case 13:e(i).trigger("mousedown");break;case 38:s--;break;case 40:s++;break;case 39:d++;break;case 37:d--}if(s>=0&&s<=n&&d>=0&&d<=l){var c=x.find("tr")[s],u=e(c).children()[d],g=e(u).children().css("background-color");a.val(g)}});var T=e(x).find("td");a.val=function(t){var i=o._rgbToHex(t);e.each(T,function(){var t=e(this).children().css("background-color");if(o._rgbToHex(t)==i)return T.removeClass("jqx-editor-color-picker-selected-cell"),e(this).addClass("jqx-editor-color-picker-selected-cell"),e("#bar-"+a.command).css("background",t),!1})},a.val(a.value),o._addCommandHandler(T,"mousedown",a.command,null,a);break;case"button":case"toggleButton":default:a.widget&&("button"==a.type?a.widget.jqxButton("destroy"):a.widget.jqxToggleButton("destroy"));var j=a.command,q=a.action,w=o.toThemeProperty("jqx-editor-toolbar-icon")+" "+o.toThemeProperty("jqx-editor-toolbar-icon-"+j),k=e("<div unselectable='on' class='"+w+"'></div>"),f=e("<div unselectable='on'></div>").addClass("jqx-disableselect").addClass(o.toThemeProperty("jqx-editor-toolbar-button"));a.init?j&&f.append(k):f.append(k),f.appendTo(t),"button"==a.type?f.jqxButton({disabled:o.disabled,rtl:o.rtl,theme:o.theme}):"toggleButton"==a.type&&f.jqxToggleButton({disabled:o.disabled,rtl:o.rtl,uiToggle:!1,theme:o.theme}),a.init&&a.init(f),a.toggled=!1,a.toggle=function(){a.toggled=!a.toggled},o.addHandler(f,"mousedown",function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}),e.jqx.mobile.isTouchDevice()?o._addCommandHandler(f,"mousedown",j,q,a):o._addCommandHandler(f,"click",j,q,a)}if(a.widget=f,f){try{""!=a.tooltip&&(a.widget.attr("title",a.tooltip),a.widget.attr("data-tooltip",a.tooltip)),a.command&&a.widget.attr("data-command",a.command),a.widget.attr("aria-label",a.tooltip)}catch(e){}"button"!=a.type&&"toggleButton"!=a.type||(i.length>2&&(0==r?(f.css("border-right-radius","0px"),f.addClass(o.toThemeProperty("jqx-rc-l"))):r==i.length-1&&(f.css("border-left-radius","0px"),f.addClass(o.toThemeProperty("jqx-rc-r"))),f.removeClass(o.toThemeProperty("jqx-rc-all"))),0!=r&&r!=i.length-1&&i.length>2?(f.css("border-left-radius","0px"),f.css("border-right-radius","0px"),f.removeClass(o.toThemeProperty("jqx-rc-all"))):2==i.length?(0==r?(f.css("border-right-radius","0px"),f.addClass(o.toThemeProperty("jqx-rc-l"))):(f.css("border-left-radius","0px"),f.addClass(o.toThemeProperty("jqx-rc-r"))),f.removeClass(o.toThemeProperty("jqx-rc-all"))):1==i.length&&f.css("margin-right","0px"))}})};if(o.toolbar.css("direction",this.rtl?"rtl":"ltr"),0==a.length)l(o.toolbar,n);else{for(var d=0;d<a.length;d++){var s=a[d],n=s.split(" "),c=o.toThemeProperty("jqx-editor-toolbar-group")+" "+o.toThemeProperty("jqx-fill-state-normal"),u=e("<div class='"+c+"'></div>");u.addClass(o.toThemeProperty("jqx-rc-all")),o.toolbar.append(u),l(u,n)}for(var g=o.toolbar.find(".jqx-editor-toolbar-group"),p=g.length,d=0;d<p;d++)0==e(g[d]).children().length&&e(g[d]).remove()}e.jqx.browser.msie&&e.jqx.browser.version<8&&(e(".jqx-editor-toolbar-group").css("float","left"),e(".jqx-editor-toolbar-group").children().css("float","left"),e(".jqx-editor-toolbar-group").css("zoom","1"),e(".jqx-editor-toolbar-group").children().css("zoom","1"))}o._arrange(),o._addHandlers()},_arrange:function(){var t=this;t.content&&(""==t.tools||0==t.tools?(t.content.height(t.container.outerHeight()-parseInt(t.container.css("padding-top"))-parseInt(t.container.css("padding-bottom"))-6),t.content.css("margin-top","4px"),t.toolbar.hide()):(t.toolbar.show(),t.content.css("margin-top","0px"),t.content.height(t.container.outerHeight()-t.toolbar.outerHeight()-parseInt(t.container.css("padding-top"))-parseInt(t.container.css("padding-bottom"))-2),"top"!=t.toolbarPosition&&(t.content.css("margin-top","4px"),t.content.css("margin-bottom","0px"))),e.jqx.browser.msie&&e.jqx.browser.version<8&&(t.content.css("margin-top","4px"),t.content.height(t.container.height()-t.toolbar.outerHeight()-2*parseInt(t.container.css("padding-bottom"))-10),t.content.width(t.container.width()-2*parseInt(t.container.css("padding-left"))-2)),t.editor.height()<t.content.height()&&t.editor.height(t.content.height()))},propertyChangedHandler:function(t,o,i,r){var n=t;if(void 0!=n.isInitialized&&0!=n.isInitialized&&"pasteMode"!=o&&"lineBreak"!=o&&"editable"!=o){if("disabled"==o&&t._refreshTools(),"width"==o||"height"==o||"toolbarPosition"==o)return void t._arrange();"theme"==o&&e.jqx.utilities.setTheme(i,r,t.host),t.refresh()}},selectRange:function(e){var t=this;e||(e=t.getRange()),t.selection.selectRange(e)},getRange:function(){return this.selection.getRange()},getSelectedElement:function(){var e,t,o,i,r=this;try{if(r.editorDocument.getSelection){var n=r.editorDocument.getSelection();return e=n.getRangeAt(n.rangeCount-1),o=e.startContainer,i=e.endContainer,t=e.commonAncestorContainer,"#text"==o.nodeName&&(t=t.parentNode),"#text"==o.nodeName&&(o=o.parentNode),"body"==o.nodeName.toLowerCase()&&(o=o.firstChild),"#text"==i.nodeName&&(i=i.parentNode),"body"==i.nodeName.toLowerCase()&&(i=i.lastChild),o==i&&(t=o),i}if(r.editorDocument.selection){if(e=r.editorDocument.selection.createRange(),!e.duplicate)return null;t=e.parentElement();var a=e.duplicate(),l=e.duplicate();return a.collapse(!0),l.moveToElementText(a.parentElement()),l.setEndPoint("EndToStart",a),o=a.parentElement(),a=e.duplicate(),l=e.duplicate(),l.collapse(!1),a.moveToElementText(l.parentElement()),a.setEndPoint("StartToEnd",l),i=l.parentElement(),"body"==o.nodeName.toLowerCase()&&(o=o.firstChild),"body"==i.nodeName.toLowerCase()&&(i=i.lastChild),o==i&&(t=o),i}}catch(e){return null}return null},_addHandlers:function(){var t=this;t.addHandler(t.toolbar,"mousedown.editor"+t.element.id,function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1});var o=function(){if(t._textArea&&(t.updating||(t._textArea.value=t.val())),t.changed&&(t._raiseEvent("change"),t.changed=!1),t.focused=!1,t.inline){if(t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus")),t.host.removeClass(t.toThemeProperty("jqx-editor-inline-focus")),""==t.tools||null==t.tools)return;t.toolbarContainer.fadeOut("fast")}},i=function(){if(t.focused=!0,t.inline){if(t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),t.host.addClass(t.toThemeProperty("jqx-editor-inline-focus")),t.host.addClass(t.toThemeProperty("jqx-rc-all")),""==t.tools||null==t.tools)return;t.toolbarContainer.fadeIn("fast");var e=t.host.coord();"bottom"!=t.toolbarPosition?t.toolbarContainer.offset({left:e.left,top:e.top-t.toolbarContainer.outerHeight()-5}):t.toolbarContainer.offset({left:e.left,top:e.top+5+t.host.height()})}};e.jqx.browser.mozilla&&this.addHandler(e(document),"mousedown.editor"+t.element.id,function(e){o()}),t.addHandler(t.editor,"blur.editor"+t.element.id,function(e){o()}),t.addHandler(t.editor,"focus.editor"+t.element.id,function(e){i()}),t.addHandler(t.editor,"beforedeactivate.editor"+t.element.id,function(e){t.range=t.getRange()}),t.addHandler(t.editor,"mousedown.editor"+t.element.id,function(o){o.target.href||t.linkPopup&&t.linkPopup.remove(),t.range=t.getRange(),e.jqx.browser.mozilla&&(i(),o.stopPropagation()),e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),t.inline&&t.editor.focus()}),e.jqx.mobile.isTouchDevice()&&(t.addHandler(e(t.editorDocument),"selectionchange.editor"+t.element.id,function(){t.editorDocument.activeElement!=t.editor[0]&&setTimeout(function(){t.iframe&&t.iframe[0].contentWindow.focus()},500)}),t.addHandler(e(t.editorDocument),"touchstart.editor"+t.element.id,function(){setTimeout(function(){t.iframe&&t.iframe[0].contentWindow.focus()},500)})),t.addHandler(t.editor,"mouseup.editor"+t.element.id,function(e){if("source"==t._documentMode)return!0;t.range=t.getRange(),t._refreshTools(null,!0)}),t.addHandler(t.editor,"keydown.editor"+t.element.id,function(o){if(t.keyPressed&&t.keyPressed(o),"source"==t._documentMode)return!0;if(e.jqx.browser.mozilla&&(t.focused||i()),t.changeType="keyboard",t.disabled)return o.preventDefault&&o.preventDefault(),!1;if(t.updating){if(t.activeElement){var r=e.Event("keydown");e.extend(r,o),t.activeElement.trigger(r)}return o.preventDefault&&o.preventDefault(),!1}var n=o||window.event,a=n.keyCode,l=String.fromCharCode(a).toLowerCase();if(!t.editable){var d=[9,33,34,35,36,37,38,39,40,40,45];-1!=e.inArray(n.keyCode,d)||n.ctrlKey&&"c"==l||n.ctrlKey&&"a"==l||o.preventDefault()}
if(t.selection.getText().length>0||t.linkPopup){var d=[8,9,13,33,34,35,36,37,38,39,40,40,45,46];(-1!=!e.inArray(n.keyCode,d)||65==n.keyCode&&n.ctrlKey&&!n.altKey&&!n.shiftKey)&&(t._refreshToolsTimer&&clearTimeout(t._refreshToolsTimer),t._refreshToolsTimer=setTimeout(function(){t._refreshTools(null,!0,n.keyCode)},10))}if(13==a&&"default"!=t.lineBreak){var s=t.getSelectedElement();if(s){switch(s.nodeName.toLowerCase()){case"pre":case"li":case"ul":case"ol":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return!0}for(var c=s;null!=c;){if("#document"==c.nodeName){c=t.editorDocument.body;break}if(c.parentNode==t.editorDocument.body||c==t.editorDocument.body)break;c=c.parentNode}}if(c){var u=t.getRange();"<div></div>"==t.editorDocument.body.innerHTML&&"br"!=t.lineBreak&&t.selection.insertContent("&#8203;"),"div"==t.lineBreak?c==t.editorDocument.body?e(c).append("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>"):e("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(c):"p"==t.lineBreak?c==t.editorDocument.body?e(c).append("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>"):e("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(c):t.execute("insertHTML","<br/>&#8203;<span id='INSERTION_MARKER'>&nbsp;</span>"),t.selectRange(u);var g=e(t.editorDocument).find("#INSERTION_MARKER");return"br"!=t.lineBreak?t.selection.selectNode(e(g).prev()[0],!0):(t.selection.selectNode(g[0],!0),t.getRange().setStartAfter&&t.getRange().setStartAfter(g[0])),g.remove(),t.selection.collapse(!1),c&&c.nodeName&&"br"==t.lineBreak&&"#text"!=c.nodeName.toLowerCase()&&(t.selection.selectNode(c,!0),t.getRange().setStartAfter&&t.getRange().setStartAfter(c),t.selection.collapse(!1)),"br"!=t.lineBreak&&(u=t.getRange(),u.select&&u.select()),o.preventDefault&&o.preventDefault(),!1}}if(n.ctrlKey&&("k"==l||"u"==l||"b"==l||"i"==l)){o.preventDefault&&o.preventDefault();var p=null;switch(l){case"k":p="link";break;case"u":p="underline";break;case"b":p="bold";break;case"i":p="italic"}return t.commands[p].widget&&t.commands[p].widget.trigger("click"),!1}}),t.addHandler(t.editor,"paste.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if(t.readOnly)return!0;t.updating=!0,t.readOnly=!0;try{var i=function(e,o){if(o)t.paragraphise?(e="<p>"+e+"</p>",e=e.replace(/\n/g,"</p><p>"),e=e.replace(/<p>\s<\/p>/gi,"")):e=e.replace(/\n/g,"<br />");else{if(e=e.replace(/<html[^>]*?>(.*)/gim,"$1"),e=e.replace(/<\/html>/gi,""),e=e.replace(/<body[^>]*?>(.*)/gi,"$1"),e=e.replace(/<\/body>/gi,""),e=e.replace(/<style[^>]*?>[\s\S]*?<\/style[^>]*>/gi,""),e=e.replace(/<(?:meta|link)[^>]*>\s*/gi,""),e=e.replace(/<\\?\?xml[^>]*>/gi,""),e=e.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,""),e=e.replace(/<o:p>\s*<\/o:p>/g,""),e=e.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;"),e=e.replace(/<\/?\w+:[^>]*>/gi,""),e=e.replace(/<\!--[\s\S]*?-->/g,""),e=e.replace(/<\!\[[\s\S]*?\]>/g,""),e=e.replace(/\s*mso-[^:]+:[^;"']+;?/gi,""),e=e.replace(/<(\w[^>]*) style='([^\']*)'([^>]*)/gim,"<$1$3"),e=e.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gim,"<$1$3"),e=e.replace(/\s*margin: 0cm 0cm 0pt\s*;/gi,""),e=e.replace(/\s*margin: 0cm 0cm 0pt\s*"/gi,'"'),e=e.replace(/\s*text-indent: 0cm\s*;/gi,""),e=e.replace(/\s*text-indent: 0cm\s*"/gi,'"'),e=e.replace(/\s*text-align: [^\s;]+;?"/gi,'"'),e=e.replace(/\s*page-break-before: [^\s;]+;?"/gi,'"'),e=e.replace(/\s*font-variant: [^\s;]+;?"/gi,'"'),e=e.replace(/\s*tab-stops:[^;"']*;?/gi,""),e=e.replace(/\s*tab-stops:[^"']*/gi,""),e=e.replace(/\s*face="[^"']*"/gi,""),e=e.replace(/\s*face=[^ >]*/gi,""),e=e.replace(/\s*font-family:[^;"']*;?/gi,""),e=e.replace(/\s*font-size:[^;"']*;?/gi,""),e=e.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3"),e=e.replace(/<(\w+)[^>]*\sstyle="[^"']*display\s?:\s?none[\s \S]*?<\/\1>/gi,""),e=e.replace(/\s*style='\s*'/gi,""),e=e.replace(/\s*style="\s*"/gi,""),e=e.replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/gi,"&nbsp;"),e=e.replace(/<span\s*[^>]*><\/span>/gi,""),e=e.replace(/<(\w[^>]*) align=([^ |>]*)([^>]*)/gi,"<$1$3"),e=e.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3"),e=e.replace(/<span([^>]*)>([\s\S]*?)<\/span>/gi,"$2"),e=e.replace(/<font\s*>([\s\S]*?)<\/font>/gi,"$1"),e=e.replace(/<(u|i|strike)>&nbsp;<\/\1>/gi,"&nbsp;"),e=e.replace(/<h\d>\s*<\/h\d>/gi,""),e=e.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3"),e=e.replace(/<(\w[^>]*) onmouseover="([^\"']*)"([^>]*)/gi,"<$1$3"),e=e.replace(/<(\w[^>]*) onmouseout="([^\"']*)"([^>]*)/gi,"<$1$3"),e=e.replace(/<h(\d)([^>]*)>/gi,"<h$1>"),e=e.replace(/<(h\d)><font[^>]*>([\s\S]*?)<\/font><\/\1>/gi,"<$1>$2</$1>"),e=e.replace(/<(h\d)><em>([\s\S]*?)<\/em><\/\1>/gi,"<$1>$2</$1>"),e=e.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>"),e=e.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>"),e=e.replace(/<\s+[^>]*>/gi,""),e=e.replace(/<span>([\s\S]*?)<\/span>/gi,"$1"),e=e.replace(/<span>([\s\S]*?)<\/span>/gi,"$1"),e=e.replace(/<div>([\s\S]*?)<\/div>/gi,"$1"),e=e.replace(/<div>([\s\S]*?)<\/div>/gi,"$1"),e=e.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),e=e.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),e=e.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),e.trim&&(e=e.trim()),t.paragraphise){"<p"!==e.substr(0,2)&&(e="<p>"+e+"</p>",e=e.replace(/\n/g,"</p><p>"),e=e.replace(/<br[^>]*>/gi,"</p><p>"))}else e.replace(/<p>/gi,"<br />"),e.replace(/<\/p>/gi,"");e=e.replace(/<br>/gi,"<br />"),e=e.replace(/<br[^>]*><\/p>/gim,"</p>"),e=e.replace(/<p>&nbsp;<\/p>/gi,""),e=e.replace(/<p>\s<\/p>/gi,""),e=e.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),e=e.replace(/MsoNormal/gi,""),e=e.replace(/<\/?meta[^>]*>/gi,""),e=e.replace(/<\/?xml[^>]*>/gi,""),e=e.replace(/<\?xml[^>]*\/>/gi,""),e=e.replace(/<!--(.*)-->/gi,""),e=e.replace(/<!--(.*)>/gi,""),e=e.replace(/<!(.*)-->/gi,""),e=e.replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,""),e=e.replace(/<w:[^>]*\/>/gi,""),e=e.replace(/<\/?w:[^>]*>/gi,""),e=e.replace(/<m:[^>]*\/>/gi,""),e=e.replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,""),e=e.replace(/<o:[^>]*>(.*)<\/o:[^>]*>/gi,""),e=e.replace(/<o:[^>]*\/>/gi,""),e=e.replace(/<\/?m:[^>]*>/gi,""),e=e.replace(/style=\"([^>]*)\"/gi,""),e=e.replace(/style=\'([^>]*)\'/gi,""),e=e.replace(/class=\"(.*)\"/gi,""),e=e.replace(/class=\'(.*)\'/gi,""),e=e.replace(/<b>/gi,"<strong>"),e=e.replace(/<\/b>/gi,"</strong>"),e=e.replace(/<p[^>]*>/gi,"<p>"),e=e.replace(/<\/p[^>]*>/gi,"</p>"),e=e.replace(/<span[^>]*>/gi,""),e=e.replace(/<\/span[^>]*>/gi,""),e=e.replace(/<st1:[^>]*>/gi,""),e=e.replace(/<\/st1:[^>]*>/gi,""),e=e.replace(/<font[^>]*>/gi,""),e=e.replace(/<\/font[^>]*>/gi,""),e=e.replace("  ",""),e=e.replace(/<strong><\/strong>/gi,""),e=e.replace(/<p><\/p>/gi,""),e=e.replace(/\/\*(.*)\*\//gi,""),e=e.replace(/<!--/gi,""),e=e.replace(/-->/gi,""),e=e.replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,""),e=e.trim()}return e},r=t.getRange();"text"!=t.pasteMode||e.jqx.browser.mozilla?t.selection.insertContent('<div class="jqx-editor-paste-element">&nbsp;</div>'):t.selection.insertContent('<textarea cols="50" contenteditable="false" class="jqx-editor-paste-element"></textarea>');var n=e(window).scrollTop(),a=e(t.editorDocument).find(".jqx-editor-paste-element");if(a.css("top",n+"px"),t.editor[0].createTextRange){o.preventDefault();var l=t.editor[0].createTextRange();l.moveToElementText(a[0]),l.execCommand("Paste")}else{var d=t.editorDocument.createRange();d.selectNodeContents(a[0]),t.selectRange(d)}"text"!=t.pasteMode||e.jqx.browser.mozilla||a.select(),t.marker=a,setTimeout(function(){t.selectRange(r);var o=function(e){var o=t.editorDocument.createElement("div"),i=t.editorDocument.createDocumentFragment();for(o.innerHTML=e;o.firstChild;)i.appendChild(o.firstChild);return i};if("text"!=t.pasteMode){var n=o(t.marker.html());if(n.firstChild&&"jqx-editor-paste-element"===n.firstChild.className){for(var a=[],l=0,d=n.childNodes.length;l<d;l++)a.push(n.childNodes[l].innerHTML);n=o(a.join("<br />"))}var s=document.createElement("div");s.appendChild(n.cloneNode(!0));var c=s.innerHTML}else{var c=t.marker.val();if(""!=t.marker.html()&&-1==t.marker.val().indexOf("\n")){var c=t.marker.html();c=c.replace(/&nbsp;/gm,""),c=c.replace(/\n\n/gm,"\n"),c=c.replace(/<br[^>]*>/gi,"\n"),c=c.replace(/<li[^>]*>/gi,"\n"),c=c.replace(/<p[^>]*>/gi,"\n"),t.marker.html(c);var c=t.marker.text()}}var u=i(c,"text"==t.pasteMode);t.getRange();t.selection.insertContent(u+"<span id='INSERTION_MARKER'>&nbsp;</span>"),t.marker.remove();var g=e(t.editorDocument).find("#INSERTION_MARKER");t.selection.selectNode(g[0],!0),t.getRange().setStartAfter&&t.getRange().setStartAfter(g[0]),g.remove(),t.selection.collapse(!1),g.removeAttr("id"),t._refreshTools(),t.changed=!0},100),t.updating=!1,t.readOnly=!1}catch(e){console}}),t.addHandler(t.editor,"keyup.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if(t.updating||t.disabled||!t.editable)return o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),!1;t.range=t.getRange(),t.changed=!0;var i=o||window.event,r=(i.keyCode,[8,9,13,33,34,35,36,37,38,39,40,40,45,46]);(-1!=e.inArray(i.keyCode,r)||65==i.keyCode&&i.ctrlKey&&!i.altKey&&!i.shiftKey)&&t._refreshTools(null,!0,i.keyCode)}),t.addHandler(t.editor,"click.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if(t.editImage&&(e(t.editImage).removeClass("jqx-editor-focus"),t.editImage=null),"img"==o.target.tagName.toLowerCase()){var i=o.target;t.editImage=i,e(t.editImage).addClass("jqx-editor-focus")}}),t.addHandler(t.editor,"dblclick.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if("img"==o.target.tagName.toLowerCase()){var i=o.target;e("#imageWindow"+this.element.id).length>0&&(t.editImage=i,t._updateImageWindow())}})},_updateLinkWindow:function(){var t=this,o=e("#linkWindow"+this.element.id);o.jqxWindow({position:{center:t.widget}}),o.jqxWindow("open");var i=o.find("input"),r=o.find(".jqx-editor-link-checkbox"),n=o.find("button:first"),a=e(o.find("button")[1]);if(t.editLink&&t.editLink.href)i[0].value=t.editLink.href||"",i[1].value=e(t.editLink).text()||t.editLink.href,r.val("_blank"==e(t.editLink).attr("target")),a.show();else{if(i[0].value="",i[1].value="",!t.selection.isCollapsed()){var l=t.selection.getText();l.match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?i[0].value=l:i[1].value=l}r.val(!1),a.hide()}i[0].value.length>0?n.jqxButton({disabled:!1}):n.jqxButton({disabled:!0})},_updateImageWindow:function(){var t=this,o=t.editImage;o||(o=e("<img>")[0]);var i=e("#imageWindow"+this.element.id);i.jqxWindow({position:{center:t.widget}}),i.jqxWindow("open");var r=i.find("input"),n=e(i.find("button")[1]);t.editImage?n.show():n.hide(),r[0].value=o.src,""==r[0].value&&(r[0].value=""),r[1].value=o.alt,"auto"!=o.style.width?r[2].value=o.style.width:r[2].value="","auto"!=o.style.height?r[3].value=o.style.height:r[3].value="",o.style.marginLeft&&"0px"!=o.style.marginLeft?r[4].value=o.style.marginLeft:r[4].value="",o.style.marginTop&&"0px"!=o.style.marginTop?r[5].value=o.style.marginTop:r[5].value="";var a=i.find(".jqx-editor-align"),l=e(o).css("float");"left"==l?a.jqxDropDownList({selectedIndex:1}):"right"==l?a.jqxDropDownList({selectedIndex:2}):a.jqxDropDownList({selectedIndex:0})},_removeHandlers:function(){var e=this;e.editor&&(e.removeHandler(e.editor,"blur.editor"+e.element.id),e.removeHandler(e.editor,"focus.editor"+e.element.id),e.removeHandler(e.editor,"click.editor"+e.element.id),e.removeHandler(e.editor,"mousedown.editor"+e.element.id),e.removeHandler(e.editor,"mouseup.editor"+e.element.id),e.removeHandler(e.editor,"keyup.editor"+e.element.id),e.removeHandler(e.editor,"keydown.editor"+e.element.id),e.removeHandler(e.editor,"beforedeactivate.editor"+e.element.id),e.removeHandler(e.editor,"dblclick.editor"+e.element.id)),e.toolbar&&e.removeHandler(e.toolbar,"mousedown.editor"+e.element.id)},getParentByTag:function(e,t){var t=t.toLowerCase(),o=e;do{if(""==t||o.nodeName.toLowerCase()==t)return o}while(o=o.parentNode);return e},isStyleProperty:function(e,t,o,i){var t=t.toLowerCase(),r=e;do{if(r.nodeName.toLowerCase()==t&&r.style[o]==i)return!0}while(r=r.parentNode);return!1},setStyleProperty:function(e,t){this.style[t]=!1;var o=this.getParentByTag(e,t);o&&o.tagName.toLowerCase()==t&&(this.style[t]=!0),"del"==t&&this.getParentByTag(e,"strike")&&"strike"==this.getParentByTag(e,"strike").tagName.toLowerCase()&&(this.style.del=!0)},updateStyle:function(e){var t=this,e=t.getSelectedElement()?t.getSelectedElement():e;if(e&&t.setStyleProperty)try{if(window.getComputedStyle){"#text"==e.nodeName.toLowerCase()&&(e=t.editor[0]);var o=window.getComputedStyle(e,null),i=401==o.getPropertyValue("font-weight")?700:o.getPropertyValue("font-weight");t.style={fontStyle:o.getPropertyValue("font-style"),fontSize:o.getPropertyValue("font-size"),textDecoration:o.getPropertyValue("text-decoration"),fontWeight:i,fontFamily:o.getPropertyValue("font-family"),textAlign:o.getPropertyValue("text-align"),color:t._rgbToHex(o.color),backColor:t._rgbToHex(o.backgroundColor)},t.style.fontStyle=o.getPropertyValue("font-style"),t.style.vAlign=o.getPropertyValue("vertical-align"),t.style.del=t.isStyleProperty(e,"span","textDecoration","line-through"),t.style.u=t.isStyleProperty(e,"span","textDecoration","underline");t.style.backColor||(t.style.backColor=t._rgbToHex(function(e){for(var t="transparent";e&&(window.getComputedStyle(e).backgroundColor==t||"rgba(0, 0, 0, 0)"==window.getComputedStyle(e).backgroundColor);)e=e.parentNode;return e?window.getComputedStyle(e).backgroundColor:t}(e)))}else{var o=e.currentStyle;t.style={fontStyle:o.fontStyle,fontSize:o.fontSize,textDecoration:o.textDecoration,fontWeight:o.fontWeight,fontFamily:o.fontFamily,textAlign:o.textAlign,color:t._rgbToHex(o.color),backColor:t._rgbToHex(o.backgroundColor)}}t.setStyleProperty(e,"h1"),t.setStyleProperty(e,"h2"),t.setStyleProperty(e,"h3"),t.setStyleProperty(e,"h4"),t.setStyleProperty(e,"h5"),t.setStyleProperty(e,"h6"),t.setStyleProperty(e,"del"),t.setStyleProperty(e,"sub"),t.setStyleProperty(e,"sup"),t.setStyleProperty(e,"u"),"a"==e.nodeName.toLowerCase()&&"underline"==t.style.textDecoration&&(t.style.u=!0),(t.style.h1||t.style.h2||t.style.h3||t.style.h4||t.style.h5||t.style.h6)&&(t.style.heading=!0)}catch(e){return null}},_refreshTools:function(t,o,i){var r=this;if(!r.updating){var t=r.getSelectedElement()?r.getSelectedElement():t;if(t&&r.setStyleProperty){r.updateStyle(t);var n=r.readOnly;if(r.readOnly=!0,!1!==r.tools){var a=r.tools.split(" "),l=r.tools.split(" | "),d=function(t){e.each(t,function(e,t){var o=r.commands[this];if(!o)return!0;switch(o.type){case"list":o.widget.jqxDropDownList("clearSelection"),o.widget.jqxDropDownList({disabled:r.disabled});break;case"colorPicker":o.val(o.value),o.widget.jqxDropDownButton({disabled:r.disabled});break;case"toggleButton":o.widget.jqxToggleButton("unCheck"),o.widget.jqxToggleButton({disabled:r.disabled});break;case"button":default:o.widget.jqxButton({disabled:r.disabled})}})};if(0==l.length)d(a);else for(var s=0;s<l.length;s++){var c=l[s],a=c.split(" ");d(a)}if(r.style){var u=function(i){e.each(i,function(i,n){var a=r.commands[this];if(!a)return!0;if(a.refresh)return a.refresh(a.widget,r.style),!0;switch(a.type){case"list":if("fontname"==a.command){for(var l=-1,d=999,s=0;s<a.value.length;s++){var n=a.value[s].label.toLowerCase(),c=r.style.fontFamily.toLowerCase().indexOf(n);c>=0&&(c<d&&(l=s),d=Math.min(d,c))}a.widget.jqxDropDownList("selectIndex",l)}else if("formatblock"==a.command){var n=null;r.style.h1?n="h1":r.style.h2?n="h2":r.style.h3?n="h3":r.style.h4?n="h4":r.style.h5?n="h5":r.style.h6&&(n="h6"),a.widget.jqxDropDownList("selectItem",n)}else if("fontsize"==a.command){var u="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),g=-1;try{var g=t.getAttribute("size")-1;-1==g&&(g=r.editorDocument.queryCommandValue(a.command)-1)}catch(e){}var p=u[g];a.widget.val(p)}break;case"colorPicker":var h=function(e){return"number"!=typeof e?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")"}(r.editorDocument.queryCommandValue(a.command));"backcolor"==a.command&&null==r.style.backColor&&(h="#FFFFFF");var m=r._rgbToHex(h);m?a.val(m):"forecolor"==a.command?a.val(r.style.color):"backcolor"==a.command&&a.val(r.style.backColor);break;case"toggleButton":if("viewsource"==a.command)return;if(!a.command)return;var f=!1,v=r.editorDocument.queryCommandState(a.command)&&r.editorDocument.queryCommandEnabled(a.command);if("createlink"==a.command&&"a"==t.nodeName.toLowerCase()){var b=!0;if(-1==e(t).text().indexOf(r.selection.getText())&&""!=r.selection.getText()&&(b=!1),b){r.linkPopup&&r.linkPopup.remove(),v=!0,r.linkPopup=e("<div class='jqx-editor-link-popup' contentEditable='false' style='overflow: hidden; white-space: nowrap; padding: 5px; height: 17px; font-size: 12px; color: #222222; background: #F5F5F5; position: absolute; z-index: 9999;'>"+r.localization["Go to link"]+": <a target='_blank' style='color:#222222;' href='"+t.href+"'>"+t.href+"</a> - <a style='color:#222222;' href='#change'>"+r.localization.Change+"</a> - <a style='color:#222222;' href='#remove'>"+r.localization.Remove+"</a></div>").appendTo(r.editor);var x=e(t).coord(),y=x.left;x.left+r.linkPopup.width()>r.editor.width()&&(y=r.editor.width()-r.linkPopup.width()-15),r.linkPopup.offset({top:e(t).height()+x.top+5,left:y}),r.addHandler(r.linkPopup,"mousedown",function(o){if(o.target&&o.target.href){switch(e(o.target).index()){case 1:r.editor.focus(),r.selection.selectNode(t,!0),r.commands.link.widget.trigger("click");break;case 2:try{r.editor.focus(),r.selection.selectNode(t),r.execute("unlink"),r.commands.underline.toggled=!1,r.selection.collapse(!1),r._refreshTools()}catch(e){}break;default:window.open(o.target.href,"_blank")}}return o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),!1})}}"bold"==a.command?(r.style.fontWeight&&(r.style.fontWeight>=600||"bold"==r.style.fontWeight)&&(f=!0),r.selection.isCollapsed()?a.toggled=v:a.toggled=v||f,v=a.toggled):"italic"==a.command?(r.style.fontStyle&&"italic"==r.style.fontStyle&&(f=!0),o?a.toggled=v:v=a.toggled):"underline"==a.command?(r.style.u&&(f=!0),o?a.toggled=v:v=a.toggled):"justifyleft"==a.command?"left"==r.style.textAlign&&(f=!0):"justifyright"==a.command?"right"==r.style.textAlign&&(f=!0):"justifycenter"==a.command?"center"==r.style.textAlign&&(f=!0):"justifyfull"==a.command?"justify"==r.style.textAlign&&(f=!0):e.each(r.style,function(e,t){a.command==e.toLowerCase()&&(f=!0)});var w=v;f&&-1!=a.command.indexOf("justify")?a.widget.jqxToggleButton("check"):w?a.widget.jqxToggleButton("check"):f&&!1===r.range.collapsed?a.widget.jqxToggleButton("check"):e.jqx.browser.msie&&e.jqx.browser.version<9&&f&&!r.selection.isCollapsed()&&a.widget.jqxToggleButton("check");break;case"button":default:a.refresh&&a.refresh(a.widget,r.style)}})};if(0==l.length)u(a);else for(var s=0;s<l.length;s++){var c=l[s],a=c.split(" ");u(a)}}}r.readOnly=n}}},_rgbToHex:function(e){if(e){if("#"===e.substr(0,1)){if(4==e.length){var t=e.substr(1,1),o=e.substr(2,1),i=e.substr(3,1);return"#"+t+t+o+o+i+i}return e}var r=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e);if(!r)return null;var t=parseInt(r[2],10).toString(16),o=parseInt(r[3],10).toString(16),i=parseInt(r[4],10).toString(16);return"#"+((1==t.length?"0"+t:t)+(1==o.length?"0"+o:o)+(1==i.length?"0"+i:i))}return null},_preventDefault:function(t,o){!1!==o&&(e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close")),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1},_addCommandHandler:function(t,o,i,r,n){var a=this;switch(!i&&n.init&&(i="custom"),i){case"custom":switch(n.type){case"list":action=function(t){"source"!=a._documentMode&&"none"!=t.args.type&&(n.value=e(this).val(),a.execute("custom",n),a.readOnly||a._refreshTools()),a._preventDefault(t,!1)};break;case"colorPicker":action=function(t){if("source"!=a._documentMode){e(n.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell");if("div"==t.target.nodeName.toLowerCase()){var o=e(t.target).css("background-color");e(t.target).parent().addClass("jqx-editor-color-picker-selected-cell")}else{var o=e(t.target).find("div").css("background-color");e(t.target).addClass("jqx-editor-color-picker-selected-cell")}e("#bar-"+i).css("background",o),n.widget.val=function(){var e=function(e){return"number"!=typeof e?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")"}(o);return a._rgbToHex(e)},n.widget.jqxDropDownButton("close"),a.execute("custom",n)}return a._preventDefault(t),!1};break;case"button":case"toggleButton":default:action=function(t){e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(t);e(this).attr("data-command");return"source"!=a._documentMode&&(n.toggle&&n.toggle(),a.execute("custom",n),a._refreshTools()),!1}}break;case"formatblock":action=function(t){"source"!=a._documentMode&&"none"!=t.args.type&&(a.execute(e(this).attr("data-command"),"<"+e(this).val()+">",n),a.readOnly||(a.commands.bold.toggled=!1,a._refreshTools())),a._preventDefault(t,!1)};break;case"fontsize":action=function(t){if("source"!=a._documentMode&&"none"!=t.args.type){var o=e(this).val(),i="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),r=e(this).jqxDropDownList("getSelectedIndex")+1,r=1+i.indexOf(o);a.execute(e(this).attr("data-command"),r,n)}a._preventDefault(t,!1)};break;case"fontname":action=function(t){if("source"!=a._documentMode&&"none"!=t.args.type){var o=e(this).val();a.execute(e(this).attr("data-command"),o,n)}a._preventDefault(t,!1)};break;case"forecolor":case"backcolor":action=function(t){if("source"!=a._documentMode){e(n.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell");if("div"==t.target.nodeName.toLowerCase()){var o=e(t.target).css("background-color");e(t.target).parent().addClass("jqx-editor-color-picker-selected-cell")}else{var o=e(t.target).find("div").css("background-color");e(t.target).addClass("jqx-editor-color-picker-selected-cell")}e("#bar-"+i).css("background",o),n.widget.jqxDropDownButton("close"),a.execute(i,o,n)}return a._preventDefault(t),!1};break;case"viewsource":action=function(t){return a.linkPopup&&a.linkPopup.remove(),n.toggle(),a.setMode(n.toggled),e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(t),!1};break;case"insertimage":action=function(e){a._insertImageAction(e,a,n)};break;case"createlink":action=function(e){a._createLinkAction(e,a,n)};break;default:action=function(t){e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(t);var o=e(this).attr("data-command");if("source"!=a._documentMode){if("underline"==o&&a.getSelectedElement()){var i=a.getSelectedElement();if(i&&"a"==i.nodeName.toLowerCase())return n.toggled?e(i).css("text-decoration","none"):e(i).css("text-decoration","underline"),n.toggle(),a._refreshTools(),!1}n.toggle&&n.toggle(),a.execute(o,e(this).val(),n),a._refreshTools()}return!1}}return a.addHandler(t,o,action),!1},_createLinkAction:function(t,o,i){var o=this;if("source"==o._documentMode)return void o._preventDefault(t);o.focused||o.editor.focus(),o.range=o.getRange();var r=o.getSelectedElement();if("a"==r.nodeName.toLowerCase()?o.editLink=r:o.editLink=null,e("#linkWindow"+this.element.id).length>0)return o.editLink&&o.selection.selectNode(r,!0),o._updateLinkWindow(),o._preventDefault(t),!1;var n=e("<div class='jqx-editor-window jqx-editor-link-window'><div>"+o.localization["Insert Link"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+o.localization.URL+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.Title+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'></td><td><div class='jqx-editor-link-checkbox'>"+o.localization["Open in a new window/tab"]+"</div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>");n[0].id="linkWindow"+this.element.id;var a=n.find("input");a.addClass(o.toThemeProperty("jqx-widget")),a.addClass(o.toThemeProperty("jqx-widget-content")),a.addClass(o.toThemeProperty("jqx-input"));var l=n.find(".jqx-editor-link-checkbox").jqxCheckBox({theme:o.theme,height:23,width:180}),d=n.find("button:first").jqxButton({theme:o.theme,disabled:!0}),s=e(n.find("button")[1]).jqxButton({theme:o.theme}),c=n.find("button:last").jqxButton({theme:o.theme});d.val(o.localization.Ok),c.val(o.localization.Cancel),s.val(o.localization.Remove),o.addHandler(c,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){o.editor.focus(),o.selectRange(o.range),o._refreshTools(),o._preventDefault(e)}),(!o.editLink||o.editLink&&!o.editLink.href)&&s.hide();var u=!1;if(o.addHandler(e(a[0]),"focus",function(){u=""==a[1].value||a[1].value==a[0].value}),o.addHandler(e(a[1]),"keyup",function(e){e.keyCode&&(13==e.keyCode&&d.trigger("click"),27==e.keyCode&&c.trigger("click"))}),o.addHandler(e(a[0]),"keyup change",function(e){a[0].value.length>0?d.jqxButton({disabled:!1}):d.jqxButton({disabled:!0}),u&&(a[1].value=a[0].value),e.keyCode&&(13==e.keyCode&&d.trigger("click"),27==e.keyCode&&c.trigger("click"))}),o.addHandler(s,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){n.jqxWindow("close");try{o.editor.focus(),o.selection.selectNode(o.editLink),o.execute("unlink"),o.selection.collapse(!1),o.commands.underline.toggled=!1,o._refreshTools()}catch(e){}o._preventDefault(e)}),o.addHandler(d,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){var r=n.find("input"),a=e("<a>"+(r[1].value||r[0].value)+"</a>");l.val()&&a.attr("target","_blank"),a[0].href=e.trim(r[0].value),-1==r[0].value.indexOf("http")&&-1==r[0].value.indexOf("mailto")&&(a[0].href="http://"+e.trim(r[0].value)),o.focused||o.editor.focus(),o.range&&o.selectRange(o.range),o.editLink&&e(o.editLink).remove(),o.execute("insertHTML",a[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",i),o.editor.focus();var d=e(o.editorDocument).find("#INSERTION_MARKER");o.selection.selectNode(d[0],!0),o.getRange().setStartAfter&&o.getRange().setStartAfter(d[0]),d.remove(),o.selection.collapse(!1),o._refreshTools(),o._preventDefault(t)}),o.updating=!0,n.appendTo(document.body),o.addHandler(n,"open",function(){o.updating=!0,setTimeout(function(){o.range=o.getRange(),e(a[0]).focus()},25)}),n.jqxWindow({resizable:!1,width:280,okButton:d,cancelButton:c,theme:o.theme,isModal:!0,position:{center:o.widget}}),o.addHandler(n,"close",function(){o.updating=!1}),o.focused||(o.editor.focus(),o.selectRange(o.range)),o.editLink)a[0].value=o.editLink.href||"",a[1].value=e(o.editLink).text(),l.val("_blank"==e(o.editLink).attr("target"));else if(!o.selection.isCollapsed()){var g=o.selection.getText();g.match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?a[0].value=g:a[1].value=g}return a[0].value.length>0?d.jqxButton({disabled:!1}):d.jqxButton({disabled:!0}),o._preventDefault(t),!1},_insertImageAction:function(t,o,i){if("source"==o._documentMode)return void o._preventDefault(t);if(o.focused||o.editor.focus(),o.range=o.getRange(),e("#imageWindow"+this.element.id).length>0)return o._updateImageWindow(),o._preventDefault(t),!1;var r=e("<div class='jqx-editor-window jqx-editor-image-window'><div>"+o.localization["Insert Image"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+o.localization.URL+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization["Alt Text"]+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.Width+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.Height+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.HSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-hspace'/></td><tr/><tr><td align='right'>"+o.localization.VSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-vspace'/></td><tr/><tr><td align='right'>"+o.localization.Align+":</td><td><div class='jqx-editor-align'></div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>");r[0].id="imageWindow"+this.element.id;var n=r.find("input");n.addClass(o.toThemeProperty("jqx-widget")),n.addClass(o.toThemeProperty("jqx-widget-content")),n.addClass(o.toThemeProperty("jqx-input")),r.find(".jqx-editor-align").jqxDropDownList({autoDropDownHeight:!0,selectedIndex:0,theme:o.theme,height:23,width:180,source:[o.localization["not set"],o.localization.Left,o.localization.Right]});var a=r.find("button:first").jqxButton({theme:o.theme}),l=r.find("button:last").jqxButton({theme:o.theme}),d=e(r.find("button")[1]).jqxButton({theme:o.theme});return a.val(o.localization.Ok),l.val(o.localization.Cancel),d.val(o.localization.Remove),d.hide(),o.addHandler(d,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){e(o.editImage).removeClass("jqx-editor-focus"),e(o.editImage).remove(),o.editImage=null,o._preventDefault(t),r.jqxWindow("close"),o._raiseEvent("change")}),o.addHandler(l,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){e(o.editImage).removeClass("jqx-editor-focus"),o.editImage=null,o._preventDefault(t)}),o.addHandler(a,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){e(o.editImage).removeClass("jqx-editor-focus");var n=r.find("input"),a=e(o.editImage?o.editImage:'<img style="border: 1px solid transparent;">'),l=a.attr("src",n[0].value).attr("unselectable","on");n[1].value&&l.attr("alt",n[1].value).attr("title",n[1].value),n[2].value&&!isNaN(parseInt(n[2].value))?l.width(n[2].value):l.css("width","auto"),n[3].value&&!isNaN(parseInt(n[3].value))?l.height(n[3].value):l.css("height","auto"),n[4].value?"auto"==n[4].value.toString()?(l.css("margin-left","auto"),l.css("margin-right","auto")):-1!=n[4].value.toString().indexOf("%")?(l.css("margin-left",parseInt(n[4].value)+"%"),l.css("margin-right",parseInt(n[4].value)+"%")):(l.css("margin-left",parseInt(n[4].value)+"px"),l.css("margin-right",parseInt(n[4].value)+"px")):(l.css("margin-left","0px"),l.css("margin-right","0px")),n[5].value?"auto"==n[5].value.toString()?(l.css("margin-top","auto"),l.css("margin-bottom","auto")):-1!=n[5].value.toString().indexOf("%")?(l.css("margin-top",parseInt(n[5].value)+"%"),l.css("margin-bottom",parseInt(n[5].value)+"%")):(l.css("margin-top",parseInt(n[5].value)+"px"),l.css("margin-bottom",parseInt(n[5].value)+"px")):(l.css("margin-top","0px"),l.css("margin-bottom","0px"));var d=r.find(".jqx-editor-align").jqxDropDownList("selectedIndex");if(1==d?l.css("float","left"):2==d?l.css("float","right"):0==d&&l.css("float","none"),l.css("resize",!1),l[0].oncontrolselect=function(){return!1},l[0].selectstart=function(){return!1},!o.editImage){o.focused||o.editor.focus(),o.range&&o.selectRange(o.range),
o.execute("insertHTML",l[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",i),o.editor.focus();var s=e(o.editorDocument).find("#INSERTION_MARKER");o.selection.selectNode(s[0],!0),o.getRange().setStartAfter&&o.getRange().setStartAfter(s[0]),s.remove(),o.selection.collapse(!1),o._refreshTools(),o._preventDefault(t)}o.editImage=null,o._preventDefault(t)}),r.appendTo(document.body),o.updating=!0,o.addHandler(r,"open",function(){o.updating=!0,setTimeout(function(){o.range=o.getRange(),e(n[0]).focus()},25)}),r.jqxWindow({resizable:!1,width:280,okButton:a,cancelButton:l,theme:o.theme,isModal:!0,position:{center:o.widget}}),o.addHandler(r,"close",function(){o.updating=!1}),o.focused||(o.editor.focus(),o.selectRange(o.range)),o._preventDefault(t),!1},editmode:function(t){var o=this;if(t||o.readOnly){if(t&&o.readOnly){var i=o.editor.find("#sourceText").text();o.editor.html(i),o.buttons.hasOwnProperty("html")&&o.buttons.html.removeClass("active"),o.editor.attr("contentEditable",!0),o._addHandlers()}}else{o._removeHandlers(),o.editor.attr("contentEditable",!1);var i=document.createTextNode(o.editor.html()),r=e("<pre>");r.html(i).attr({id:"sourceText",contentEditable:!0}).css("height","100%"),o.editor.html(r),o.buttons.hasOwnProperty("html")&&o.buttons.html.addClass("active"),r.focus()}o.readOnly=!t},setMode:function(t){var i=this;i.range||(i.editor.focus(),i.range=i.getRange());var r,n=i.editor[0];if(t){i._documentMode="source";var a=new o,l=a.HTMLtoXML(n.innerHTML);l=a.FormatHTML(l),r=document.createTextNode(l),n.innerHTML="";var d=document.createElement("pre");n.contentEditable=!1,d.style.height="100%",d.style.margin="0px",d.style.outline="none",d.style.display="block",d.id="sourceText",d.contentEditable=!0,d.appendChild(r),n.appendChild(d),this.readOnly=!0}else this._documentMode="html",document.all?n.innerHTML=n.innerText:n.textContent?n.innerHTML=n.textContent:(r=document.createRange(),r.selectNodeContents(n.firstChild),n.innerHTML=r.toString()),n.contentEditable=!0,i.readOnly=!1,i._refreshTools(),i.editor.focus(),i.selection.selectNode(i.editor[0]),i.editor.scrollTop(0),i.selection.collapse(!0);if(e.each(this.commands,function(){if(this.widget&&"viewsource"!=this.command)switch(this.type){case"list":this.widget.jqxDropDownList({disabled:t});break;case"colorPicker":this.widget.jqxDropDownButton({disabled:t});break;case"button":this.widget.jqxButton({disabled:t});break;case"toggleButton":this.widget.jqxToggleButton({toggled:!1,disabled:t})}}),i.editor.focus(),e.jqx.browser.mozilla){var s=e("<a href='#'>anchor</a>");i.editor.prepend(s),s.focus(),s.remove(),i.selection.collapse(!0)}i.commands.html.widget&&(i.commands.html.widget.jqxToggleButton({toggled:"source"==t||1==t}),i.commands.html.toggled="source"==t||1==t)},execute:function(t,o,i){var r=this;if(!r.readOnly){var n=r.editorDocument;if("source"==r._documentMode)return;r.changeType="mouse",r.linkPopup&&r.linkPopup.remove(),r.editor.focus(),e.jqx.browser.mozilla,e.jqx.mobile.isTouchDevice()&&setTimeout(function(){},25);var a=function(t){try{if(t.command&&"inserthtml"==t.command.toLowerCase()){var o=r.getRange(),i=t.value;-1==i.toString().indexOf("<")&&(i="<span>"+t.value+"</span>"),r.selection.insertContent(i+"<span id='INSERTION_MARKER'>&nbsp;</span>"),r.selectRange(o),setTimeout(function(){var t=e(r.editorDocument).find("#INSERTION_MARKER");r.selection.selectNode(e(t).prev()[0],!0),t.remove(),r.selection.collapse(!1)},10)}else if(t.command){if(!n.queryCommandEnabled(t.command))return!1;n.execCommand(t.command,!1,t.value)}else{if(!n.queryCommandEnabled(t))return!1;n.execCommand(t,!1,t)}}catch(e){}};if("custom"==t){var l=o.action(o.widget,r.editor);l&&a(l)}else try{if(i&&i.action){var l=i.action(i.widget,r.editor);a(l)}else if(n.queryCommandEnabled(t))n.execCommand(t,!1,o);else{if("insertHTML"!=t)return!1;r.selection.insertContent(o)}}catch(e){if("insertHTML"!=t)return!1;r.selection.insertContent(o)}e.jqx.mobile.isTouchDevice()&&setTimeout(function(){r.iframe&&r.iframe[0].contentWindow.focus()},500),r._raiseEvent("change",{command:t,args:o}),r.changed=!0,r.range=r.getRange()}},destroy:function(){var t=this;t._removeHandlers();var o=t.tools.split(" "),i=t.tools.split(" | ");e.jqx.utilities.resize(this.host,null,!0);var r=function(o){e.each(o,function(o,i){var r=t.commands[this];if(!r)return!0;switch(r.type){case"list":r.widget.jqxDropDownList("destroy");break;case"colorPicker":r.colorPicker.remove(),r.widget.jqxDropDownButton("destroy");break;case"toggleButton":r.widget.jqxToggleButton("destroy");break;case"custom":t.destroyTool&&t.destroyTool(this);break;case"button":default:r.widget.jqxToggleButton("destroy"),"insertimage"===r.command?e("#imageWindow"+t.element.id).length>0&&(e("#imageWindow"+t.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),e("#imageWindow"+t.element.id).find("button").jqxButton("destroy")):"createlink"===r.command&&e("#linkWindow"+t.element.id).length>0&&(e("#linkWindow"+t.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),e("#linkWindow"+t.element.id).find("button").jqxButton("destroy"),e("#linkWindow"+t.element.id).find(".jqx-editor-link-checkbox").jqxCheckBox("destroy"))}})};if(0==i.length)r(o);else for(var n=0;n<i.length;n++){var a=i[n],o=a.split(" ");r(o)}var l=e("#linkWindow"+this.element.id),d=e("#imageWindow"+this.element.id);l&&l.length>0&&l.jqxWindow("destroy"),d&&d.length>0&&d.jqxWindow("destroy"),t.inline?t.toolbar.remove():(t.widget.remove(),t.host.remove()),t.iframe.remove(),t.iframe=null,t.selection=null,t.editorDocument=null,t.contentEditableElement=null},val:function(e){return void 0!=e&&"object"!=typeof e&&this.editor.html(e),this.editor.html()},_raiseEvent:function(t,o){if(void 0==o&&(o={owner:null}),"source"==this._documentMode)return!0;var i=t;o.type=this.changeType,this.changeType=null,args=o,args.owner=this;var r=new e.Event(i);if(r.owner=this,r.args=args,this._textArea)var n=e(this._textArea).trigger(r);else var n=this.host.trigger(r);return o=r.args,n}});var t=function(t){var o={initialize:function(e){this.document=e},getSelection:function(){return this.document.getSelection?this.document.getSelection():this.document.selection},getRange:function(){var e=this.getSelection();if(!e)return null;try{return e.rangeCount>0?e.getRangeAt(0):this.document.createRange?this.document.createRange():this.document.selection.createRange()}catch(e){return this.document.body.createTextRange()}},selectRange:function(e){if(e.select)e.select();else{var t=this.getSelection();t.addRange&&(t.removeAllRanges(),t.addRange(e))}},selectNode:function(e,t){var o=this.getRange(),i=this.getSelection();if(o.moveToElementText)o.moveToElementText(e),o.select();else if(i.addRange)try{t?o.selectNodeContents(e):o.selectNode(e),i.removeAllRanges(),i.addRange(o)}catch(e){}else i.setBaseAndExtent(e,0,e,1);return e},isCollapsed:function(){var e=this.getRange();return!e.item&&(0==e.boundingWidth||this.getSelection().isCollapsed)},collapse:function(e){var t=this.getRange(),o=this.getSelection();t.select?(t.collapse(e),t.select()):e?o.collapseToStart():o.collapseToEnd()},getContent:function(){var t=this.getRange(),o=e("<div>")[0];return this.isCollapsed()?"":(t.cloneContents?o.appendChild(t.cloneContents()):void 0!=t.item||void 0!=t.htmlText?e(o).html(t.item?t.item(0).outerHTML:t.htmlText):e(o).html(t.toString()),e(o).html())},getText:function(){var e=this.getRange(),t=this.getSelection();return this.isCollapsed()?"":e.text||(t.toString?t.toString():"")},getNode:function(){var o=this.getRange();if(!e.jqx.browser.msie||e.jqx.browser.version>=9){var i=null;if(o)for(i=o.commonAncestorContainer,o.collapsed||o.startContainer==o.endContainer&&o.startOffset-o.endOffset<2&&o.startContainer.hasChildNodes()&&(i=o.startContainer.childNodes[o.startOffset]);"element"!=typeof i;)i=i.parentNode;return t.id(i)}return t.id(o.item?o.item(0):o.parentElement())},insertContent:function(e){var t=this.getRange();if(t.pasteHTML)t.pasteHTML(e),t.collapse(!1),t.select();else if(t.insertNode)if(t.deleteContents(),t.createContextualFragment)t.insertNode(t.createContextualFragment(e));else{var o=this.document,i=o.createDocumentFragment(),r=o.createElement("div");i.appendChild(r),r.outerHTML=e,t.insertNode(i)}}};return o.initialize(t),o},o=function(){function e(e){for(var t={},o=e.split(","),i=0;i<o.length;i++)t[o[i]]=!0;return t}var t=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,o=/^<\/([-A-Za-z0-9_]+)[^>]*>/,i=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,r=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),n=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),a=e("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),l=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),d=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),s=e("script,style"),c=this.HTMLParser=function(e,c){function u(e,t,o,s){if(t=t.toLowerCase(),n[t])for(;f.last()&&a[f.last()];)g("",f.last());if(l[t]&&f.last()==t&&g("",t),s=r[t]||!!s,s||f.push(t),c.start){var u=[];o.replace(i,function(e,t){var o=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:d[t]?t:"";u.push({name:t,value:o,escaped:o.replace(/(^|[^\\])"/g,'$1\\"')})}),c.start&&c.start(t,u,s)}}function g(e,t){if(t)for(var o=f.length-1;o>=0&&f[o].toLowerCase()!=t.toLowerCase();o--);else var o=0;if(o>=0){for(var i=f.length-1;i>=o;i--)c.end&&c.end(f[i]);f.length=o}}var p,h,m,f=[];for(f.last=function(){return this[this.length-1]};e;){if(h=!0,f.last()&&s[f.last()])e=e.replace(new RegExp("(.*)</"+f.last()+"[^>]*>"),function(e,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),c.chars&&c.chars(t),""}),g("",f.last());else if(0==e.indexOf("\x3c!--")?(p=e.indexOf("--\x3e"))>=0&&(c.comment&&c.comment(e.substring(4,p)),e=e.substring(p+3),h=!1):0==e.indexOf("</")?(m=e.match(o))&&(e=e.substring(m[0].length),m[0].replace(o,g),h=!1):0==e.indexOf("<")&&(m=e.match(t))&&(e=e.substring(m[0].length),m[0].replace(t,u),h=!1),h){p=e.indexOf("<");var v=p<0?e:e.substring(0,p);e=p<0?"":e.substring(p),c.chars&&c.chars(v)}e}g()};this.HTMLtoXML=function(e){var t="";return e=e.replace(/\r/gi,""),e=e.replace(/\n/gi,""),c(e,{start:function(e,o,i){t+="<"+e;for(var r=0;r<o.length;r++)t+=" "+o[r].name+'="'+o[r].escaped+'"';t+=(i?"/":"")+">"},end:function(e){t+="</"+e+">\r\n"},chars:function(e){t+=e},comment:function(e){t+="\x3c!--"+e+"--\x3e"}}),t},this.FormatHTML=function(e,t){function o(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(e,t){for(var o=0;o<t.length;o++)if(e===t[o])return!0;return!1}},this.get_content=function(){for(var e="",t=[],o=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(e,this.Utils.whitespace))t.length&&(o=!0),this.line_char_count--;else{if(o){if(this.line_char_count>=this.max_char){t.push("\n");for(var i=0;i<this.indent_level;i++)t.push(this.indent_string);this.line_char_count=0}else t.push(" "),this.line_char_count++;o=!1}t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos==this.input.length)return["","TK_EOF"];var t="",o=new RegExp("</"+e+"\\s*>","igm");o.lastIndex=this.pos;var i=o.exec(this.input),r=i?i.index:this.input.length;return this.pos<r&&(t=this.input.substring(this.pos,r),this.pos=r),t},this.record_tag=function(e){this.tags[e+"count"]?(this.tags[e+"count"]++,this.tags[e+this.tags[e+"count"]]=this.indent_level):(this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level),this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1==this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.get_tag=function(){var e,t,o="",i=[],r=!1;do{if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"];o=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(o,this.Utils.whitespace)?(r=!0,this.line_char_count--):("'"!==o&&'"'!==o||i[1]&&"!"===i[1]||(o+=this.get_unformatted(o),r=!0),"="===o&&(r=!1),i.length&&"="!==i[i.length-1]&&">"!==o&&r&&(this.line_char_count>=this.max_char?(this.print_newline(!1,i),this.line_char_count=0):(i.push(" "),this.line_char_count++),r=!1),"<"===o&&(e=this.pos-1),i.push(o))}while(">"!==o);var n,a=i.join("");n=-1!=a.indexOf(" ")?a.indexOf(" "):a.indexOf(">");var l=a.substring(1,n).toLowerCase();if("/"===a.charAt(a.length-2)||this.Utils.in_array(l,this.Utils.single_token))this.tag_type="SINGLE";else if("script"===l)this.record_tag(l),this.tag_type="SCRIPT";else if("style"===l)this.record_tag(l),this.tag_type="STYLE";else if(this.Utils.in_array(l,d)){var s=this.get_unformatted("</"+l+">",a);i.push(s),e>0&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&i.splice(0,0,this.input.charAt(e-1)),t=this.pos-1,this.Utils.in_array(this.input.charAt(t+1),this.Utils.whitespace)&&i.push(this.input.charAt(t+1)),this.tag_type="SINGLE"}else if("!"===l.charAt(0))if(-1!=l.indexOf("[if")){if(-1!=a.indexOf("!IE")){var s=this.get_unformatted("--\x3e",a);i.push(s)}this.tag_type="START"}else if(-1!=l.indexOf("[endif"))this.tag_type="END",this.unindent();else if(-1!=l.indexOf("[cdata[")){var s=this.get_unformatted("]]>",a);i.push(s),this.tag_type="SINGLE"}else{var s=this.get_unformatted("--\x3e",a);i.push(s),this.tag_type="SINGLE"}else"/"===l.charAt(0)?(this.retrieve_tag(l.substring(1)),this.tag_type="END"):(this.record_tag(l),this.tag_type="START"),this.Utils.in_array(l,this.Utils.extra_liners)&&this.print_newline(!0,this.output);return i.join("")},this.get_unformatted=function(e,t){if(t&&-1!=t.indexOf(e))return"";var o="",i="",r=!0;do{if(this.pos>=this.input.length)return i;if(o=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(o,this.Utils.whitespace)){if(!r){this.line_char_count--;continue}if("\n"===o||"\r"===o){i+="\n",this.line_char_count=0;continue}}i+=o,this.line_char_count++,r=!0}while(-1==i.indexOf(e));return i},this.get_token=function(){var e;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var t=this.last_token.substr(7);return e=this.get_contents_to(t),"string"!=typeof e?e:[e,"TK_"+t]}if("CONTENT"===this.current_mode)return e=this.get_content(),"string"!=typeof e?e:[e,"TK_CONTENT"];if("TAG"===this.current_mode){if("string"!=typeof(e=this.get_tag()))return e;return[e,"TK_TAG_"+this.tag_type]}},this.get_full_indent=function(e){return e=this.indent_level+e||0,e<1?"":Array(e+1).join(this.indent_string)},this.printer=function(e,t,o,i,r){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=o,this.brace_style=r,this.indent_level=0,this.max_char=i,this.line_char_count=0;for(var n=0;n<this.indent_size;n++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){if(this.line_char_count=0,t&&t.length){if(!e)for(;this.Utils.in_array(t[t.length-1],this.Utils.whitespace);)t.pop();t.push("\n");for(var o=0;o<this.indent_level;o++)t.push(this.indent_string)}},this.print_token=function(e){this.output.push(e)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var i,r,n,a,l,d;for(t=t||{},r=t.indent_size||4,n=t.indent_char||" ",l=t.brace_style||"collapse",a=1/0,d=t.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],i=new o,i.printer(e,n,r,a,l);;){var s=i.get_token();if(i.token_text=s[0],i.token_type=s[1],"TK_EOF"===i.token_type)break;switch(i.token_type){case"TK_TAG_START":i.print_newline(!1,i.output),i.print_token(i.token_text),i.indent(),i.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":i.print_newline(!1,i.output),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===i.last_token&&""===i.last_text){var c=i.token_text.match(/\w+/)[0],u=i.output[i.output.length-1].match(/<\s*(\w+)/);null!==u&&u[1]===c||i.print_newline(!0,i.output)}i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var g=i.token_text.match(/^\s*<([a-z]+)/i);g&&i.Utils.in_array(g[1],d)||i.print_newline(!1,i.output),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_CONTENT":""!==i.token_text&&i.print_token(i.token_text),i.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==i.token_text){i.output.push("\n");var p=i.token_text;if("keep"==t.indent_scripts)var h=0;else if("separate"==t.indent_scripts)var h=-i.indent_level;else var h=1;var m=i.get_full_indent(h),f=p.match(/^\s*/)[0],v=f.match(/[^\n\r]*$/)[0].split(i.indent_string).length-1,b=i.get_full_indent(h-v);p=p.replace(/^\s*/,m).replace(/\r\n|\r|\n/g,"\n"+b).replace(/\s*$/,""),p&&(i.print_token(p),i.print_newline(!0,i.output))}i.current_mode="TAG"}i.last_token=i.token_type,i.last_text=i.token_text}return i.output.join("")}}}(jqxBaseFramework);