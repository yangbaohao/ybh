!function(t){t.jqx.jqxWidget("jqxMaskedInput","",{}),t.extend(t.jqx._jqxMaskedInput.prototype,{defineInstance:function(){var e={value:null,mask:"99999",width:null,height:25,textAlign:"left",readOnly:!1,cookies:!1,promptChar:"_",inputMode:"advanced",rtl:!1,disabled:!1,events:["valueChanged","textchanged","mousedown","mouseup","keydown","keyup","keypress","change"],aria:{"aria-valuenow":{name:"value",type:"string"},"aria-disabled":{name:"disabled",type:"boolean"}}};return t.extend(!0,this,e),e},createInstance:function(t){this.render()},render:function(){var e=this;e.host.attr({role:"textbox"}),e.host.attr("data-role","input");var i=e.host.attr("value");void 0!=i&&""!=i&&(e.value=i),t.jqx.aria(this),t.jqx.aria(this,"aria-multiline",!1),t.jqx.aria(this,"aria-readonly",e.readOnly),e.host.addClass(e.toThemeProperty("jqx-input")),e.host.addClass(e.toThemeProperty("jqx-rc-all")),e.host.addClass(e.toThemeProperty("jqx-widget")),e.host.addClass(e.toThemeProperty("jqx-widget-content")),maskEditor=this,"div"==e.element.nodeName.toLowerCase()?(e.element.innerHTML="",e.maskbox=t("<input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='textarea'/>").appendTo(e.host)):(e.maskbox=e.host,e.maskbox.attr("autocomplete","off"),e.maskbox.attr("autocorrect","off"),e.maskbox.attr("autocapitalize","off"),e.maskbox.attr("spellcheck",!1)),e.maskbox.addClass(e.toThemeProperty("jqx-reset")),e.maskbox.addClass(e.toThemeProperty("jqx-input-content")),e.maskbox.addClass(e.toThemeProperty("jqx-widget-content"));var s=e.host.attr("name");s&&e.maskbox.attr("name",s),e.rtl&&e.maskbox.addClass(e.toThemeProperty("jqx-rtl"));var a=this;e.propertyChangeMap.disabled=function(t,e,i,s){s?t.maskbox.addClass(a.toThemeProperty("jqx-input-disabled")):t.maskbox.removeClass(a.toThemeProperty("jqx-input-disabled"))},e.disabled&&(e.maskbox.addClass(e.toThemeProperty("jqx-input-disabled")),e.maskbox.attr("disabled",!0),e.host.addClass(e.toThemeProperty("jqx-fill-state-disabled"))),e.selectedText="",e.self=this,e.oldValue=e._value(),e.items=new Array,e._initializeLiterals(),e._render(),null!=e.value&&e.inputValue(e.value.toString());var a=this;if(e.host.parents("form").length>0&&e.host.parents("form").on("reset",function(){setTimeout(function(){a.clearValue()},10)}),e.addHandlers(),e.cookies){var r=t.jqx.cookie.cookie("maskedInput."+e.element.id);r&&e.val(r)}},addHandlers:function(){var e=this;t.jqx.mobile.isTouchDevice();var i="",s=function(t,e){var i=String.fromCharCode(e),s=parseInt(i),a=!0;if(!isNaN(s)){a=!0;this.maskbox.val().toString().length>=this.items.length&&0==this._selection().length&&(a=!1)}return t.ctrlKey||t.shiftKey||t.metaKey||e>=65&&e<=90&&(a=!1),a};this.addHandler(this.maskbox,"blur",function(s){if("simple"==e.inputMode)return e._exitSimpleInputMode(s,e,!1,i),!1;e.rtl&&e.maskbox.css("direction","ltr"),e.host.removeClass(e.toThemeProperty("jqx-fill-state-focus")),e.maskbox.val()!=i&&(e._raiseEvent(7,{type:"keyboard"}),e.cookies&&t.jqx.cookie.cookie("maskedInput."+e.element.id,e.maskbox.val()))}),this.addHandler(this.maskbox,"focus",function(s){if(i=e.maskbox.val(),"simple"==e.inputMode)return e.maskbox[0].value=e._getEditValue(),t.data(e.maskbox,"simpleInputMode",!0),!1;e.rtl&&e.maskbox.css("direction","rtl"),e.host.addClass(e.toThemeProperty("jqx-fill-state-focus"))}),this.addHandler(this.host,"keydown",function(t){var i=e.readOnly,a=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(i||e.disabled)return!1;if("simple"!=e.inputMode){var r=e._handleKeyDown(t,a);return r||(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()),r}return s.call(e,t,a)}),this.addHandler(this.host,"keyup",function(t){var i=e.readOnly,a=t.charCode?t.charCode:t.keyCode?t.keyCode:0;return!(!i&&!e.disabled)||("simple"==e.inputMode?s.call(e,t,a):(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),!1))}),this.addHandler(this.host,"keypress",function(t){var i=e.readOnly,a=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(i||e.disabled)return!0;if("simple"==e.inputMode)return s.call(e,t,a);var r=e._handleKeyPress(t,a);return r||(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()),r})},focus:function(){try{this.maskbox.focus()}catch(t){}},_exitSimpleInputMode:function(e,i,s,a){if(void 0==i&&(i=e.data),null!=i){if(void 0==s){if(null!=e.target&&null!=i.element&&(void 0!=e.target.id&&e.target.id.toString().length>0&&i.host.find("#"+e.target.id).length>0||e.target==i.element))return;var r=i.host.offset(),n=r.left,h=r.top,o=i.host.width(),l=i.host.height(),d=t(e.target).offset();if(d.left>=n&&d.left<=n+o&&d.top>=h&&d.top<=h+l)return}if(!i.disabled&&!i.readOnly){if(null!=t.data(i.maskbox,"simpleInputMode")){var c=i.maskbox[0].value;return i.val(c),t.data(i.maskbox,"simpleInputMode",null),!1}}}},_getString:function(){for(var t="",e=0;e<this.items.length;e++){var i=this.items[e].character;this.items[e].character==this.promptChar&&this.promptChar!=this.items[e].defaultCharacter?t+=this.items[e].defaultCharacter:t+=i}return t},_initializeLiterals:function(){if(void 0==this.mask||null==this.mask)return void(this.items=new Array);this.mask=this.mask.toString();for(var t=this.mask.length,e=0;e<t;e++){var i=this.mask.substring(e,e+1),s="",a=!1;if("["==i){for(var r=e;r<t;r++){if("]"==this.mask.substring(r,r+1))break}s="("+this.mask.substring(e,r+1)+")",e=r,a=!0}"#"==i?(s="(\\d|[+]|[-])",a=!0):"9"==i||"0"==i?(s="\\d",a=!0):"$"==i?a=!1:"/"==i||":"==i?a=!1:"A"==i||"a"==i?(s="\\w",a=!0):"c"==i||"C"==i?(s=".",a=!0):"L"!=i&&"l"!=i||(s="([a-zA-Z])",a=!0);var n=this,h=function(t,e,i){h.character=t,h.regex=e,h.canEdit=i,h.defaultCharacter=n.promptChar};a?h(this.promptChar,s,a):h(i,s,a),this.items.push(h)}},setRegex:function(t,e,i,s){null!=t&&void 0!=t&&null!=e&&void 0!=e&&t<this.items.length&&(this.items[t].regex=e,null!=i&&void 0!=i&&(this.items[t].canEdit=i),null!=s&&void 0!=s&&(this.items[t].defaultCharacter=s))},_match:function(t,e){return new RegExp(e,"i").test(t)},_raiseEvent:function(e,i){var s=this.events[e],a={};a.owner=this;var r=(i.charCode?i.charCode:i.keyCode&&i.keyCode,!0),n=(this.readOnly,new t.Event(s));return n.owner=this,a.value=this.inputValue(),a.text=this.maskedValue(),7==e&&(a.type=i.type,void 0==a.type&&(a.type=null)),n.args=a,(e<2||e>6)&&(r=this.host.trigger(n)),r},_handleKeyPress:function(t,e){return this._isSpecialKey(e,t)},_insertKey:function(e,i){var s=this._selection(),a=this;if(s.start>=0&&s.start<this.items.length){var r=String.fromCharCode(e);e>=65&&e<=90&&(i.shiftKey||(r=r.toLowerCase()));var n=!1;t.each(this.items,function(t,e){if(!(t<s.start)){var i=a.items[t];if(i.canEdit){if(a._match(r,i.regex)){if(!n&&s.length>0){for(var h=s.start;h<s.end;h++)a.items[h].canEdit&&(a.items[h].character=a.promptChar);var o=a._getString();a.maskedValue(o),n=!0}i.character=r;var o=a._getString();return a.maskedValue(o),s.start<a.items.length&&a._setSelectionStart(t+1),!1}return!1}}})}},_deleteSelectedText:function(){var t=this._selection(),e=!1;if(t.start>0||t.length>0){for(i=t.start;i<t.end;i++)i<this.items.length&&this.items[i].canEdit&&this.items[i].character!=this.promptChar&&(this.items[i].character=this.promptChar,e=!0);var s=this._getString();return this.maskedValue(s),e}},_saveSelectedText:function(){var e=this._selection(),s="";if(e.start>0||e.length>0)for(i=e.start;i<e.end;i++)this.items[i].canEdit&&(s+=this.items[i].character);if(window.clipboardData)window.clipboardData.setData("Text",s);else{var a=t('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');a.val(s),t("body").append(a),a.select(),setTimeout(function(){document.designMode="off",a.select(),a.remove()},100)}return s},_pasteSelectedText:function(){var e=this._selection(),s=0,a=e.start,r="",n=this,h=function(t){if(!(t!=n.selectedText&&t.length>0&&(n.selectedText=t,null==n.selectedText||void 0==n.selectedText))){if(e.start>=0||e.length>0)for(i=e.start;i<n.items.length;i++)n.items[i].canEdit&&s<n.selectedText.length&&(n.items[i].character=n.selectedText[s],s++,a=1+i);var r=n._getString();n.maskedValue(r),a<n.items.length?n._setSelectionStart(a):n._setSelectionStart(n.items.length)}};if(window.clipboardData)r=window.clipboardData.getData("Text"),h(r);else{var o=t('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');t("body").append(o),o.select();setTimeout(function(){var t=o.val();h(t),o.remove()},100)}},_handleKeyDown:function(e,i){var s=this._selection();i>=96&&i<=105&&(i-=48);var a=e.ctrlKey||e.metaKey;if(a&&97==i||a&&65==i)return!0;if(a&&120==i||a&&88==i)return this.selectedText=this._saveSelectedText(e),this._deleteSelectedText(e),!t.jqx.browser.msie;if(a&&99==i||a&&67==i)return this.selectedText=this._saveSelectedText(e),!t.jqx.browser.msie;if(a&&122==i||a&&90==i)return!1;if(a&&118==i||a&&86==i||e.shiftKey&&45==i)return this._pasteSelectedText(),!t.jqx.browser.msie;if(s.start>=0&&s.start<this.items.length){String.fromCharCode(i),this.items[s.start]}if(8==i){if(0==s.length)for(h=this.items.length-1;h>=0;h--)if(this.items[h].canEdit&&h<s.end&&this.items[h].character!=this.promptChar){this._setSelection(h,h+1);break}s=this._selection();var r=this._deleteSelectedText();return(s.start>0||s.length>0)&&s.start<=this.items.length&&(r?this._setSelectionStart(s.start):this._setSelectionStart(s.start-1)),!1}if(190==i)for(var n=s.start,h=n;h<this.items.length;h++)if("."==this.items[h].character){this._setSelectionStart(h+1);break}if(191==i)for(var n=s.start,h=n;h<this.items.length;h++)if("/"==this.items[h].character){this._setSelectionStart(h+1);break}if(189==i)for(var n=s.start,h=n;h<this.items.length;h++)if("-"==this.items[h].character){this._setSelectionStart(h+1);break}if(46==i){if(0==s.length)for(var h=0;h<this.items.length;h++)if(this.items[h].canEdit&&h>=s.start&&this.items[h].character!=this.promptChar){this._setSelection(h,h+1);break}var o=s;s=this._selection();this._deleteSelectedText();return(s.start>=0||s.length>=0)&&s.start<this.items.length&&(s.length<=1?o.end!=s.end?this._setSelectionStart(s.end):this._setSelectionStart(s.end+1):this._setSelectionStart(s.start)),!1}return this._insertKey(i,e),this._isSpecialKey(i,e)},_isSpecialKey:function(t,e){return 189==t||9==t||13==t||35==t||36==t||37==t||39==t||46==t||!!(16===t&&e.shiftKey||e.ctrlKey||e.metaKey)},_selection:function(){if("selectionStart"in this.maskbox[0]){var t=this.maskbox[0],e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value}}var i=document.selection.createRange();if(null==i)return{start:0,end:t.value.length,length:0};var s=this.maskbox[0].createTextRange(),a=s.duplicate();s.moveToBookmark(i.getBookmark()),a.setEndPoint("EndToStart",s);var e=i.text.length;return{start:a.text.length,end:a.text.length+i.text.length,length:e,text:i.text}},_setSelection:function(t,e){if("selectionStart"in this.maskbox[0])this.maskbox[0].focus(),this.maskbox[0].setSelectionRange(t,e);else{var i=this.maskbox[0].createTextRange();i.collapse(!0),i.moveEnd("character",e),i.moveStart("character",t),i.select()}},_setSelectionStart:function(t){this._setSelection(t,t)},refresh:function(t){t||this._render()},resize:function(t,e){this.width=t,this.height=e,this.refresh()},_render:function(){var e=parseInt(this.host.css("border-left-width")),i=parseInt(this.host.css("border-left-width")),s=parseInt(this.host.css("border-left-width")),a=parseInt(this.host.css("border-left-width")),r=parseInt(this.host.css("height"))-s-a,n=parseInt(this.host.css("width"))-e-i;null!=this.width&&-1!=this.width.toString().indexOf("px")?n=this.width:void 0==this.width||isNaN(this.width)||(n=this.width),null!=this.height&&-1!=this.height.toString().indexOf("px")?r=this.height:void 0==this.height||isNaN(this.height)||(r=this.height),n=parseInt(n),r=parseInt(r),this.maskbox[0]!=this.element&&this.maskbox.css({"border-left-width":0,"border-right-width":0,"border-bottom-width":0,"border-top-width":0}),this.maskbox.css("text-align",this.textAlign);var h=this.maskbox.css("font-size");isNaN(r)||this.maskbox.css("height",parseInt(h)+4+"px"),isNaN(n)||this.maskbox.css("width",n-2);var o=parseInt(r)-2*parseInt(s)-2*parseInt(a)-parseInt(h);if(isNaN(o)&&(o=0),isNaN(r)||this.host.height(r),isNaN(n)||this.host.width(n),this.maskbox[0]!=this.element){var l=o/2;t.jqx.browser.msie&&t.jqx.browser.version<8&&(l=o/4),this.maskbox.css("padding-right","0px"),this.maskbox.css("padding-left","0px"),this.maskbox.css("padding-top",l),this.maskbox.css("padding-bottom",o/2)}this.maskbox[0].value=this._getString(),this.width&&(this.width.toString().indexOf("%")>=0&&(this.element.style.width=this.width),this.height.toString().indexOf("%")>=0&&(this.element.style.height=this.height))},destroy:function(){this.host.remove()},maskedValue:function(t){return void 0===t?this._value():(this.value=t,this._refreshValue(),this.oldValue!==t&&(this._raiseEvent(1,t),this.oldValue=t,this._raiseEvent(0,t)),this)},_value:function(){return this.maskbox.val()},propertyChangedHandler:function(e,s,a,r){if(void 0!=this.isInitialized&&0!=this.isInitialized){if("rtl"==s&&(e.rtl?e.maskbox.addClass(e.toThemeProperty("jqx-rtl")):e.maskbox.removeClass(e.toThemeProperty("jqx-rtl"))),"value"===s&&(void 0!=r&&null!=r||(r=""),""===r?this.clear():(r=r.toString(),this.inputValue(r)),e._raiseEvent(7,r)),"theme"===s&&t.jqx.utilities.setTheme(a,r,this.host),"disabled"==s&&(r?(e.maskbox.addClass(e.toThemeProperty("jqx-input-disabled")),e.host.addClass(e.toThemeProperty("jqx-fill-state-disabled")),e.maskbox.attr("disabled",!0)):(e.host.removeClass(this.toThemeProperty("jqx-fill-state-disabled")),e.host.removeClass(this.toThemeProperty("jqx-input-disabled")),e.maskbox.attr("disabled",!1)),t.jqx.aria(e,"aria-disabled",r)),"readOnly"==s&&(this.readOnly=r),"promptChar"==s){for(i=0;i<e.items.length;i++)e.items[i].character==e.promptChar&&(e.items[i].character=r,e.items[i].defaultCharacter=r);e.promptChar=r}"textAlign"==s&&(e.maskbox.css("text-align",r),e.textAlign=r),"mask"==s&&(e.mask=r,e.items=new Array,e._initializeLiterals(),e.value=e._getString(),e._refreshValue()),"width"==s?(e.width=r,e._render()):"height"==s&&(e.height=r,e._render())}},_value:function(){return this.value},_getEditStringLength:function(){var t="";for(i=0;i<this.items.length;i++)this.items[i].canEdit&&(t+=this.items[i].character);return t.length},_getEditValue:function(){var t="";for(i=0;i<this.items.length;i++)this.items[i].canEdit&&this.items[i].character!=this.promptChar&&(t+=this.items[i].character);return t},parseValue:function(t){if(void 0==t||null==t)return null;var e=t.toString(),s="",a=0;for(m=0;m<e.length;m++){var r=e.substring(m,m+1);for(i=a;i<this.items.length;i++)if(this.items[i].canEdit&&this._match(r,this.items[i].regex)){s+=r,a=i;break}}return s},clear:function(){this.clearValue()},clearValue:function(){this.inputValue("",!0)},val:function(t){return void 0!=t&&"object"!=typeof t&&("number"==typeof t&&isFinite(t)&&(t=t.toString()),this.maskedValue(t)),this.maskbox[0].value},inputValue:function(t,e){if(void 0==t||null==t){for(var i="",s=0;s<this.items.length;s++)this.items[s].canEdit&&(i+=this.items[s].character);return i}var a=0;t=t.toString();for(var s=0;s<this.items.length;s++)this.items[s].canEdit&&(this._match(t.substring(a,a+1),this.items[s].regex)?(this.items[s].character=t.substring(a,a+1),a++):e&&(this.items[s].character=this.promptChar,a++));var r=this._getString();return this.maskedValue(r),this.inputValue()},_refreshValue:function(){for(var e=this.maskedValue(),i=0,s=0;s<this.items.length;s++)e.length>i&&(this.items[s].canEdit&&this.items[s].character!=e[i]&&(!this._match(e[i],this.items[s].regex)&&e[i]!=this.promptChar||1!=e[i].length||(this.items[s].character=e[i])),i++);this.value=this._getString(),e=this.value,this.maskbox[0].value=e,t.jqx.aria(this,"aria-valuenow",e)}})}(jqxBaseFramework);