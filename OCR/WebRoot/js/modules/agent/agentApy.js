var ApyMgt=function(){var e=this,t=_global_settings.service.url+"/salesagent";this.debug=!1,this.initInput=function(){e.initUserPage(),e.initSearch(),e.initGrid(e.searchObj)},this.initUserPage=function(){$("#agentApy-show").css("display","");for(var e=ComboBoxSources.getRecords("salesAgent"),t=["全部"],n=0;n<e.length;n++)t.push(e[n].agentName);$("#agentApy-name").comboBox({theme:currentTheme,source:t,searchMode:"contains",height:34,width:"100%",selectedIndex:0}),$("#agentApy-type").jqxDropDownList({source:{all:"全部",enterprise:"企业",person:"个人"},theme:"energyblue",width:"100%",height:"34px",selectedIndex:0,dropDownHeight:150}),$("#agentApy-show").addClass("hiddendiv")},this.getSalesAgent=function(e){for(var t=ComboBoxSources.getRecords("salesInfo"),n=0;n<t.length;n++)if(t[n].id==e)return t[n];if(!e)return""},this.initGrid=function(){e.settings.source.data=e.searchObj;var t=Core.AcDataAdapter("agentApyGrid",e.settings.source,{beforeLoadComplete:function(e){}},e.debug),n={source:t,rendergridrows:function(){return t.recordids},columns:[{text:"日期",width:"25%",cellsrenderer:function(e,t,n,i,a,r){return'<div style="padding-top:6px">'+r.userInfo.createDate.substring(0,10)+"</div>"}},{text:"类型",width:"25%",cellsrenderer:function(e,t,n,i,a,r){var s='<div style="padding-top:6px">';return(s+="enterprise"==r.type?"企业":"个人")+"</div>"}},{text:"用户名",dataField:"agentName",width:"25%"},{text:"销售负责人(姓名/用户名)",width:"25%",cellsrenderer:function(t,n,i,a,r,s){var d='<div style="padding-top:6px">';return(d+=void 0==s.sales?"":void 0==e.getSalesAgent(s.sales.id)?"":e.getSalesAgent(s.sales.id).userInfo.name+"("+e.getSalesAgent(s.sales.id).username+")")+"</div>"}}],pagesize:20,columnsheight:45};$("#agentApyGrid").grid(n)},this.settings={source:{url:t+"/page",data:e.searchObj},grid:{element:"agentApyGrid"},ajax:{url:t}},this.searchObj={},this.initSearch=function(){e.searchObj={agentName:{value:[],action:"like"},type:{value:[],action:"eq"}}},this.searchDataInfo=function(){$("#agentApyGrid").jqxGrid("applyfilters"),$("#agentApyGrid").jqxGrid("refreshfilterrow"),$("#agentApyGrid").jqxGrid("clearselection")},this.refreshDataInfo=function(){$("#agentApyGrid").jqxGrid("updatebounddata","cells"),$("#agentApyGrid").jqxGrid("clearselection"),$("#agentApyGrid").jqxGrid("refreshdata")}},ApyBindModle=function(e){var t=this;this.search=function(){var t=$("#agentApy-name").find("input").val(),n=$("#agentApy-type").val();e.searchObj.agentName.value=[],"全部"!=t&&e.searchObj.agentName.value.push(t),e.searchObj.type.value=[],"all"!=n&&e.searchObj.type.value.push(n),e.searchDataInfo()},this.bind=function(){$("#agentApy-search").on("click",function(){$("#agentApy-show").is(":hidden")?$("#agentApy-show").slideDown("slow"):t.search()}),hiddenAclick()},this.unbindAll=function(){$("#agentApy-search").off("click")}};