var AdyMgt=function(){var e=this,a=_global_settings.service.url+"/common";this.debug=!1,this.initInput=function(){e.initUserPage(),e.initSearch(),e.initGrid(e.searchObj)},this.initUserPage=function(){$("#agentDaily-show").css("display","");for(var e=ComboBoxSources.getRecords("salesAgent"),a=["全部"],t=0;t<e.length;t++)a.push(e[t].userName);$("#agentDaily-date").jqxDropDownList({source:["请选择","最近一周","最近两周","最近三周","本月","本季度","本年"],theme:"energyblue",width:"100%",height:"34px",selectedIndex:0,dropDownHeight:150}),$("#agentDaily-number").jqxDropDownList({source:{registerNum:"注册人数",aregisterNum:"有效注册人数",visitNum:"访问人数"},width:"100%",height:"34px",selectedIndex:0}),$("#agentDaily-sDate").datetimeinput({formatString:"yyyy-MM-dd",width:"100%",height:"34px"}),$("#agentDaily-eDate").datetimeinput({formatString:"yyyy-MM-dd",width:"100%",height:"34px"}),$("#agentDaily-date").on("change",function(){var e=$("#agentDaily-date").attr("id"),a=$("#agentDaily-sDate").attr("id"),t=$("#agentDaily-eDate").attr("id");setValueById(e,a,t)}),$("#agentDaily-show").addClass("hiddendiv")},this.initGrid=function(){e.settings.source.data=e.searchObj;var a=Core.AcDataAdapter("agentDailyGrid",e.settings.source,{beforeLoadComplete:function(e){}},e.debug),t={source:a,rendergridrows:function(){return a.recordids},columns:[{text:"日期",width:"25%",cellsrenderer:function(e,a,t,i,r,n){return'<div style="padding-top:6px">'+n.createDate+"</div>"}},{text:"注册人数",dataField:"ownerNum",width:"25%",cellsrenderer:function(e,a,t,i,r,n){var d='<div style="padding-top:6px; padding-left:6px;">';return(d+='<a class="hoverspan regUser">'+n.ownerNum+"</a>")+"</div>"}},{text:"有效注册人数",dataField:"realOwnerNum",width:"25%",cellsrenderer:function(e,a,t,i,r,n){var d='<div style="padding-top:6px; padding-left:6px;">';return(d+='<a class="hoverspan validUser">'+n.realOwnerNum+"</a>")+"</div>"}},{text:"访问人数",dataField:"accessNum",width:"25%",cellsrenderer:function(e,a,t,i,r,n){var d='<div style="padding-top:6px; padding-left:6px;">';return(d+='<a class="hoverspan visitUser">'+n.accessNum+"</a>")+"</div>"}}],pagesize:e.settings.grid.pagesize,columnsheight:45};$("#agentDailyGrid").grid(t),$("#agentDailyGrid").on("click",".regUser",function(){var e=$("#agentDailyGrid").jqxGrid("getselectedrowindex");if(e>=0){var a=$("#agentDailyGrid").jqxGrid("getrowdata",e);$.addTab({title:"注册人数",isFrame:!1,url:"page/modules/daily/regUser.html",pk:{createDate:a.createDate},reload:!0})}}),$("#agentDailyGrid").on("click",".validUser",function(){var e=$("#agentDailyGrid").jqxGrid("getselectedrowindex");if(e>=0){var a=$("#agentDailyGrid").jqxGrid("getrowdata",e);$.addTab({title:"有效注册人数",isFrame:!1,url:"page/modules/daily/validUser.html",pk:{createDate:a.createDate},reload:!0})}}),$("#agentDailyGrid").on("click",".visitUser",function(){var e=$("#agentDailyGrid").jqxGrid("getselectedrowindex");if(e>=0){var a=$("#agentDailyGrid").jqxGrid("getrowdata",e);$.addTab({title:"访问人数",isFrame:!1,url:"page/modules/daily/visitUser.html",pk:{createDate:a.createDate},reload:!0})}})},this.settings={source:{url:a+"/owner/count/"+_global_settings.owner.roleName,data:e.searchObj},grid:{element:"agentDailyGrid"},ajax:{url:a}},this.searchObj={},this.initSearch=function(){e.sarchObj={createDate:{value:[],action:"between"},ownerNum:{value:[],action:"between"},realOwnerNum:{value:[],action:"between"},accessNum:{value:[],action:"between"}}},this.searchDataInfo=function(){$("#agentDailyGrid").jqxGrid("applyfilters"),$("#agentDailyGrid").jqxGrid("refreshfilterrow"),$("#agentDailyGrid").jqxGrid("clearselection")},this.refreshDataInfo=function(){$("#agentDailyGrid").jqxGrid("updatebounddata","cells"),$("#agentDailyGrid").jqxGrid("clearselection"),$("#agentDailyGrid").jqxGrid("refreshdata")}},AdyBindModle=function(e){var a=this;this.search=function(){var a=$("#agentDaily-number").val(),t=$("#agentDaily-sNumber").val(),i=$("#agentDaily-eNumber").val(),r=$("#agentDaily-sDate").val(),n=$("#agentDaily-eDate").val();e.searchObj.createDate=[],""!==r&&""!==n&&(e.searchObj.createDate={value:[r+" 00:00:00",n+" 23:59:59"],action:"between"}),""!==r&&""===n&&(e.searchObj.createDate={value:[r+" 00:00:00"],action:"ge"}),""===r&&""!==n&&(e.searchObj.createDate={value:[n+" 23:59:59"],action:"le"}),e.searchObj.ownerNum=[],"registerNum"==a&&""!=t&&""!=i&&(e.searchObj.ownerNum={value:[t,i],action:"between"}),e.searchObj.realOwnerNum=[],"aregisterNum"==a&&""!=t&&""!=i&&(e.searchObj.realOwnerNum={value:[t,i],action:"between"}),e.searchObj.accessNum=[],"visitNum"==a&&""!=t&&""!=i&&(e.searchObj.accessNum={value:[t,i],action:"between"}),e.searchDataInfo()},this.bind=function(){$("#agentDaily-search").on("click",function(){$("#agentDaily-show").is(":hidden")?$("#agentDaily-show").slideDown("slow"):a.search()}),hiddenAclick()},this.unbindAll=function(){$("#agentDaily-search").off("click")}};