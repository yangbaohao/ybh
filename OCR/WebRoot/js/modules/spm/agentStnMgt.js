var AgentStnMgt=function(){var e=this,t=_global_settings.service.url+"/user";this.indexs=[],this.debug=!1,this.username=null,this.initInput=function(){e.username=$.pk.username,void 0==e.username&&(Core.alert({message:"username入参错误！"}),$.closeTab()),e.initSearch(),e.initGrid(e.searchObj)},this.initGrid=function(){e.settings.source.data=e.searchObj;var t=Core.AcDataAdapter("agentStnGrid",e.settings.source,{beforeLoadComplete:function(e){}},e.debug),n={source:t,rendergridrows:function(e){return t.recordids},columns:[{text:"用户名",dataField:"loginId",width:"24.3%"},{text:"公司名",dataField:"name",width:"24.3%"},{text:"账期",dataField:"mouthDate",width:"24.4%"},{text:"购买模块",dataField:"productName",width:"24.4%"}],selectionmode:"checkbox",pagesize:20,columnsheight:45,ready:function(){}};$("#agentStnGrid").grid(n),$("#agentStnGrid").on("rowselect",function(){var t=$("#agentStnGrid").jqxGrid("getselectedrowindexes");e.indexs=[],$.each(t,function(n,i){void 0!=$("#agentStnGrid").jqxGrid("getrowdata",t[n])&&void 0!=t[n]&&e.indexs.push(t[n])})}),$("#agentStnGrid").on("rowunselect",function(){var t=$("#agentStnGrid").jqxGrid("getselectedrowindexes");e.indexs=[],$.each(t,function(n,i){void 0!=$("#agentStnGrid").jqxGrid("getrowdata",t[n])&&void 0!=t[n]&&e.indexs.push(t[n])})})},this.settings={source:{url:t+"/searchusertax/isnull",data:e.searchObj},grid:{element:"agentStnGrid"},ajax:{url:t}},this.searchObj={},this.initSearch=function(){e.searchObj={}}},AgentStnBindModle=function(e){var t=_global_settings.service.url+"/common";this.bind=function(){$("#agentStn-save").on("click",function(){var n=[];if(0==e.indexs.length)return Core.alert({message:"请选择客户！"}),!1;$.each(e.indexs,function(t){var i={},a=$("#agentStnGrid").jqxGrid("getrowdata",e.indexs[t]);i.id=a.id,i.loginId=a.loginId,i.name=a.name,void 0!=a.date&&(i.date=a.date),i.productName=a.productName,n.push(i)}),Core.AjaxRequest({type:"POST",url:t+"/owner/tax/update/"+e.username,async:!1,params:n,showMsg:!1,callback:function(e){setCloseAlertTimeOneSecond();try{$("#agentDecGrid").jqxGrid("updatebounddata","cells"),$.closeTab()}catch(e){}},failure:function(){}})}),$("#agentStn-cancle").on("click",function(){$.closeTab()})},this.unbindAll=function(){$("#agentStn-save").off("click"),$("#agentStn-cancle").off("click")}};