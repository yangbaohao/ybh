var DecGoodsMgt=function(){var e=this,t=_global_settings.service.url+"/common";this.debug=!1,this.initInput=function(){$("#decGoods-company").text(currentUserInfo.name),$("#decGoods-tax").text("："+getCodeData(currentUserInfo.taxType)),$("#decGoods-taxCode").text(currentUserInfo.owerTaxCode),e.initSearch(),e.initGrid(e.searchObj)};var r=function(e){var t=ComboBoxSources.getRecords("taxerInfo");for(i=0;i<t.length;i++)if(e==t[i].username)return t[i];if(!e)return""};this.initGrid=function(){var o=Core.AcDataAdapter("decGoodsMgtGrid",e.settings.source,{beforeLoadComplete:function(e){}},e.debug),d={source:o,rendergridrows:function(e){return o.recordids},columns:[{text:"日期",dataField:"mouthDate",width:"20%"},{text:"报税人",dataField:"username",width:"20%",cellsrenderer:function(e,t,o,d,i,a){var n="";return"AdminAccount"==a.taxer?n+="<div>代理报税</div>":void 0!=r(a.username)?r(a.username).username==a.username&&(n+="<div>"+r(a.username).name+"</div>"):n+="<div>"+a.username+"</div>",'<div style="height: auto;position:absolute;top:44%;">'+n+"</div>"}},{text:"增值税率(%)",dataField:"vat",width:"20%"},{text:"状态",dataField:"taxStatus",width:"20%"},{text:"操作",width:"20%",cellsrenderer:function(e,t,r,o,d,i){var a='<div style="text-align:center">';return(a+='<a class="hoverspan md-label decGoodsMgtBtn" title="报税"></a>')+"</div>"}}],pagesize:20,columnsheight:45};$("#decGoodsMgtGrid").grid(d),$("#decGoodsMgtGrid").on("click",".decGoodsMgtBtn",function(){var e=$("#decGoodsMgtGrid").jqxGrid("getselectedrowindex");if(e>=0){var r=$("#decGoodsMgtGrid").jqxGrid("getrowdata",e);if(r.taxwithStatus)return Core.alert({message:currentUserInfo.name+","+r.mouthDate+"已报税！"}),!1;var o={};o.mouthDate=r.mouthDate,o.ownerId=r.ownerId,o.productName=r.productName,o.taxStatus=r.taxStatus,o.vat=r.vat,Core.confirm({message:currentUserInfo.name+","+r.mouthDate+"是否已成功报税？",confirmCallback:function(){Core.AjaxRequest({type:"POST",url:t+"/tax/save",async:!1,params:o,showMsg:!1,callback:function(){setCloseAlertTimeOneSecond(),$("#decGoodsMgtGrid").jqxGrid("updatebounddata","cells")},failure:function(e){Core.alert({message:e.responseJSON.errorMsg,callback:function(){}})}})},cancelCallback:function(){}})}})},this.settings={source:{url:t+"/tax/search/"+currentUserInfo.id+"/"+currentUserInfo.loginId,data:e.searchObj},grid:{element:"decGoodsMgtGrid"},ajax:{url:t}},this.searchObj={},this.initSearch=function(){e.searchObj={}},this.searchDataInfo=function(){$("#decGoodsMgtGrid").jqxGrid("applyfilters"),$("#decGoodsMgtGrid").jqxGrid("refreshfilterrow"),$("#decGoodsMgtGrid").jqxGrid("clearselection")},this.refreshDataInfo=function(){$("#decGoodsMgtGrid").jqxGrid("updatebounddata","cells"),$("#decGoodsMgtGrid").jqxGrid("clearselection"),$("#decGoodsMgtGrid").jqxGrid("refreshdata")}},DecGoodsBindModle=function(e){this.bind=function(){},this.unbindAll=function(){}};