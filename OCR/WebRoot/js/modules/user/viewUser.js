var VuMgt=function(){var e=this,t=_global_settings.service.url+"/accountorder";this.id=$.pk.id,this.username=$.pk.username,this.name=$.pk.name,this.initInput=function(){e.initPage(),e.initGrid()},this.searchObj={sortdatafield:"ex.createDate","ex.loginId":{value:[""+e.username],action:"eq"}},this.searchObj1={},this.initPage=function(){Core.AjaxRequest({url:_global_settings.service.url+"/owner/ov/"+e.id,type:"GET",async:!1,showMsg:!1,callback:function(t){e.initRes(t)},failure:function(){}})},this.initRes=function(t){$("#viewuser-name").text(e.username),$("#viewuser-company").text(e.name),void 0==t.mouthAmt||""==t.mouthAmt?$("#viewsuer-monthamt").text("￥0"):$("#viewsuer-monthamt").text("￥"+t.mouthAmt),void 0==t.mouthProductName?$("#viewuser-monthmodule").text(""):$("#viewuser-monthmodule").text(t.mouthProductName),void 0==t.totalAmt||""==t.totalAmt?$("#viewuser-totalamt").text("￥0"):$("#viewuser-totalamt").text("￥"+t.totalAmt),void 0==t.totalProductName?$("#viewuser-totalmodule").text(""):$("#viewuser-totalmodule").text(t.totalProductName),void 0==t.taxUser?$("#viewuser-tax").text(""):$("#viewuser-tax").text(t.taxUser),void 0==t.taxStatus?$("#viewuser-status").text(""):$("#viewuser-status").text(t.taxStatus)},this.initGrid=function(){var t=Core.AcDataAdapter("viewUserHaveBuy",e.settings.source,{beforeLoadComplete:function(e){}},!1);e.setting1.source.data=e.searchObjs,e.setting1.source.url=_global_settings.service.url+"/user/search/userAccess/"+e.id+"/0/"+_global_settings.owner.roleName;var i=Core.AcDataAdapter("viewUserHaveVisit",e.setting1.source,{beforeLoadComplete:function(e){}},!1),r={source:t,rendergridrows:function(){return t.recordids},columns:[{text:"订单号",width:"20%",cellsrenderer:function(e,t,i,r,s,a){var o='<div class="agrid">';return(o+='<a class="hoverspan viewUserOrder">'+a.orderCode+"</a>")+"</div>"}},{text:"订单模块",dataField:"productName",width:"20%"},{text:"总金额",dataField:"totalAmt",cellsformat:"c2",width:"15%"},{text:"订单时间",width:"15%",cellsrenderer:function(e,t,i,r,s,a){return'<div class="agrid">'+a.orderCreateDate.substring(0,10)+"</div>"}},{text:"到期时间",width:"15%",cellsrenderer:function(e,t,i,r,s,a){return'<div class="agrid">'+a.orderEndDate.substring(0,10)+"</div>"}},{text:"状态",width:"15%",cellsrenderer:function(e,t,i,r,s,a){return'<div class="agrid">'+getCodeData(a.payStatus)+"</div>"}}],pagesize:20,columnsheight:45};$("#viewUserHaveBuy").grid(r);var s={source:i,columnsresize:!1,autorowheight:!0,autoheight:!0,columnsheight:45,pageable:!1,rendergridrows:function(){return i.records},columns:[{text:"访问时间",dataField:"createDate",width:"25%",cellsrenderer:function(e,t,i,r,s,a){return'<div class="JournalDiv" style="position: relative; top:50%; margin-top:-6px; text-align: center;text-overflow: ellipsis;overflow: hidden;">'+a.createDate+"</div>"}},{text:"访问模块",dataField:"remark",width:"25%",cellsrenderer:function(e,t,i,r,s,a){if(void 0!==a.accessList){for(var o="",n="",d=0;d<a.accessList.length;d++)n=a.accessList[d].remark,o+='<div class="JournalDiv" style="position: relative; border-top: 1px solid  #EBEFF2;text-overflow: ellipsis;overflow: hidden;" title='+n+">"+n+"</div>";return'<div style="height:auto;">'+o+"</div>"}}},{text:"访问次数",width:"25%",cellsrenderer:function(e,t,i,r,s,a){if(void 0!==a.accessList){for(var o="",n="",d=0;d<a.accessList.length;d++)n=a.accessList[d].remarkNum,o+='<div class="JournalDiv" style="position: relative; border-top: 1px solid  #EBEFF2;text-overflow: ellipsis;overflow: hidden;" title='+n+">"+n+"</div>";return'<div style="height:auto;">'+o+"</div>"}}},{text:"停留时间(分)",width:"25%",cellsrenderer:function(e,t,i,r,s,a){if(void 0!==a.accessList){for(var o="",n="",d=0;d<a.accessList.length;d++)n=a.accessList[d].remarkSecond,o+='<div class="JournalDiv" style="position: relative; border-top: 1px solid  #EBEFF2;text-overflow: ellipsis;overflow: hidden;" title='+n+">"+n+"</div>";return'<div style="height:auto;">'+o+"</div>"}}}]};$("#viewUserHaveVisit").grid(s),$("#viewUserHaveBuy").on("click",".viewUserOrder",function(){var t=$("#viewUserHaveBuy").jqxGrid("getselectedrowindex");if(t>=0){var i=$("#viewUserHaveBuy").jqxGrid("getrowdata",t),r={condition:[],filterscount:0,groupscount:0,pagenum:0,pagesize:100};r.condition.push({value:[i.id.toString()],action:"eq",key:"accountOrder.id"});var s=(new Base64).encode(JSON.stringify(r));Core.AjaxRequest({url:_global_settings.service.url+"/accountOrderPay/page/"+s,type:"GET",callback:function(t){var i=t.rows[0];$.addTab({title:"订单详情",url:"page/modules/prod/viewOrder.html",pk:{data:i.accountOrder,amount:i.totalAmt,orderCode:i.accountOrder.orderCode,vouchers:i.vouchers,name:e.name},reload:!0})},failure:function(e){}})}}),$(".viewMoreVist").on("click",function(){$.addTab({title:"浏览历史人数",isFrame:!1,url:"page/modules/user/viewUserMoreVisit.html",pk:{id:e.id,username:e.username,name:e.name},reload:!0})})},this.settings={source:{url:t+"/page",data:e.searchObj},grid:{element:"viewUserHaveBuy"},ajax:{url:t}},this.setting1={source:{data:e.searchObj1},grid:{element:"viewUserHaveVisit"},ajax:{url:t}}},VuBindModle=function(e){this.bind=function(){},this.unbindAll=function(){}};