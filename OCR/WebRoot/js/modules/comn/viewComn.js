var ViewcMgt=function(){var e=this,i=_global_settings.service.url+"/agentrevenue";this.debug=!1,this.initInput=function(){e.initPage(),e.initGrid(e.searchObj)},this.searchObj={"o.loginId":{value:[],action:"like"},"f.name":{value:[],action:"like"},"o.regTelephone":{value:[],action:"like"},"biz.createDate":{value:[],action:"between"},"s.productName":{value:[],action:"like"},neFee:{value:[],action:"between"},edFee:{value:[],action:"between"},unFee:{value:[],action:"between"}},this.initPage=function(){$("#viewc-show").css("display",""),$("#viewc-agentName").text($.pk.name),$("#viewc-time").dropDownlist({source:["请选择","最近一周","最近两周","最近三周","本月","本季度","本年"],theme:"energyblue",width:"100%",height:"34px",selectedIndex:0,dropDownHeight:150}),$("#viewc-sTime").datetimeinput({formatString:"yyyy-MM-dd",width:"100%",height:"34px"}),$("#viewc-eTime").datetimeinput({formatString:"yyyy-MM-dd",width:"100%",height:"34px"}),$("#viewc-time").on("change",function(){setValueById("viewc-time","viewc-sTime","viewc-eTime")});for(var e=ComboBoxSources.getRecords("productName"),i=["全部"],t=0;t<e.length;t++)i.push(e[t].productName);$("#viewc-module").comboBox({theme:currentTheme,source:i,searchMode:"contains",displayMember:"productName",height:34,width:"100%",selectedIndex:0}),$("#viewc-status").dropDownlist({source:{neFee:"应提佣金",edFee:"已提佣金",unFee:"未提佣金"},height:34,width:"100%",selectedIndex:0}),$("#viewc-show").addClass("hiddendiv")},this.initGrid=function(){e.settings.source.data=e.searchObj;var i=Core.AcDataAdapter("viewComnGrid",e.settings.source,{beforeLoadComplete:function(e){}},e.debug),t={source:i,rendergridrows:function(){return i.recordids},columns:[{text:"购买日期",width:"10%",cellsrenderer:function(e,i,t,a,n,c){return'<div class="agrid">'+c.createDate.substring(0,10)+"</div>"}},{text:"用户名",dataField:"loginId",width:"11.25%"},{text:"电话号码",dataField:"regTelephone",width:"11.25%"},{text:"公司名称",dataField:"name",width:"11.25%"},{text:"购买金额",dataField:"amount",cellsalign:"left",cellsformat:"c2",width:"11.25%"},{text:"购买模块",dataField:"productName",width:"11.25%"},{text:"应提佣金",dataField:"neFee",cellsalign:"left",cellsformat:"c2",width:"11.25%"},{text:"已提佣金",dataField:"edFee",cellsalign:"left",cellsformat:"c2",width:"11.25%"},{text:"未提佣金",dataField:"unFee",cellsalign:"left",cellsformat:"c2",width:"11.25%"}],pagesize:20,columnsheight:45};$("#viewComnGrid").grid(t)},this.settings={source:{url:i+"/agentrevenuedetails/"+$.pk.agentCode,data:e.searchObj},grid:{element:"viewComnGrid"},ajax:{url:i}},this.searchDataInfo=function(){$("#viewComnGrid").jqxGrid("applyfilters"),$("#viewComnGrid").jqxGrid("refreshfilterrow"),$("#viewComnGrid").jqxGrid("clearselection")},this.refreshDataInfo=function(){$("#viewComnGrid").jqxGrid("updatebounddata","cells"),$("#viewComnGrid").jqxGrid("clearselection"),$("#viewComnGrid").jqxGrid("refreshdata")}},ViewcBindModle=function(e){var i=this;this.search=function(){var i=$("#viewc-username").val(),t=$("#viewc-compName").val(),a=$("#viewc-number").val(),n=$("#viewc-sTime").val(),c=$("#viewc-eTime").val(),r=$("#viewc-module").find("input").val(),s=$("#viewc-status").val(),d=$("#viewc-sAmt").val(),l=$("#viewc-eAmt").val();e.searchObj["o.loginId"].value=[],""!=i&&e.searchObj["o.loginId"].value.push(i),e.searchObj["f.name"].value=[],""!=t&&e.searchObj["f.name"].value.push(t),e.searchObj["o.regTelephone"].value=[],""!=a&&e.searchObj["o.regTelephone"].value.push(a),e.searchObj["biz.createDate"].value=[],""!=n&&""!=c&&e.searchObj["biz.createDate"].value.push(n,c),e.searchObj["s.productName"].value=[],"全部"!=r&&e.searchObj["s.productName"].value.push(r),e.searchObj.neFee.value=[],e.searchObj.edFee.value=[],e.searchObj.unFee.value=[],"neFee"==s&&""!=d&&""!=l&&e.searchObj.neFee.value.push(d,l),"edFee"==s&&""!=d&&""!=l&&e.searchObj.edFee.value.push(d,l),"unFee"==s&&""!=d&&""!=l&&e.searchObj.unFee.value.push(d,l),e.searchDataInfo()},this.bind=function(){$("#viewc-search").on("click",function(){$("#viewc-show").is(":hidden")?$("#viewc-show").slideDown("slow"):i.search()}),hiddenAclick()},this.unbindAll=function(){$("#viewc-search").off("click")}};