var ComnaMgt=function(){var e=this,t=_global_settings.service.url+"/accountorder";this.debug=!1,this.id=null,this.initInput=function(){e.initWindows(),e.initSearch(),e.initGrid(e.searchObj)},this.initWindows=function(){$("#comnApySpWin").jqxWindow({theme:currentTheme,isModal:!0,autoOpen:!1,maxHeight:1e3,minHeight:360,height:"auto",minWidth:700,cancelButton:$("#comnApySpBackBtn"),initContent:function(){$("#comnApySp").jqxDropDownList({source:{paid:"同意",notpaid:"拒绝"},height:34,width:"25%",selectedIndex:0})}}).on({open:function(){},close:function(){setTimeout(function(){$("#comnApySp").jqxDropDownList({selectedIndex:0})},500)}})},this.initGrid=function(){e.settings.source.data=e.searchObj;var t=Core.AcDataAdapter("comnApyGrid",e.settings.source,{beforeLoadComplete:function(e){}},e.debug),i={source:t,rendergridrows:function(){return t.recordids},columns:[{text:"日期",width:"10%",cellsrenderer:function(e,t,i,n,r,o){return'<div style="padding-top:6px">'+o.orderCreateDate.substring(0,10)+"</div>"}},{text:"代理商编码",dataField:"agentCode",width:"10%"},{text:"代理商用户名",dataField:"agentName",width:"15%"},{text:"客户名称",dataField:"name",width:"15%"},{text:"购买模块",dataField:"productName",width:"15%"},{text:"购买金额",dataField:"priceAmt",cellsalign:"right",cellsformat:"c2",width:"15%"},{text:"提取佣金",dataField:"revenueAmt",cellsalign:"right",cellsformat:"c2",width:"10%"},{text:"操作",width:"10%",cellsrenderer:function(e,t,i,n,r,o){var a='<div style="padding-top:2px;text-align:center">';return"Sys_Admin"==_global_settings.owner.roleName&&(a+='<a class="hoverspan md-verified-user comnApy-sp" title="审批"></a>'),a+"</div>"}}],pagesize:20,columnsheight:45};$("#comnApyGrid").grid(i),$("#comnApyGrid").on("click",".comnApy-sp",function(){var t=$("#comnApyGrid").jqxGrid("getselectedrowindex"),i=$("#comnApyGrid").jqxGrid("getrowdata",t);e.id=i.id,$("#comnApySpWin").jqxWindow("open")})},this.settings={source:{url:t+"/search/page/01",data:e.searchObj},grid:{element:"userGrid"},ajax:{url:t}},this.searchObj={},this.initSearch=function(){e.searchObj={sortdatafield:"orderCreateDate"},"salesStaff"==_global_settings.owner.roleName&&(e.searchObj["ow.sales_id"]={value:[""+_global_settings.owner.userid],action:"eq"})},this.searchDataInfo=function(){$("#comnApyGrid").jqxGrid("applyfilters"),$("#comnApyGrid").jqxGrid("refreshfilterrow"),$("#comnApyGrid").jqxGrid("clearselection")},this.refreshDataInfo=function(){$("#comnApyGrid").jqxGrid("updatebounddata","cells"),$("#comnApyGrid").jqxGrid("clearselection"),$("#comnApyGrid").jqxGrid("refreshdata")}},ComnaBindModle=function(e){this.bind=function(){$("#comnApySpPassBtn").on("click",function(){Core.AjaxRequest({url:_global_settings.service.url+"/agentrevenue/examine",type:"POST",params:{id:e.id,remark:$("#comnApySpAdvice").val(),payStatus:$("#comnApySp").val()},async:!1,callback:function(){$("#comnApySpWin").jqxWindow("close"),$("#comnApyGrid").jqxGrid("updatebounddata","cells")},failure:function(){}})})},this.unbindAll=function(){$("#comnApySpPassBtn").off("click")}};