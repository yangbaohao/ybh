var ProfitQuarterReportMgt=function(){var t=this,e=_global_settings.service.url+"/ac/";this.random=Math.random(),this.yearAmt=null,this.monthAmt=null,this.date=new Date,this.initInput=function(){$("#profitQuarterReport_nowDate").text(t.setDate()),$("#profitQuarterReport-time").monthpicker({callback:"dasdasd"}),$("#profitQuarterReport-time").val($("#profitQuarterReport-time").val().substring(0,4)),$("#profitQuarterReport_comname").text(currentUserInfo.name),t.getTableData(),t.initPages()},this.initPages=function(){if("中文"==$("#main-changeLanguage").html()){$("#profitQuarterReport-search").html("&nbsp;&nbsp;Search&nbsp;&nbsp;&nbsp;"),$("#profitQuarterReport-print").html("&nbsp;&nbsp;Print&nbsp;&nbsp;&nbsp;"),$("#profitQuarterReport-out").html("&nbsp;&nbsp;Export&nbsp;&nbsp;&nbsp;"),$("#profitQuarter-searchDate").html("Date"),$("#profitQuarter-headMsg").html("Quarterly Statement"),$("#profitQuarterReport-refresh").html("Refresh");$("#profitQuarterReport_nowDate").html(function(){var e=t.date.getFullYear(),r=t.date.getMonth();r+=1;var n=t.date.getDate();return r<10&&(r="0"+r),n<10&&(n="0"+n),n+"/"+r+"/"+e}()),$("#profitQuarterReport_unit").html("Unit：RMB");var e=$("#profitQuarterReportDataTable>thead>tr>th");e.eq(0).html("Items"),e.eq(1).html("Line No:"),e.eq(2).html("Accumulated Amount For The Year"),e.eq(3).html("First Quarter"),e.eq(4).html("Second Quarter"),e.eq(5).html("Third Quarter"),e.eq(6).html("Fourth Quarter")}},this.setDate=function(){var e=t.date.getFullYear(),r=t.date.getMonth();r+=1;var n=t.date.getDate();return r<10&&(r="0"+r),n<10&&(n="0"+n),e+"年"+r+"月"+n+"日"},this.getYear=function(){return t.date.getFullYear()},this.getTableData=function(){Core.AjaxRequest({type:"GET",showWaiting:!1,url:e+(new Base64).encode("tosys/coaReport/quarterAmt/profit/"+t.getYear()+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),callback:function(e){for(var r=0;r<e.length;r++)t.sequence=e[r].sequence,t.itemVale2=e[r].itemVale2,t.itemVale3=e[r].itemVale3,t.itemVale4=e[r].itemVale4,t.itemVale5=e[r].itemVale5,t.itemVale6=e[r].itemVale6,t.addDataToTable(t.sequence,t.itemVale2,t.itemVale3,t.itemVale4,t.itemVale5,t.itemVale6);if(t.setTextStyle(),"中文"==$("#main-changeLanguage").html())for(var n=$("#profitQuarterReportDataTable>tbody>tr"),r=0;r<n.length;r++)n.find("td:first").eq(r).html(e[r].itemEnglishName)}})},this.setTextStyle=function(){$("#profitQuarterReportDataTable tr:gt(0)").each(function(t,e){void 0!=$(this).attr("id")&&$(this).find("td").each(function(t){2!=t&&3!=t&&4!=t&&5!=t&&6!=t||$(this).attr("class","p-r-10 text-right")})})},this.addDataToTable=function(t,e,r,n,a,i){$("#profitQuarterReportDataTable tr:gt(0)").each(function(o,s){$(this).find("td").each(function(o){if(1==o){$(this).text()==t?($(this).next().text(formatNum(e)),$(this).next().next().text(formatNum(r)),$(this).next().next().next().text(formatNum(n)),$(this).next().next().next().next().text(formatNum(a)),$(this).next().next().next().next().next().text(formatNum(i))):""!=$(this).next().text()&&""!=$(this).next().next().text()&&""!=$(this).next().next().next().text()&&""!=$(this).next().next().next().next().text()&&""!=$(this).next().next().next().next().next().text()||($(this).next().text(0),$(this).next().next().text(0),$(this).next().next().next().text(0),$(this).next().next().next().next().text(0),$(this).next().next().next().next().next().text(0))}})})}},ProfitQuarterReportBindModle=function(t){var e=this,r=_global_settings.service.url+"/ac/";this.searchTableData=function(n){Core.AjaxRequest({type:"GET",showWaiting:!1,url:r+(new Base64).encode("tosys/coaReport/quarterAmt/profit/"+n+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),callback:function(r){for(var n=0;n<r.length;n++)e.sequence=r[n].sequence,e.itemVale2=r[n].itemVale2,e.itemVale3=r[n].itemVale3,e.itemVale4=r[n].itemVale4,e.itemVale5=r[n].itemVale5,e.itemVale6=r[n].itemVale6,t.addDataToTable(e.sequence,e.itemVale2,e.itemVale3,e.itemVale4,e.itemVale5,e.itemVale6)}})},this.emptyTable=function(t){$("#profitQuarterReportDataTable tr:gt(0)").each(function(t,e){var r=$(this).attr("id");void 0!=r&&(r=r.substring(0,3)>=100?r.substring(0,2):r.substring(0,1),$(this).find("td").each(function(t){0!=t&&1!=t&&$(this).text("")}))}),e.searchTableData(t)},this.bind=function(){$("#profitQuarterReport-time").on("change",function(){$(this).val($(this).val().substring(0,4))}),$("#profitQuarterReport-search").on("click",function(){var r=$("#profitQuarterReport-time").val();""==r&&(r=t.getYearAndMonth()),$("#profitQuarterReport_nowDate").text(r),e.emptyTable(r)}),$("#profitQuarterReport-out").on({click:function(){var e=$("#profitQuarterReport-time").val();""==e&&(e=t.getYearAndMonth()),"中文"==$("#main-changeLanguage").text()?$.openHref(_global_settings.service.url+"/ac/exportReport/"+(new Base64).encode("tosys/coaReport/export/profitQuarterReportEnglish/"+e+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId)):$.openHref(_global_settings.service.url+"/ac/exportReport/"+(new Base64).encode("tosys/coaReport/export/profitQuarterReport/"+e+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId))}}),$("#profitQuarterReport-refresh").off("click").on("click",function(){$.addTab({title:"利润表季报",isFrame:!1,url:ctx+"/page/modules/equipment/profitQuarterReport.html",pk:{random:Math.random()},reload:!0})})},this.unbindAll=function(){},$("#profitQuarterReport-print").on("click",function(){var t=new Date,e=t.getFullYear();"中文"==$("#main-changeLanguage").html()?window.open(_global_settings.service.url+"/ac/print/"+(new Base64).encode("reportName=ProfitPrintQuarterEN&date="+e+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId)):window.open(_global_settings.service.url+"/ac/print/"+(new Base64).encode("reportName=ProfitPrintQuarter&date="+e+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId))})};