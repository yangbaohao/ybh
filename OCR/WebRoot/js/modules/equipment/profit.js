var ProfitMgt=function(){var t=this,e=_global_settings.service.url+"/ac/";this.date=new Date;var n=null;this.initInput=function(){$("#profit-sendEmail").css("display","none"),$("#profit_nowDate").text(t.setDate()),$("#profit_comname").text(currentUserInfo.name),t.setTime(),t.getTableData(),t.initPages()},$("#profit-time").bind("focus,blur",function(){var t=$("#profit-time").val();$("#profit_nowDate").text(""),$("#profit_nowDate").text(t)}),this.setTime=function(){$("#profit-time").monthpicker({callback:"dasdasd"})},this.initPages=function(){if("中文"==$("#main-changeLanguage").html()){$("#profit-search").html("&nbsp;&nbsp;Search&nbsp;&nbsp;&nbsp;"),$("#profit-print").html("&nbsp;&nbsp;Print&nbsp;&nbsp;&nbsp;"),$("#profit-out").html("&nbsp;&nbsp;Export&nbsp;&nbsp;&nbsp;"),$("#profit-searchDate").html("Date"),$("#profit-headMsg").html("Income Statement");$("#profit_nowDate").html(function(){var e=t.date.getFullYear(),n=t.date.getMonth();n+=1;var a=t.date.getDate();return n<10&&(n="0"+n),a<10&&(a="0"+a),a+"/"+n+"/"+e}()),$("#profit-unit").html("Unit：RMB");var e=$("#profitDataTable>thead>tr>th");e.eq(0).html("Items"),e.eq(1).html("Line No."),e.eq(2).html("Accumulated Amount For The Year"),e.eq(3).html("Accumulated Amount For The Month")}},this.getTableData=function(){return Core.AjaxRequest({type:"GET",showMsg:!1,url:e+(new Base64).encode("tosys/coaReport/monthAmt/profit/"+$("#profit-time").val()+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),callback:function(e){n=e;for(var a,r,i,o=0;o<e.length;o++)a=e[o].sequence,r=e[o].itemVale1,i=e[o].itemVale2,t.setTableData(a,r,i);if(t.setTextStyle(),"中文"==$("#main-changeLanguage").html())for(var s=$("#profitDataTable>tbody>tr"),o=0;o<s.length;o++)s.find("td:first").eq(o).html(e[o].itemEnglishName)}}),n},this.setTextStyle=function(){$("#profitDataTable tr:gt(0)").each(function(){$(this).find("td").each(function(t){1==t&&$(this).attr("class","text-center"),2!=t&&3!=t||$(this).attr("class","p-r-10 text-right")})})},this.setTableData=function(t,e,n){$("#profitDataTable tr:gt(0)").each(function(a,r){$(this).find("td").each(function(a){if(1==a){$(this).text()==t?($(this).next().text(formatNum(n)),$(this).next().next().text(formatNum(e))):""!=$(this).next().text()&&""!=$(this).next().next().text()||($(this).next().text(0),$(this).next().next().text(0))}})})},this.setDate=function(){var e=t.date.getFullYear(),n=t.date.getMonth();n+=1;var a=t.date.getDate();return n<10&&(n="0"+n),a<10&&(a="0"+a),e+"年"+n+"月"+a+"日"},this.getYearAndMonth=function(){var e=t.date.getFullYear(),n=t.date.getMonth();return n+=1,n<10&&(n="0"+n),e+"-"+n}},ProfitBindModle=function(t){var e=this,n=_global_settings.service.url+"/ac/";this.searchTableData=function(e){Core.AjaxRequest({type:"GET",showMsg:!1,url:n+(new Base64).encode("tosys/coaReport/monthAmt/profit/"+e+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),callback:function(e){for(var n,a,r,i=0;i<e.length;i++)n=e[i].sequence,a=e[i].itemVale1,r=e[i].itemVale2,t.setTableData(n,a,r)}})},this.emptyTable=function(t){$("#profitDataTable tr:gt(0)").each(function(){$(this).find("td").each(function(t,e){2!=t&&3!=t||$(this).text("")})}),e.searchTableData(t)},this.bind=function(){$("#profit-search").on("click",function(){var n=$("#profit-time").val();""==n&&(n=t.getYearAndMonth()),$("#profit_nowDate").text(n),e.emptyTable(n)})},this.unbindAll=function(){$("#profit-search").off("click")},$("#profit-out").on({click:function(){var e=t.getYearAndMonth(),n=$("#profit-time").val();if(11==n.length&&(n=e),"中文"==$("#main-changeLanguage").text())var a=(new Base64).encode("tosys/coaReport/export/profitEnglish/"+n+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId);else var a=(new Base64).encode("tosys/coaReport/export/profit/"+n+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId);$.openHref(_global_settings.service.url+"/ac/exportReport/"+a)}}),$("#profit-print").on("click",function(){var e=t.getYearAndMonth(),n=$("#profit-time").val();if(11==n.length&&(n=e),"中文"==$("#main-changeLanguage").text())var a=(new Base64).encode("reportName=ProfitPrintEN&date="+n+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId);else var a=(new Base64).encode("reportName=ProfitPrint&date="+n+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId);window.open(_global_settings.service.url+"/ac/print/"+a)})};