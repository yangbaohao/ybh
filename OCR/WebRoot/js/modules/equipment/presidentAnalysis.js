var PresidentAnalysisMgt=function(){var t=this,e=_global_settings.service.url+"/ac/";this.date=new Date,this.initInput=function(){$("#presidentAnalysis_nowDate").text(t.setDate()),$("#presidentAnalysis_comname").text(currentUserInfo.name),t.setTime(),t.getTableData(),t.initPages()},this.initPages=function(){if("中文"==$("#main-changeLanguage").html()){$("#president-searchdate").text("Date"),$("#presidentAnalysis-search").text("Search"),$("#presidentAnalysis-refresh").text("Refresh"),$("#presidentAnalysis-print").text("print"),$("#presidentAnalysis-out").text("Export"),$("#presidentAnalysis-headMsg").text("Operation Analysis");$("#presidentAnalysis_nowDate").text(function(){var e=t.date.getFullYear(),n=t.date.getMonth();n+=1;var i=t.date.getDate();return n<10&&(n="0"+n),i<10&&(i="0"+i),i+"/"+n+"/"+e}()),$("#presidentAnalysis-unit").text("Unit：RMB");var e=$("#presidentAnalysisDataTable>thead>tr>th");e.eq(0).html("Items"),e.eq(1).html("Line No."),e.eq(2).html("Current amount/Ratio"),e.eq(3).html("Accumulated Amount For The Month"),e.eq(4).html("Compared with the previous period"),e.eq(5).html("With the proportion of the previous period"),e.eq(6).html("Financial analysis and suggestion");var n=$("#presidentAnalysisDataTable>tbody>tr");n.eq(0).text("Capital Operation"),n.eq(1).find("td:first").text("Income"),n.eq(2).find("td:first").text("Expend"),n.eq(3).find("td:first").text("Net Income "),n.eq(4).text("The Profits Of profit and loss"),n.eq(5).find("td:first").text("Income"),n.eq(6).find("td:first").text("Cost"),n.eq(7).find("td:first").text("Net Profit (negative net loss)"),n.eq(8).text("Short Term Solvency Ratio"),n.eq(9).find("td:first").text("Working Capital"),n.eq(10).find("td:first").text("Current ratio"),n.eq(11).find("td:first").text("Quick Ratio"),n.eq(12).find("td:first").text("Cash Ratio"),n.eq(13).text("Long-term Solvency Ratios"),n.eq(14).find("td:first").text("Debt To Assets Ratio"),n.eq(15).find("td:first").text("Equity Ratio"),n.eq(16).find("td:first").text("Equity Multiplier EM"),n.eq(17).find("td:first").text("Debt-to-long Capital Ratio"),n.eq(18).text("Operating Capacity Ratio"),n.eq(19).find("td").eq(0).text("Receivables Turnover Ratio"),n.eq(19).find("td").eq(1).text("Receivables Turnover Number"),n.eq(20).find("td:first").text("Receivables Turnover Days"),n.eq(21).find("td:first").text("Accounts Receivable And Income Ratio"),n.eq(22).find("td").eq(0).text("Inventory Turnover Ratio"),n.eq(22).find("td").eq(1).text("Inventory Turnover Number"),n.eq(23).find("td:first").text("Inventory Turnover Days"),n.eq(24).find("td:first").text("Inventory To Income Ratio"),n.eq(25).find("td").eq(0).text("Current Asset Turnover"),n.eq(25).find("td").eq(1).text("Current Asset Turnover Number"),n.eq(26).find("td:first").text("Current Asset Turnover Days"),n.eq(27).find("td:first").text("Current Asset And Income Ratio"),n.eq(28).find("td").eq(0).text("Non Current Asset Turnover Ratio"),n.eq(28).find("td").eq(1).text("Non Current Asset Turnover Ratio Number"),n.eq(29).find("td:first").text("Non Current Asset Turnover Ratio Days"),n.eq(30).find("td:first").text("Non Current Asset And Income Ratio"),n.eq(31).find("td").eq(0).text("Total Assets Turnover"),n.eq(31).find("td").eq(1).text("Total Assets Turnover Number"),n.eq(32).find("td:first").text("Total Assets Turnover Days"),n.eq(33).find("td:first").text("Total Assets And Income Ratio"),n.eq(34).text("Profitability Ratios"),n.eq(35).find("td:first").text("Net Profit Margin on Sales/Net profit margin"),n.eq(36).find("td:first").text("Rate Of Return On Total Assets"),n.eq(37).find("td:first").text("ROE (Rate of Return on Common Stockholders’ Equity)"),$("#presidentAnalysisDataTable>tbody>tr").find("td:last").text("Detail"),$("#alertDet-msg").text("Senior financial experts wait for you to provide advisory services, please call (0086 400-7788-966 Transfer 1)"),$("#presidentAnalysis-confirm").text("OK")}},$("#presidentAnalysis-time").bind("focus,blur",function(){var t=$("#presidentAnalysis-time").val();$("#presidentAnalysis_nowDate").text(""),$("#presidentAnalysis_nowDate").text(t)}),this.setTime=function(){$("#presidentAnalysis-time").monthpicker({callback:"dasdasd"})},this.getTableData=function(){Core.AjaxRequest({type:"GET",showWaiting:!1,url:e+(new Base64).encode("tosys/coaReport/presidentAnaly/"+t.getYearAndMonth()+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),callback:function(e){for(var n,i,s,a,r,o=0;o<e.length;o++)n=e[o].sequence,i=e[o].lastmothAmt,s=e[o].mothAmt,a=e[o].mothaCompare,r=e[o].mothaPercentage,t.setTableData(n,s,i,a,r);t.setTextStyle()}})},this.setTextStyle=function(){$("#presidentAnalysisDataTable tr:gt(0)").each(function(){$(this).find(".sort").each(function(t){$(this).attr("class","sort text-center"),$(this).nextAll().attr("class","text-right"),$(this).nextAll().eq(-1).attr("class","text-center color-1193C5 hoverspan").attr("data-toggle","modal").attr("data-target","#alertDet")}),$(this).find(".sortb").each(function(t){$(this).attr("class","sortb text-center"),$(this).nextAll().attr("class","text-right"),$(this).nextAll().eq(-1).attr("class","text-center color-1193C5 hoverspan").attr("data-toggle","modal").attr("data-target","#alertDet")}),$(this).find(".sortc").each(function(t){$(this).attr("class","sortc text-center"),$(this).nextAll().attr("class","text-right"),$(this).nextAll().eq(-1).attr("class","text-center color-1193C5 hoverspan").attr("data-toggle","modal").attr("data-target","#alertDet")})})},this.setTableData=function(t,e,n,i,s){$.each($(".sort"),function(a,r){$(this).text()==t&&($(this).nextAll().eq(0).text(money(e)),$(this).nextAll().eq(1).text(money(n)),$(this).nextAll().eq(2).text(money(i)),$(this).nextAll().eq(3).text(money(s)),$(this).nextAll().eq(-1).text("详情"),"中文"==$("#main-changeLanguage").html()&&$(this).nextAll().eq(-1).text("Detail"))}),$.each($(".sortb"),function(a,r){$(this).text()==t&&($(this).nextAll().eq(0).text(money(e)+"%"),$(this).nextAll().eq(1).text(money(n)+"%"),$(this).nextAll().eq(2).text(money(i)+"%"),$(this).nextAll().eq(3).text(money(s)),$(this).nextAll().eq(-1).text("详情"),"中文"==$("#main-changeLanguage").html()&&$(this).nextAll().eq(-1).text("Detail"))}),$.each($(".sortc"),function(a,r){$(this).text()==t&&($(this).nextAll().eq(0).text(e),$(this).nextAll().eq(1).text(n),$(this).nextAll().eq(2).text(i),$(this).nextAll().eq(3).text(s),$(this).nextAll().eq(-1).text("详情"),"中文"==$("#main-changeLanguage").html()&&$(this).nextAll().eq(-1).text("Detail"))})},this.setDate=function(){var e=t.date.getFullYear(),n=t.date.getMonth();n+=1;var i=t.date.getDate();return n<10&&(n="0"+n),i<10&&(i="0"+i),e+"年"+n+"月"+i+"日"},this.getYearAndMonth=function(){var e=t.date.getFullYear(),n=t.date.getMonth();return n+=1,n<10&&(n="0"+n),e+"-"+n}},PresidentAnalysisBindModle=function(t){var e=this,n=_global_settings.service.url+"/ac/";this.searchTableData=function(e){Core.AjaxRequest({type:"GET",showMsg:!1,showWaiting:!1,url:n+(new Base64).encode("tosys/coaReport/presidentAnaly/"+e+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),callback:function(e){for(var n,i,s,a,r,o=0;o<e.length;o++)n=e[o].sequence,i=e[o].lastmothAmt,s=e[o].mothAmt,a=e[o].mothaCompare,r=e[o].mothaPercentage,t.setTableData(n,s,i,a,r)}})},this.emptyTable=function(t){$("#presidentAnalysisDataTable tr:gt(0)").each(function(){$(this).find(".sort").each(function(t,e){$(this).nextAll().text("")})}),e.searchTableData(t)},this.bind=function(){$("#presidentAnalysis-search").on("click",function(){var n=$("#presidentAnalysis-time").val();""==n&&(n=t.getYearAndMonth()),$("#presidentAnalysis_nowDate").text(n),e.emptyTable(n)}),$("#presidentAnalysis-refresh").on("click",function(){$.addTab({title:"运营分析",isFrame:!1,url:ctx+"/page/modules/equipment/presidentAnalysis.html",pk:{random:Math.random()},reload:!0})}),$("#presidentAnalysis-out").on({click:function(){var e=$("#presidentAnalysis-time").val();""==e&&(e=t.getYearAndMonth()),"中文"==$("#main-changeLanguage").html()?$.openHref(_global_settings.service.url+"/ac/exportReport/"+(new Base64).encode("tosys/coaReport/export/presidentAnalysisEnglish/"+e+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId)):$.openHref(_global_settings.service.url+"/ac/exportReport/"+(new Base64).encode("tosys/coaReport/export/presidentAnalysis/"+e+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId))}})},this.unbindAll=function(){$("#presidentAnalysis-search").off("click")},$("#presidentAnalysis-print").on("click",function(){"中文"==$("#main-changeLanguage").html()?window.open(_global_settings.service.url+"/ac/print/"+(new Base64).encode("reportName=OperationAnalysisEN&moth="+$("#presidentAnalysis-time").val()+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId)):window.open(_global_settings.service.url+"/ac/print/"+(new Base64).encode("reportName=OperationAnalysis&moth="+$("#presidentAnalysis-time").val()+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId))})};