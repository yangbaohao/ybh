var EquipmentdetMgt=function(){var e=this,a=_global_settings.service.url+"/asset";this.data=null,this.random=null,this.initInput=function(){e.data=$.pk.data,e.random=($.pk.random+"0").substring(2,8),void 0!==$.pk&&(void 0!==$.pk.data&&void 0!==$.pk.random||Core.alert({message:"data,random入参错误",callback:function(){$.closeTab()}})),$("#viewequip-assetRef").attr("id","viewequip-assetRef"+e.random),$("#viewequip-assetName").attr("id","viewequip-assetName"+e.random),$("#viewequip-purchaseDate").attr("id","viewequip-purchaseDate"+e.random),$("#viewequip-iniValue").attr("id","viewequip-iniValue"+e.random),$("#viewequip-totalDepreciatedValue").attr("id","viewequip-totalDepreciatedValue"+e.random),$("#viewequip-assetBal").attr("id","viewequip-assetBal"+e.random),$("#viewequip-scrapValueRatio").val("id","viewequip-scrapValueRatio"+e.random),$("#viewequip-sumExpectVal").attr("id","viewequip-sumExpectVal"+e.random),$("#viewequip-scrapValueRatio").attr("id","viewequip-scrapValueRatio"+e.random),$("#viewequip-coaDepreciate").attr("id","viewequip-coaDepreciate"+e.random),$("#viewequip-coaExpense").attr("id","viewequip-coaExpense"+e.random),$("#viewequip-dateshow_hide2").attr("id","viewequip-dateshow_hide2"+e.random),$("#viewequip-dateshow_hide3").attr("id","viewequip-dateshow_hide3"+e.random),$("#viewequip-y").attr("id","viewequip-y"+e.random),$("#viewequip-n").attr("id","viewequip-n"+e.random),$("#viewequip-expectTime").attr("id","viewequip-expectTime"+e.random),$("#viewequip-assetMonth").attr("id","viewequip-assetMonth"+e.random),$("#viewequip-startTime").attr("id","viewequip-startTime"+e.random),$("#viewequip-endTime").attr("id","viewequip-endTime"+e.random),$("#viewequip-iniprice").attr("id","viewequip-iniprice"+e.random),$("#viewequip-ininum").attr("id","viewequip-ininum"+e.random),"pauseDepreciate"==e.data.startDepreciate&&($("#viewequip-stop")[0].checked=!0,$("#viewequip-dateshow_hide2"+e.random).css("display","none"),$("#viewequip-dateshow_hide3"+e.random).css("display","none")),$("#viewequip-stop").attr({id:"#viewequip-stop"+e.random,disabled:"disabled"}),$("#viewequip-income").attr("id","viewequip-income"+e.random),$("#viewequip-jsy").attr("id","viewequip-jsy"+e.random),$("#eqmgt_view_sell").attr("id","eqmgt_view_sell"+e.random),$("#viewequip-iniprice"+e.random).val(e.data.price),$("#viewequip-ininum"+e.random).val(e.data.qty),$("#viewequip-assetRef"+e.random).val(e.data.assetRef),$("#viewequip-assetName"+e.random).val(e.data.name),$("#viewequip-purchaseDate"+e.random).val(e.data.purchaseDate.substring(0,10)),$("#viewequip-iniValue"+e.random).val(money(e.data.iniValue)),$("#viewequip-totalDepreciatedValue"+e.random).val(money(e.data.totalDepreciatedValue)),$("#viewequip-scrapValueRatio"+e.random).val(e.data.scrapValueRatio),$("#viewequip-sumExpectVal"+e.random).val(money(e.data.iniValue*(e.data.scrapValueRatio/100))),$("#viewequip-scrapValueRatio"+e.random).val(e.data.scrapValueRatio),$("#viewequip-coaDepreciate"+e.random).val(e.getStockSubject("chartOfAccounts",e.data.coaDepreciate.id)),$("#viewequip-coaExpense"+e.random).val(e.getStockSubject("chartOfAccounts",e.data.coaExpense.id));var a=e.data.startDepreciate;a in{stopDepreciate:!0,scrap:!0,sell:!0}&&$("#eqmgt_viewState").replaceWith('<span class="btn btn-success float-right mg10">已'+getCodeData(a)+"</span>"),$("#viewequip-assetBal"+e.random).val(money(e.data.iniValue-e.data.totalDepreciatedValue)),"sell"==a&&($("#eqmgt_view_sell"+e.random).css("display",""),$("#viewequip-income"+e.random).val(money(e.data.income)),$("#viewequip-jsy"+e.random).val(money(e.data.income-e.data.iniValue+e.data.totalDepreciatedValue))),$("#viewequip-n"+e.random).css({display:"none"}),$("#viewequip-expectTime"+e.random).val(e.data.depreciateMonth),$("#viewequip-assetMonth"+e.random).val(e.data.monthlyDepreciateValue),null!=e.data.depreciateStartMonth&&$("#viewequip-startTime"+e.random).val(e.data.depreciateStartMonth.substring(0,7)),null!=e.data.depreciateEndMonth&&$("#viewequip-endTime"+e.random).val(e.data.depreciateEndMonth.substring(0,7))},this.getStockSubject=function(e,a){for(var i=ComboBoxSources.getAdapter(e),t=i.records,n=0;n<t.length;n++)if(t[n].id==a)return t[n].name;if(!a)return ComboBoxSources.load(e),"暂无"},this.settings={source:{datafields:[{name:"id",type:"long"},{name:"name",type:"string"},{name:"type",type:"string"},{name:"unit",type:"string"},{name:"createDate",type:"date"}],url:a+"/search"},grid:{element:"EquiGrid"},ajax:{url:a}}},EquipmentdetBindModle=function(e){this.bind=function(){},this.unbindAll=function(){},$("#add-assetPrint").on("click",function(){var a=(new Base64).encode("reportName=AssetPrint2&assetId="+e.data.id+"&printType=pdf&ownerId="+currentUserInfo.id+"&username="+currentUserInfo.loginId).replace("_$_",".").replace(/\//g,"_a").replace(/\+/g,"_b").replace(/\=/g,"_c");e.data.startDepreciate,window.open(_global_settings.service.url+"/ac/print/"+a)})};