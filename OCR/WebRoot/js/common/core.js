function clearcoverlayout(){$("body").find("#cover_div").remove()}function opensavelayout(){$("#alertWindow").length>0&&$("body").find("#cover_div").remove();$("body").append("<div id='cover_div' style='position:absolute;top:0px;left:0px;width:100%;height:100%;background:#fff;filter:Alpha(Opacity=10);/* IE */-moz-opacity:0.1;/* Moz + FF */opacity: 0.1;z-index:999999'><img src=images/common/loading6.gif style='position:absolute;top:48%;left:48%'></img></div>")}function urlAddRandom(e){return e=e.indexOf("?")>0?e+"&r="+Math.random():e+"?r="+Math.random()}function loadCatogeryInfo(){Core.AjaxRequest({url:_global_settings.service.url+"/owner/category/"+currentUserInfo.id,type:"GET",showMsg:!1,callback:function(e){$.each(e,function(t,o){e.id==currentUserInfo.id&&($("#category1_name").val(e.category1),$("#category2_name").val(e.category2),$(".category1_name,#category1_name").not("input").text(e.category1),$(".category2_name,#category2_name").not("input").text(e.category2))})},failure:function(e){Core.alert({message:e.responseJSON.errorMsg})}})}var Core={};Core.fileAjaxRequest=function(e){var t=$(".uploader-list"),o=null;$.each(t,function(e,t){if(!$(t).is(":hidden")){if($(t).find(".state").text().indexOf("等待上传")>-1)return o="系统检测到有附件没有上传,继续操作将不会保存附件,是否继续操作？",!1;if($(t).find(".state").text().indexOf("上传中")>-1)return o="系统检测到有附件正在上传,继续操作将不会保存附件,是否继续操作？",!1}}),null==o||!1===e.checkFile||"POST"!=e.type&&"PUT"!=e.type?Core.AjaxRequest(e):setTimeout(function(){Core.confirm({message:o,confirmCallback:function(){Core.AjaxRequest(e)}})},200)},Core.AjaxRequest=function(e){var t=void 0===e.params?null:e.params,o=void 0===e.showWaiting||e.showWaiting,i=void 0===e.showMsg||e.showMsg,n=void 0===e.async||e.async,a=void 0===e.dataType?"json":e.dataType,r=void 0===e.type?"POST":e.type,l=void 0===e.contentType?"application/json; charset=UTF-8":e.contentType,s=void 0===e.cache||e.cache,d=void 0===e.timeout?6e4:e.timeout,c=null;if(o){c=1,$("#alertWindow").length>0&&$("body").find("#cover_div").remove();$("body").append("<div id='cover_div' style='position:absolute;top:0px;left:0px;width:100%;height:100%;background:#b1b1b1;filter:Alpha(Opacity=10);/* IE */-moz-opacity:0.1;/* Moz + FF */opacity: 0.1;z-index:999999'><img src=images/common/loading6.gif style='position:absolute;top:48%;left:48%'/></div>"),$("#cover_div").find("img").css("top",($(window).height()-20)/2+$(document).scrollTop())}jQuery.ajax({contentType:l,url:urlAddRandom(e.url),type:r,data:JSON.stringify(t),async:n,dataType:a,beforeSend:function(e){},cache:s,timeout:d,success:function(t,o){null!=c&&clearcoverlayout();new Date;if("GET"==r)return void(e.callback&&e.callback(t,o));if(1==i){var n="操作成功";e.successMsg&&""!=e.successMsg&&(n=e.successMsg),Core.alert({title:"提示",message:n,callback:function(){e.callback&&e.callback(t,o)}})}else e.callback&&e.callback(t,o)},error:function(t,o){if(clearcoverlayout(),$.timeOutCookie(t.responseText),500==t.status){var n=t.responseJSON;if(1==i)if("DELETE"==r&&n.errorCode.indexOf("Exception")>-1)Core.alert({title:"错误",type:"error",message:"该数据已被使用，不能删除。",callback:function(){"function"==typeof e.failure&&e.failure(t)}});else{var a=""==n.errorCode?"错误信息":n.errorCode;Core.alert({title:"错误",type:"error",message:a+":"+n.errorMsg,callback:function(){"function"==typeof e.failure&&e.failure(t)}})}else"function"==typeof e.failure&&e.failure(t)}else 403==t.status?e.failure(t):404==t.status&&Core.alert({title:"错误",type:"error",message:"404:请求没有找到",callback:function(){"function"==typeof e.failure&&e.failure(t)}})}})},Core.AcTableDataAdapter=function(e,t,o,i){void 0===i&&(i=!1);var n=Core.AcTableSource(e,t,i),a=void 0===o?{}:o;a.beforeSend=function(e,t){};var r={downloadComplete:function(e,t,o){},loadComplete:function(e){},loadError:function(e,t,o){$.timeOutCookie(e.responseText)}};return $.extend(!0,r,a),new $.jqx.dataAdapter(n,r)},Core.AcDataAdapter=function(e,t,o,i){void 0===i&&(i=!1),t.data=null===t.data?{condition:{}}:{condition:t.data};var n=Core.AcSource(e,t,i),a=void 0===o?{}:o;a.beforeSend=function(o,n){-1!=n.url.indexOf("?")&&(n.url=void 0===t.dataUrl?n.url.substring(0,n.url.indexOf("?")):t.dataUrl.url.value[0]);var a=$("#"+e).jqxGrid("getdatainformation"),r=a.sortinformation,l=r.sortcolumn,s=r.sortdirection,d=a.paginginformation,c=d.pagenum,u=d.pagesize;d.pagescount;t.data.filterscount=0,t.data.groupscount=0,t.data.sortdatafield=l,void 0==l&&void 0!=t.data.condition&&void 0!=t.data.condition.sortdatafield&&(t.data.sortdatafield=t.data.condition.sortdatafield),s&&(s.ascending&&(t.data.sortorder="asc"),s.descending&&(t.data.sortorder="desc")),t.data.pagenum=c,t.data.pagesize=u;var p=$.extend(!0,{},t.data),f=p.condition,g=[];if(f)e:for(var v in f){var h=f[v];if(null!=h.value&&0!=h.value.length){if("between"==h.action){if(2!=h.value.length)continue e;if(null==h.value[0]&&null==h.value[1])continue e;null==h.value[0]&&null!=h.value[1]&&(h.action="le"),null!=h.value[0]&&null==h.value[1]&&(h.action="ge")}else for(var m=0;m<h.value.length;m++)if(null==h.value[m])continue e;h.key=v,g.push(h)}}p.condition=g,!0===t.myPage?n.url=n.url+"/"+c*u+"/"+(parseInt(c)+1)*u:!1===i&&(n.url=n.url+"/"+(new Base64).encode(JSON.stringify(p).replace("_$_",".")).replace(/\//g,"_a").replace(/\+/g,"_b").replace(/\=/g,"_c")),n.url+="?t="+Math.random()};var r={downloadComplete:function(e,t,o){n.totalrecords=e.totalRows},loadComplete:function(e){},loadError:function(e,t,o){}};return $.extend(!0,r,a),new $.jqx.dataAdapter(n,r)},Core.AcTableSource=function(e,t,o){var i=void 0!==o&&o,n=void 0===e?null:e,a=void 0===t.data?{}:t.data;if(null==n)return null;var r={};return r=i?{datatype:"csv",type:"GET",cache:!1,async:!0}:{datatype:"json",type:"GET",cache:!1,data:a,async:!0,root:"rows",beforeprocessing:function(e){},sort:function(){},filter:function(){}},$.extend(!0,{},r,t)},Core.AcSource=function(e,t,o){var i=void 0!==o&&o,n=void 0===e?null:e;if(null==n)return null;var a={};return a=i?{datatype:"csv",type:"GET",cache:!1,async:!0,data:t.data}:{datatype:"json",type:"GET",cache:!1,data:t.data,async:!0,root:"rows",sort:function(){$("#"+n).jqxGrid("updatebounddata","desc")},filter:function(){$("#"+n).jqxGrid("updatebounddata","filter")}},$.extend(!0,{},a,t)},Core.NewDataAdapter=function(e){var t=void 0===e.params?{condition:{}}:{condition:e.params},o=void 0!==e.async&&e.async,i=void 0!==e.cache&&e.cache,n=void 0===e.dataType?"json":e.dataType,a=void 0===e.type?"GET":e.type,r=void 0===e.contentType?"application/json; charset=UTF-8":e.contentType,l=e.gridId,s={datatype:n,contentType:r,url:e.url,root:"rows",cache:i,async:o,data:t,type:a,beforeprocessing:function(e){s.totalrecords=e.totalRows},sort:function(){$("#"+e.gridId).jqxGrid("updatebounddata","sort")},filter:function(){$("#"+e.gridId).jqxGrid("updatebounddata","filter")}};s=$.extend(!0,s,e.source);var d=void 0===e.setting?{}:e.setting;return d.beforeSend=function(o){var i=s.url;i=i.substring(0,i.indexOf("?"));var n=$("#"+l).jqxGrid("getdatainformation"),a=(n.rowscount,n.sortinformation),r=a.sortcolumn,d=a.sortdirection,c=n.paginginformation,u=c.pagenum,p=c.pagesize;c.pagescount;t.filterscount=0,t.groupscount=0,r&&(t.sortdatafield=r),d&&(d.ascending&&(t.sortorder="asc"),d.descending&&(t.sortorder="desc")),t.pagenum=u,t.pagesize=p;var f=$.extend(!0,{},t),g=f.condition,v=[];if(g)e:for(var h in g){var m=g[h];if(null!=m.value&&0!=m.value.length){if("between"==m.action){if(2!=m.value.length)continue e;if(null==m.value[0]&&null==m.value[1])continue e;null==m.value[0]&&null!=m.value[1]&&(m.action="le"),null!=m.value[0]&&null==m.value[1]&&(m.action="ge")}else for(var w=0;w<m.value.length;w++)if(null==m.value[w])continue e;m.key=h,v.push(m)}}f.condition=v,e.url=e.url+"/"+(new Base64).encode(JSON.stringify(f).replace("_$_",".")).replace(/\//g,"_a").replace(/\+/g,"_b").replace(/\=/g,"_c")},new $.jqx.dataAdapter(s,d)},Core.AjaxFileUpload=function(settings){var params=void 0===settings.params?null:settings.params,submitBtnId=void 0===settings.submitBtnId?"":settings.submitBtnId,showWaiting=void 0===settings.showWaiting||settings.showWaiting,showMsg=void 0===settings.showMsg||settings.showMsg,waiting=null;showWaiting&&(waiting=1,opensavelayout()),""!=submitBtnId&&$("#"+submitBtnId).attr("disabled",!0),$.ajaxFileUpload({url:settings.url+"?token="+currentUser.user.token,secureuri:!1,fileElementId:settings.fileElementId,dataType:"text",data:settings.params,success:function(data,status){data=eval("("+data+")"),""!=submitBtnId&&$("#"+submitBtnId).attr("disabled",!1),clearcoverlayout(),"success"==status&&(showMsg?Core.alert({title:"提示",message:data.message,callback:function(){settings.callback(data)}}):settings.callback(data))},error:function(e){""!=submitBtnId&&$("#"+submitBtnId).attr("disabled",!1),clearcoverlayout()}})},Core.AjaxFormSubmit=function(e){if(void 0!==e.formId){var t=(void 0===e.showWaiting||e.showWaiting,void 0===e.async||e.async),o=void 0===e.showMsg||e.showMsg,i=void 0===e.url?$("#"+e.formId).attr("action"):e.url,n=void 0===e.dataType?"json":e.dataType,a={type:"POST",async:t,dataType:n,url:i,success:function(t){if(t instanceof Object==0)return void(e.callback&&e.callback(t));if(void 0==t.status)if(void 0!=t.timeout&&1==t.timeout){t.message&&""!=t.message&&t.message}else e.callback&&e.callback(t);else if(1==t.status)if(1==o){t.message&&""!=t.message?t.message:e.successMsg&&""!=e.successMsg&&e.successMsg}else e.callback&&e.callback(t);else if(0==t.status){t.message&&""!=t.message?t.message:e.failureMsg&&""!=e.failureMsg&&e.failureMsg,t.exceptionMessage&&t.exceptionMessage}},error:function(e,t){if("function"==typeof e.getResponseHeader){var o=e.getResponseHeader("session-status");if("timeout"==o)return!1;if("pagenotfind"==o)return!1;e.status}}};$("#"+e.formId).ajaxSubmit(a)}},Core.confirm=function(e){var t=void 0===e.title?$.i18n.prop("core.confirm.title"):e.title,o=void 0===e.message?"":e.message,i=void 0===e.yes?$.i18n.prop("core.confirm.yes"):e.yes,n=void 0===e.no?$.i18n.prop("core.confirm.no"):e.no,a=(void 0===e.type||e.type,void 0===e.height?195:e.height),r=void 0===e.width?450:e.width;void 0==e.left||e.left,void 0==e.right||e.right;$("#confirmWindow").length>0&&$("#confirmWindow").remove(),$('<div id="confirmWindow"><div id="customWindowHeader"><span id="captureContainer" style="float: left">'+t+'</span></div><div id="customWindowContent" style="overflow: hidden"><div style="width:100%;height:60px;line-height:16px;position:relative;top:0px;left:0px;padding-top:50px;text-align:center;"><font style="font-size: 15px;">'+o+'</font></div><div style="bottom: 5px;right: 5px;position: absolute;"> <input type="button" class="button_02" style="width:100px;height:33px;margin-top:20px;" value='+i+' id="okButton_cf" /> <input type="button" class="button_02" style="width:100px;height:33px;margin-top:20px;" value='+n+' id="cancelButton" /></div></div></div>').appendTo($("body")),$("#confirmWindow .jqx-window-modal").css("width","1200px");var l=$(window).width(),s=$(window).height();$("#confirmWindow").jqxWindow({position:{x:(l-r)/2,y:(s-a)/2+$(document).scrollTop()},width:r,height:a,resizable:!1,isModal:!0,closeButtonAction:"close",theme:currentTheme,initContent:function(){$("#okButton_cf").jqxButton({disabled:!1,theme:currentTheme}),$("#cancelButton").jqxButton({disabled:!1,theme:currentTheme}),$("#okButton_cf").focus()}}),$("#confirmWindow").find("#okButton_cf").click(function(){return $("#confirmWindow").jqxWindow("close"),e.confirmCallback&&e.confirmCallback(),$("#confirmWindow").jqxWindow("destroy"),!0}),$("#confirmWindow").find("#cancelButton").click(function(){$("#confirmWindow").jqxWindow("close"),e.cancelCallback&&e.cancelCallback(),$("#confirmWindow").jqxWindow("destroy")})},Core.alert=function(e){var t=void 0===e.title?$.i18n.prop("core.alter.title"):e.title,o=void 0===e.message?"":e.message,i=void 0===e.yes?$.i18n.prop("core.alter.yes"):e.yes,n=void 0===e.type?"info":e.type,a=void 0===e.width?450:e.width,r=195,l=void 0===e.hide||e.hide;callback=void 0===e.callback?function(){}:e.callback,avaiable=void 0===e.avaiable||e.avaiable;var s='<i class="icons-32-blue icon-info-circled"></i>';if("warning"==n?s='<i class="icons-32-yellow icon-attention-1"></i>':"error"==n?s='<i class="icons-32-red icon-cancel-circled"></i>':"info"==n&&(s='<i class="icons-32-blue icon-info-circled"></i>'),$("#alertWindow").length>0&&$("#alertWindow").jqxWindow("destroy"),$("#avaiableFade").length>0&&$("#avaiableFade").remove(),avaiable){var d=$('<div id="avaiableFade" class="alert alert-warning alert-dismissible fade in" role="alert"><div class="close" data-dismiss="alert" aria-label="Close"><span id="avaiableWindow">'+o+"</span></div></div>");d.appendTo($("body")),r=void 0===r?d.height()+30:r;var c=$(window).width(),u=$(window).height(),p=1.15*$("#avaiableWindow").width();p>800&&(p=800),$("#avaiableFade").css({position:"absolute",top:$(document).scrollTop()+400+"px",height:40,width:p,"z-index":2e4}),$("#avaiableWindow").css({"word-break":"break-all","text-align":"center"}),$("#avaiableFade").css({left:c/2-95-$("#avaiableFade").width()/2+"px",height:13+1.05*$("#avaiableWindow").height()});var f,g=0,v=0;return e.hide?(g=(new Date).getTime(),f=setTimeout(function(){$("#avaiableFade").trigger("click")},e.hide)):(g=(new Date).getTime(),f=setTimeout(function(){$("#avaiableFade").trigger("click")},3e3)),$("#avaiableFade").off("click").on("click",function(){v=(new Date).getTime(),(v-g)/1e3>=3?($("#avaiableWindow").off("close").alert("close"),clearTimeout(f)):e.hide&&($("#avaiableWindow").off("close").alert("close"),clearTimeout(f))}),"function"==typeof callback&&callback(),!1}var h=$('<div id="alertWindow"><div id="customWindowHeader"><span id="captureContainer" style="float: left">'+t+'</span></div><div id="customWindowContent" style="overflow: hidden"><div style="width:100%;height:60px;line-height:16px;position:relative;top:0px;left:0px;padding-top:50px;text-align:center;">'+s+'<span class="coretips" style="">'+o+'</span></div><div style="float: right; margin-top: 40px;margin-bottom:5px;"> <input type="button" class="button_02" value="'+i+'" id="okButton" style="width:100px;height:33px;margin-top:20px;position: relative;"/></div></div></div>');h.appendTo($("body")),r=void 0===r?h.height()+30:r;var c=$(window).width(),u=$(window).height();$("#alertWindow").jqxWindow({position:{x:(c-a)/2,y:(u-r)/2},width:a,height:r,resizable:!1,isModal:!0,theme:currentTheme,keyboardCloseKey:"none",showCloseButton:!1,initContent:function(){$("#okButton").jqxButton({disabled:!1,theme:currentTheme}),$("#okButton").focus()}});var m;l&&(m=setTimeout(function(){$("#okButton")[0]&&$("#okButton").trigger("click")},5e3)),e.hide&&(m=setTimeout(function(){$("#okButton")[0]&&$("#okButton").trigger("click")},e.hide)),$("#alertWindow").find("#okButton").click(function(){if(0!=$(".java_buy").length){var e=$(".java_buy").attr("data-permissions");"billing:product:useraccount"!==e&&"billing:product:apprval"!==e&&$.closeTab()}$("#alertWindow").jqxWindow("destroy"),clearTimeout(m),"function"==typeof callback&&callback()}),$(window).resize(function(){try{$("#alertWindow").jqxWindow({position:{x:($(window).width()-$("#alertWindow").width())/2,y:($(window).height()-$("#alertWindow").height())/2+$(document).scrollTop()}})}catch(e){$(window).off("resize")}})},Core.attachmentDownload=function(e){if(void 0!=e&&null!=e&&""!=e&&!isNaN(e)){var t=ctx+"/download/"+e;window.location=t}},Core.map2Ary=function(e){var t=[];for(var o in e)t.push([o,e[o]]);return t},Core.map=function(e,t,o){return t[e]||(void 0===o||null===o?e:o)},Core.sayHello=function(){var e=(new Date).getHours();return(e<6?"凌晨好":e<9?"早上好":e<12?"上午好":e<14?"中午好":e<17?"下午好":e<19?"傍晚好":e<22?"晚上好":"夜里好")+"，"},Core.openWindow=function(e,t,o,i){var n=(window.screen.height-30-i)/2,a=(window.screen.width-10-o)/2;window.open(e,t,"height="+i+",innerHeight="+i+",width="+o+",innerWidth="+o+",top="+n+",left="+a+",toolbar=no,menubar=no,scrollbars=auto,resizeable=no,modal=yes,location=no,status=no")},Core.openModalWindow=function(e,t,o,i,n){var a=(window.screen.height-30-i)/2,r=(window.screen.width-10-o)/2;return window.showModalDialog(e,t,"dialogWidth="+o+"px;dialogHeight="+i+"px;dialogLeft:"+r+"px;dialogTop:"+a+"px","toolbar=no;menubar=no;center=yes;scrollbars=auto;resizeable=no;location=no;status=no")},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in t)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[o]:("00"+t[o]).substr((""+t[o]).length)));return e},String.prototype.toDate=function(){var e=this.toString();return e=e.replace(/-/g,"/"),new Date(Date.parse(e))},String.prototype.toEscapeString=function(){return this.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\"/g,'\\"')},Core.cookie=function(e,t,o){if(void 0===t){var i=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var r=jQuery.trim(n[a]);if(r.substring(0,e.length+1)==e+"="){i=decodeURIComponent(r.substring(e.length+1));break}}return i}o=o||{},null===t&&(t="",o.expires=-1);var l="";if(o.expires&&("number"==typeof o.expires||o.expires.toUTCString)){var s;"number"==typeof o.expires?(s=new Date,s.setTime(s.getTime()+60*o.expires*60*1e3)):s=o.expires,l=";expires="+s.toUTCString()}var d=o.path?";path="+o.path:"",c=o.domain?";domain="+o.domain:"",u=o.secure?";secure":"";document.cookie=[e,"=",encodeURIComponent(t),l,d,c,u].join("")},Core.browser=function(){var e,t={},o=navigator.userAgent.toLowerCase(),i=!1;return(e=o.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=o.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=o.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=o.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=o.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t.ie?Number(t.ie)>=9&&(i=!0):i=!!t.firefox||(!!t.chrome||!t.opera&&(t.safari,!0)),i},Core.randNum=function(){return Math.floor(99999999e4*Math.random()+1e4)},$.removeArray=function(e,t,o){var i=e.slice((o||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,i)},Core.console=function(e){var t=void 0===e.title?"提示":e.title,o=void 0===e.type?"sm":e.type,i=void 0===e.id?"myModal":e.id,n='<div class="modal fade" id="'+i+'">';n+='<div class="modal-dialog modal-'+o+'">',n+='<div class="modal-content"> ',n+='<div class="modal-header">',n+='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',n+='<h4 class="modal-title">'+t+"</h4>",n+="</div>",n+='<div class="modal-body">',n+="<p>您确定要进行此操作吗？</p>",n+="</div>",n+='<div class="modal-footer">',n+='<button type="button" class="btn btn-default btn-'+o+'" data-dismiss="modal">取消</button> ',n+='<button type="button" class="btn btn-primary btn-'+o+'">确定</button> ',n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#"+i).length>0?($("#"+i).remove(),$("body").append(n)):$("body").append(n)},Core.console2=function(e){var t=void 0===e.title?$.i18n.prop("core.alter.title"):e.title,o=(void 0===e.message||e.message,void 0===e.width?280:e.width),i=void 0===e.html?"":e.html,n=(void 0!==e.callback&&e.callback,e.height);$("#alertWindow").length>0&&$("#alertWindow").jqxWindow("destroy");var a=$('<div id="alertWindow"><div id="customWindowHeader"><span id="captureContainer" style="float: left">'+t+'</span></div><div id="customWindowContent" style="overflow: hidden"><div style="padding-top:15px;padding-bottom:15px;">'+i+"</div></div></div>");a.appendTo($("body")),n=void 0===n?a.height()+30:n;var r=$(window).width(),l=$(window).height();$("#alertWindow").jqxWindow({position:{x:(r-o)/2,y:(l-n)/2+$(document).scrollTop()},width:o,height:n,resizable:!0,isModal:!0,maxWidth:"1300",minHeight:"60",maxHeight:"800",theme:currentTheme,closeButtonAction:"close"}),$("#alertWindow").find("#okButton").click(function(){$(window).off("resize"),$("#alertWindow").jqxWindow("destroy"),e.callback&&e.callback()}),$(window).resize(function(){try{$("#alertWindow").jqxWindow({position:{x:($(window).width()-$("#alertWindow").width())/2,y:($(window).height()-$("#alertWindow").height())/2+$(document).scrollTop()}})}catch(e){$(window).off("resize")}})};var loadHtml=function(e,t){var o="";for(var i in t)o+='<tr><td><input type="text" data-id="'+t[i].id+'" value="'+t[i].typeValue+'"></td><td><span class=" md-cancel delete"></span></td></tr>';o+='<tr><td><input type="text"></td><td><span class=" md-cancel delete"></span></td></tr>',$("#"+e).html(o),loadCatogeryInfo()},getData=function(e,t,o){Core.AjaxRequest({url:_global_settings.service.url+"/ac/"+(new Base64).encode("tosys/coaReport/ownerBizTypeInfo/get/"+t+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),type:"GET",showMsg:!1,callback:function(o){loadHtml(e,o),$("#segment-"+t).on("click focus","tr",function(){var e=$(this),t=$(this).parent().parent(),o=$(this).parent().children().eq(-1);e[0]===o[0]&&"tbody"===e.parent()[0].nodeName.toLowerCase()&&(e.clone().appendTo(t),e.next().find("input").val(""))}),$("#segment-"+t).on("click",".delete",function(){return $(this).parent().parent().parent().children().length>1&&$(this).parent().parent().remove(),!1}),$("#segment-"+t).on("click",".obit-modalBtn",function(){var o=$.myBroth,i=t,n=[],a=0;if($.each($("#"+e).children(),function(e,t){var o=$(this).children().eq(0).find("input").val(),r=$(this).children().eq(0).find("input").attr("data-id");""!==o&&(n[a]={typeValue:o,ownerBizType:i,id:r},a+=1)}),"category1"==i||"category2"==i){var r="";r="category1"==i?$("#category1_name").val():$("#category2_name").val();var l={};l[i]=r,Core.AjaxRequest({url:_global_settings.service.url+"/ac/"+(new Base64).encode("tosys/coaReport/owner/category/"+currentUserInfo.id+"/"+currentUserInfo.loginId),type:"PUT",params:l,showMsg:!1,callback:function(e){setCloseAlertTimeOneSecond(),loadCatogeryInfo()},failure:function(e){Core.alert({message:e.responseJSON.errorMsg})}}),Core.AjaxRequest({url:_global_settings.service.url+"/ac/"+(new Base64).encode("tosys/coaReport/ownerBizTypeInfo/list/"+i+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),type:"POST",params:n,showMsg:!1,callback:function(e){setCloseAlertTimeOneSecond()},failure:function(e){Core.alert({message:e.responseJSON.errorMsg})}})}Core.AjaxRequest({url:_global_settings.service.url+"/ac/"+(new Base64).encode("tosys/coaReport/ownerBizTypeInfo/get/"+i+"/"+currentUserInfo.id+"/"+currentUserInfo.loginId),type:"GET",callback:function(e){ComboBoxSources.load(i,!0);var t=ComboBoxSources.getRecords(i);if(null!=o&&""!=o&&(0!=$(o).length?$(o).jqxComboBox({source:t}):$("#"+o).jqxComboBox({source:t})),"producttype"==i){for(var n=[],a=0;a<t.length;a++)n.push(t[a]);n.push({id:0,ownerBizType:"producttype",typeValue:"未分类"}),$(".productTypeAddNClass").jqxComboBox({source:n})}},failure:function(e){}})})},failure:function(e){}})};Core.showModal=function(e){var t={type:"",broth:"",show:!0,callback:function(e){}};e=$.extend(!0,t,e),$.myBroth=e.broth,0==$("#segment-"+e.type).length?$.get("page/common/segment/"+e.type+".html?v=2016-08-22",function(t){var o=$(t);$("body").append(o),e.callback(t),getData("obti-"+e.type,e.type),e.show&&$("#segment-"+e.type).modal("show"),$("#segment-"+e.type).on("shown.bs.modal",function(){loadHtml("obti-"+e.type,ComboBoxSources.getRecords(e.type))})}):e.show&&$("#segment-"+e.type).modal("show")};