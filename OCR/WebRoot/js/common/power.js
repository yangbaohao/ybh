!function(){var e=function(e,t,r,a,s,n){var i=this;i.json=$.extend(!0,{},e),i.json.createBy=[i.json.createBy,","+i.json.createBy+","+i.json.privilege+_global_settings.owner.admin],i.nodelist=$.extend(!0,{},t),i.pk=r,i.hadSon=a,i.dataStatus=s,i.boss=n,i.bizStatus=this.json.bizStatus,i.bpmnStatus=this.json.bpmnStatus,i.payStatus=this.json.payStatus,i.orderStatus=this.json.orderStatus,i.deliveryStatus=this.json.deliveryStatus,i.returnStatus=this.json.returnStatus},t=function(e,t,r){var e=e,a=_global_settings.owner.username;return!r&&(!("true"==_global_settings.owner.dataFlag&&_global_settings.owner.dataFunctions.indexOf(t)>-1&&e[1].toString().indexOf(a)>-1)&&a!=e[0])};e.prototype.createby=function(e){var r=this.json.createBy,a=this.dataStatus,s=t(r,a);for(var n in e)s&&$("#"+e[n]).remove()},e.prototype.bpmn=function(e,r){var a=this.bpmnStatus;if(null==a)return!0;var s=this.hadSon,n=this.json.createBy,i=this.dataStatus,o=this.boss,l=!0;for(var u in e)""==e[u]&&(e[u]=(new Date).getTime()+Math.random()),"付款"!=u&&"收款"!=u||"COMPLETE"!=a&&"NOAPPROVE"!=a&&$("#"+e[u]).remove(),"收货"!=u&&"送货"!=u||"COMPLETE"!=a&&"NOAPPROVE"!=a&&(l=!1,$("#"+e[u]).remove()),"生成销售单"==u&&"COMPLETE"!=a&&"NOAPPROVE"!=a&&(l=!1,$("#"+e[u]).css("display","none")),"作废"==u&&("PRE"!=a&&"REJECT"!=a&&null!=a||t(n,i,o))&&(0==s&&"NOAPPROVE"!=a&&"COMPLETE"!=a?(l=!1,$("#"+e[u]).remove()):0!=s&&(l=!1,$("#"+e[u]).remove())),"初次提交"==u&&("PRE"!=a||t(n,i,o))&&(l=!1,$("#"+e[u]).remove()),"再次提交"==u&&("REJECT"!=a||t(n,i,o))&&(l=!1,$("#"+e[u]).remove()),"编辑"!=u&&"保存"!=u&&"提交"!=u||("PRE"!=a&&"NOAPPROVE"!=a&&"REJECT"!=a||t(n,i,o))&&(l=!1,$("#"+e[u]).remove()),"Bpmn_bx"!=r&&"Bpmn_kx"!=r?"审批"==u&&(l=!1,$("#"+e[u]).remove()):"审批"==u&&"RUNNING"!=a&&"START"!=a&&(l=!1,$("#"+e[u]).remove());try{delete $.pk.Bpmn}catch(e){}return l},e.prototype.biz=function(e){var r=this.bizStatus,a=this.json.createBy,s=this.hadSon;if(null==r)return!0;var n=e,i=this.dataStatus,o=this.boss;for(var l in n)"编辑"==l&&"normal"!=r&&null!=r&&(!1,$("#"+n[l]).remove()),"作废"==l&&("canceled"==r&&$("#"+n[l]).replaceWith('<span class="btn btn-success float-right mg10">已作废</span>'),(0!=s&&"normal"!=r||t(a,i,o))&&(!1,$("#"+n[l]).remove())),"初次提交"!=l&&"再次提交"!=l||"canceled"==r&&(!1,$("#"+n[l]).remove());return!0},e.prototype.pay=function(e){var r=this.payStatus,a=this.json.createBy;if(null==r)return!0;var s=e,n=this.dataStatus,i=this.boss;for(var o in s)"编辑"!=o&&"作废"!=o||"paid"==r&&(!1,$("#"+s[o]).remove()),"作废"==o&&t(a,n,i)&&$("#"+s[o]).remove();return!0},e.prototype.order=function(e){var r=this.orderStatus,a=this.json.createBy;if(null==r)return!0;var s=e,n=this.dataStatus,i=this.boss,o=!0;for(var l in s)""==s[l]&&(s[l]=(new Date).getTime()+Math.random()),"送货"!=l&&"收货"!=l||"undelivered"!=r&&"partialdelivered"!=r&&"notCreatedSalesOrder"!=r&&"unreceived"!=r&&"partialreceived"!=r&&"allreceived"!=r&&"running"!=r&&null!=r&&("alldelivered"==r||"allreceived"==r||"closedOrder"==r||$("#"+s[l]).remove()),"送货"!=l&&"收货"!=l||"canceled"==r&&(o=!1),"收款"!=l&&"付款"!=l||"canceled"==r&&$("#"+s[l]).remove(),"编辑"!=l&&"作废"!=l&&"保存"!=l||("作废"==l&&"canceled"==r&&$("#"+s[l]).replaceWith('<span class="btn btn-success float-right mg10">已作废</span>'),"undelivered"!=r&&"unreceived"!=r&&"notCreatedSalesOrder"!=r&&"running"!=r&&null!=r&&$("#"+s[l]).remove()),"作废"==l&&t(a,n,i)&&$("#"+s[l]).remove(),"关闭"==l&&("closedOrder"==r&&$("#"+s[l]).replaceWith('<span class="btn btn-success float-right mg10">已关闭</span>'),("partialdelivered"!=r&&"partialreceived"!=r&&null!=r||t(a,n))&&$("#"+s[l]).remove()),"生成销售单"==l&&("createdSalesOrder"==r&&$("#"+s[l]).replaceWith('<span class="btn btn-success float-right mg10">已生成销售单</span>'),("notCreatedSalesOrder"!=r&&"running"!=r||t(a,n))&&(o=!1,$("#"+s[l]).remove())),"初次提交"!=l&&"再次提交"!=l||"canceled"==r&&$("#"+s[l]).remove();return o},e.prototype.delivery=function(e){var t=this.deliveryStatus;if(null==t)return!0;var r=e;this.dataStatus,this.boss;for(var a in r)"退货"==a&&"delivered"!=t&&"received"!=t&&"partialReturn"!=t&&null!=t&&(!1,$("#"+r[a]).remove());return!0},e.prototype._return=function(e){var r=this.returnStatus,a=this.json.createBy,s=this.dataStatus,n=this.boss;if(null==r)return!0;var i=e;for(var o in i)"编辑"==o&&"notreceived"!=r&&null!=r&&(!1,$("#"+i[o]).remove()),"作废"==o&&("canceled"==r&&$("#"+i[o]).replaceWith('<span class="btn btn-success float-right mg10">已作废</span>'),t(a,s,n)&&(!1,$("#"+i[o]).remove())),"初次提交"!=o&&"再次提交"!=o||"canceled"!=r&&"received"!=r||(!1,$("#"+i[o]).remove());return!0},e.prototype.init=function(){var e=this.nodelist,t=this.pk,r=!0;for(var a in e)switch(a){case"bpmnStatus":this.bpmn(e[a],t)||(r=!1);break;case"bizStatus":this.biz(e[a])||(r=!1);break;case"payStatus":this.pay(e[a])||(r=!1);break;case"orderStatus":this.order(e[a])||(r=!1);break;case"deliveryStatus":this.delivery(e[a])||(r=!1);break;case"returnStatus":this._return(e[a])||(r=!1);break;case"createby":this.createby(e[a])||(r=!1)}return r},window.powerStatus=e}();