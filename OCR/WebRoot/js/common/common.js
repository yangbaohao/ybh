function getCurrencyArray(){return[["zh_CN","Cn"],["en_US","En"],["ja_JP","Jp"]]}function initCurCode(e){for(var t=getCurrencyArray(),n=0;n<t.length;n++)if(t[n][0].toUpperCase()==e.toUpperCase())return void(currentCode=t[n][1])}function enterSubmit(e,t){$(e).keydown(function(e){13==e.keyCode&&$(t).click()})}function setCloseAlertTimeOneSecond(e){var e=void 0==e?"1000":e;Core.alert({message:"操作成功",hide:e})}function formatNum(e){var t="";(e=money(e))<0&&(t=e.substring(0,1),e=e.substring(1));for(var n="",o=0,a=e.indexOf(".")-1;a>=0;a--)n=o%3==0&&0!=o?e.charAt(a)+","+n:e.charAt(a)+n,o++;return e=n+(e+"00").substr((e+"00").indexOf("."),3),t+e}function getHostName(){return window.location.hostname}function setCurrentUrl(){var e=getHostName();return e="localhost"==e||"192.168.1.3"==e?"http://192.168.1.3:8090/SimpleBss/":e.indexOf(".cn")>-1?"http://xsbss.ydcfo.net.cn/":"http://xsbss.ydcfo.com/"}function getNowFormatDate(e){var t=new Date,n=t.getMonth()+1,o=t.getDate();if(o>=0&&o<=9&&(o="0"+o),1==e)var a=t.getMinutes(),r=t.getSeconds();n>=1&&n<=9&&(n="0"+n);var i=t.getFullYear()+"-"+n+"-"+o;return 1==e&&(i=t.getFullYear()+"-"+n+"-"+o+" "+t.getHours()+":"+a+":"+r),i}function getChangeDate(e,t){var n=e.split("-"),o=n[0],a=n[1],r=n[2],i=new Date(o,a,0);i=i.getDate();var l=o,s=parseInt(a)+Number(t);s>12&&(l=parseInt(l)+1,s=Number(s-12)),s<0&&(l=parseInt(l)-1,s=12+s);var d=r,c=new Date(l,s,0);return c=c.getDate(),d>c&&(d=c),s<10&&(s="0"+s),l+"-"+s+"-"+d}function logout(){window.onbeforeunload=function(e){},$.post("logout",function(e){$("body").html("").css("background-color","#EAEBEC"),$(e).appendTo($("body"))})}function hiddenAclick(){$(".hidden-aclick").on("click",function(){$(this).parent().slideUp("slow"),$.visibleDoFunc($(".hiddendiv"),function(e){})})}function loadBundles(e){$.i18n.properties({name:"message",path:ws_url+"/js/common/resources/i18n/",mode:"map",language:e,cache:!0,callback:function(){}})}function ReadCookie(e){var t="",n=e+"=";return document.cookie.length>0&&(offset=document.cookie.indexOf(n),-1!=offset&&(offset+=n.length,end=document.cookie.indexOf(";",offset),-1==end&&(end=document.cookie.length),t=unescape(document.cookie.substring(offset,end)))),t}function SetCookie(e,t,n){var o="",a="",r=new Date((new Date).getTime());r="; expires="+r.toGMTString();var i="xxxxx.com";window.location.href.indexOf("localhost")>0&&(i="localhost"),null!=n&&(o=new Date((new Date).getTime()+36e5*n),o="; expires="+o.toGMTString(),a=new Date((new Date).getTime()+2592e6),a="; expires="+a.toGMTString(),expireNextID_sem=new Date((new Date).getTime()+2592e6),expireNextID_sem="; expires="+expireNextID_sem.toGMTString()),document.cookie=e+"="+escape(t)+o+";domain="+i+"; path=/"}function loadPayList(e){for(var t="",n=[],o=null,a=e.accountProducts,r=0;r<a.length;r++)0==r?(o=a[r].id,n.push(a[r])):o!=a[r].id&&(o=a[r].id,n.push(a[r]));var i=e.orderCreateDate.substring(0,10),l=e.orderEndDate.substring(0,10),s=n.length,d="col-md-6";1==s&&(d="col-md-12");var c;for(c=0;c<s;c++){t+='<div class="'+d+'" style="padding:0 10px;margin:20px 0 0;"><div class="row row-vp"><div class="paybox"><p class="hight120"><label for="payOrder_box5_2">'+n[c].productName+":</label>"+n[c].description+'</p><p class="txtr"></b></p><p class="txtr">充值时间：<span>'+i+"</span>—到期时间：<span>"+l+"</span></p></div></div></div>"}return t}function loadmyAccountList(e,t,n){var o,a="",r=e.length;for(o=0;o<r;o++){var i=e[o].amount,l=e[o].startTime.substring(0,10),s=e[o].endTime.substring(0,10),d=e[o].available,c=e[o].overdue,u=e[o].id,p=e[o].voucherCode,m="",f=null,v=null;"all"==e[o].type?(f="vip专用",v="使用条件：最大抵扣订单总额的100%，超过订单总额100%的金额作废"):(f="秒账专用",v="使用条件：最大抵扣订单总额的50%，超过订单总额50%的金额作废"),1==d&&(m="未使用"),0==d&&(m="已使用"),1==c&&(m="已过期"),a+=t?n?'<div class="col-sm-4"><div class="col-sm-12 myAccount pointer"><input type="checkbox" checked=true class="myAccountListCheck" data-id="'+u+'" data-voucherCode="'+p+'" style="position: absolute;" ><span class="hide">'+JSON.stringify(e[o])+'</span><table width="100%"><tbody class="myAccountBody"><tr><td rowspan=3 colspan=2 class="myAccountPrice">￥<span>'+i+'</span></td><td rowspan=1 colspan=1></td></tr><tr><td rowspan=1 colspan=1 class="myAccountTitle">'+f+'</td></tr><tr><td rowspan=1 colspan=1></td></tr><tr><td colspan=3 class="myAccountTime">'+v+'</td></tr><tr><td colspan=3 class="myAccountTime">有效时间：'+l+"至"+s+'<span class="myAccountAllow">'+m+"</span></td></tr></tbody></table></div></div>":'<div class="col-sm-4"><div class="col-sm-12 myAccount pointer"><input type="checkbox" class="myAccountListCheck" data-id="'+u+'" data-voucherCode="'+p+'" style="position: absolute;" ><span class="hide">'+JSON.stringify(e[o])+'</span><table width="100%"><tbody class="myAccountBody"><tr><td rowspan=3 colspan=2 class="myAccountPrice">￥<span>'+i+'</span></td><td rowspan=1 colspan=1></td></tr><tr><td rowspan=1 colspan=1 class="myAccountTitle">'+f+'</td></tr><tr><td rowspan=1 colspan=1></td></tr><tr><td colspan=3 class="myAccountTime">'+v+'</td></tr><tr><td colspan=3 class="myAccountTime">有效时间：'+l+"至"+s+'<span class="myAccountAllow">'+m+"</span></td></tr></tbody></table></div></div>":'<div class="col-sm-4"><div class="col-sm-12 myAccount"><table width="100%"><tbody class="myAccountBody"><tr><td rowspan=3 colspan=2 class="myAccountPrice">￥<span>'+i+'</span></td><td rowspan=1 colspan=1></td></tr><tr><td rowspan=1 colspan=1 class="myAccountTitle">'+f+'</td></tr><tr><td rowspan=1 colspan=1></td></tr><tr><td colspan=3 class="myAccountTime">'+v+'</td></tr><tr><td colspan=3 class="myAccountTime">有效时间：'+l+"至"+s+'<span class="myAccountAllow">'+m+"</span></td></tr></tbody></table></div></div>"}return a}function codeRender(e,t,n,o,a,r){return'<div style="overflow: hidden; text-overflow: ellipsis; padding-bottom: 2px; text-align: left; margin-right: 2px; margin-left: 4px; margin-top: 6px;">'+getCodeData(n)+"</div>"}function getCodeData(e){return void 0===e?"":null===e?"-":null!==codeData?void 0===codeData[e]?"":null===codeData[e]?"-":codeData[e]:(codeData=new Object,void Core.AjaxRequest({showMsg:!1,async:!0,cache:!0,type:"GET",url:ws_url+"/CXF/rs/code/dict",callback:function(t){return codeData=t,void 0===codeData[e]?"":null===codeData[e]?"-":codeData[e]},failure:function(e){}}))}function getListColumnByCode(e,t){for(var n="",o=0;o<e.length;o++)if(e[o].codeValue==t){n=e[o].codeDisplay;break}return n}function getUrlParam(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}function getHMS(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}function JournalDetailTableCheckNum(){isCheckEd=!1;var e=2===arguments.length?arguments[1].value:arguments[0];return isNaN(e)?($(this).focus(),$(this).css("border","solid 2px red"),isCheckEd=!1,!1):($(this).css("border",""),isCheckEd=!0,!0)}function setValueById(e,t,n){var o=new Date,a=o.getFullYear(),r=parseInt(o.getMonth())+1,i=o.getDate(),l=o.getHours(),s=o.getMinutes(),d=o.getSeconds(),c=o.getTime(),u=$("#"+n).val();""!=u?c=new Date(u).getTime():u=o;var p=null,m=parseInt($("#"+e).val());switch($("#"+n).off("change").on("change",function(){var n=$(this).val();switch(a=n.substring(0,4),r=n.substring(5,7),i=n.substring(8,10),l=n.substring(11,13),s=n.substring(14,16),d=n.substring(17,19),c=new Date(n).getTime(),m=parseInt($("#"+e).val())){case 0:$("#"+t).val("");break;case 1:p=c-6048e5,$("#"+t).val(new Date(p));break;case 2:p=c-12096e5,$("#"+t).val(new Date(p));break;case 3:p=c-18144e5,$("#"+t).val(new Date(p));break;case 4:p=c-24*(i-1)*3600*1e3,$("#"+t).val(new Date(p));break;case 5:1!=r&&2!=r&&3!=r||(r="01"),4!=r&&5!=r&&6!=r||(r="04"),7!=r&&8!=r&&9!=r||(r="07"),10!=r&&11!=r&&12!=r||(r=10),i=i<10?"0"+i:i,$("#"+t).val(a+"-"+r+"-01 "+l+":"+s+":"+d);break;case 6:i=i<10?"0"+i:i,$("#"+t).val(a+"-01-01 "+l+":"+s+":"+d)}}),m){case 0:$("#"+t).val(""),$("#"+n).val(u);break;case 1:p=c-6048e5,$("#"+t).val(new Date(p)),$("#"+n).val(u);break;case 2:p=c-12096e5,$("#"+t).val(new Date(p)),$("#"+n).val(u);break;case 3:p=c-18144e5,$("#"+t).val(new Date(p)),$("#"+n).val(u);break;case 4:p=c-24*(i-1)*3600*1e3,$("#"+t).val(new Date(p)),$("#"+n).val(u);break;case 5:var f=null;1!=r&&2!=r&&3!=r||(f="01"),4!=r&&5!=r&&6!=r||(f="04"),7!=r&&8!=r&&9!=r||(f="07"),10!=r&&11!=r&&12!=r||(f=10),i=i<10?"0"+i:i,$("#"+t).val(a+"-"+f+"-01 "+l+":"+s+":"+d),$("#"+n).val(u);break;case 6:i=i<10?"0"+i:i,$("#"+t).val(a+"-01-01 "+l+":"+s+":"+d),$("#"+n).val(u)}}function money(e,t,n,o){if(void 0==e||""===e)return n?"0":"0.00";var o=void 0!=o,t=null==t?2:t;if(e=e.toString(),e.indexOf("*")>-1&&!o){for(var a=e.split("*"),r=0;r<a.length;r++)a[r]=arguments.callee(a[r],4,!0);return a.join("*")}var i="0.";if(e.indexOf(".")>-1){var l=e.substr(e.indexOf(".")).length-1;if(l>t){for(var s=0;s<l;s++)i+="0";i+="1"}}var r=parseFloat(e)+parseFloat(i),d=r.toFixed(t);if(n){if(0==d)return"0";if(d<1e-6){var c=d;return""==c?0:c}var c=parseFloat(d);return 0==isNaN(c)?c:0}return 0==d||isNaN(d)?"0.00":d}function clearString(e){for(var t=void 0===e?"":e.toString(),n=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）&;|{}【】‘；：”“'。，、？]"),o="",a=0;a<t.length;a++)o+=t.substr(a,1).replace(n," ");return o}function searchDataInfo(e){var t=void 0===e?me.settings.grid.element:e;$("#"+t).jqxGrid("applyfilters"),$("#"+t).jqxGrid("refreshfilterrow"),$("#"+t).jqxGrid("clearselection")}function refreshDataInfo(e){var t=void 0===e?me.settings.grid.element:e;$("#"+t).jqxGrid("updatebounddata","cells"),$("#"+t).jqxGrid("clearselection"),$("#"+t).jqxGrid("refreshdata")}function showSpec(e){var t=_global_settings.owner.productSpeFlag;t&&"false"!=t||$("#"+e).css("display","none")}function initModel(e){var t=e.id||"",n=e.val||"",o=e.name||"",a=e.ownerId||"",r=e.userName||"",i=function(e,i){$("#custVenName").text(o),Core.AjaxRequest({type:"GET",showMsg:!1,async:!1,url:ws_url+"/CXF/rs/SimpleAC/"+(new Base64).encode("toocr/order/clientinfo/search/clientinfo/id/"+n+"/"+a+"/"+r),callback:function(e){$("#custAndVen-id").data("json",e),$("#custAndVenName").val(e.userInfo.name),$("#custAndVenPhone").val(void 0==e.userInfo.telephone?"":e.userInfo.telephone),$("#custAndVenPhone2").val(void 0==e.userInfo.backupTelephone?"":data.backupTelephone)}}),$("#editCustAndVen").modal("show"),$(".editCustAndVendor").off("click").on("click",function(){o.indexOf("客户")>-1?$.addTab({title:"编辑客户",url:"page/modules/crm/editCustomerClientMgt.html",pk:{id:t,junpnode:i,customerName:$("#custAndVenName").val(),phone:$("#custAndVenPhone").val(),phone2:$("#custAndVenPhone2").val()},reload:!0}):$.addTab({title:"编辑供应商",url:"page/modules/crm/editVendorClientMgt.html",pk:{id:t,junpnode:i,customerName:$("#custAndVenName").val(),phone:$("#custAndVenPhone").val(),phone2:$("#custAndVenPhone2").val()},reload:!0})})};0==$("#editCustAndVen").length?$.loadModal("page/common/segment/custAndVen.html",function(e){var t=$(e);$("body").append(t),i(0,n),$("#editCustAndVen").jqxValidator({animationDuration:1,hintType:"label",rules:[{input:"#custAndVenName",message:"不能为空",action:"keyup, blur",rule:"required"}]})}):i(0,n)}function editCustAndVendor(e,t,n){var o="请选择供应商！",a="供应商名称";e.indexOf("SO")>-1&&(o="请选择客户！",a="客户名称");var r=$("#"+e).val();if(""==r)return Core.alert({message:o}),!1;initModel({id:e,val:r,name:a,ownerId:t,userName:n})}function getPriseInfo(e){var t=e.id||"",n=e.soOwnerId||"",o=e.userName||"",a=e.callback||function(){},r=null;Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/enterpriseInfo/"+n+"/"+o),type:"GET",callback:function(e,t){if("success"==t)try{var n=e[0],o={},i={producttypeFlag:"remark",productKgFlag:"weight",productNumberFlag:"sku",productCoLorFlag:"color",productSpeFlag:"spec",productImageFlag:"photoId"};for(var l in i)void 0!=n[l]&&"false"==n[l].toString()&&(o[i[l]]=!1);_global_settings.acOwner=n,_global_settings.owner.easyGridSetting=o,r=void 0==e[0].enterpriseInfo.address[0]?"":e[0].enterpriseInfo.address[0],a(e)}catch(e){}else Core.alert({message:"204系统错误"})},failure:function(e){var t=JSON.parse(e.responseText);Core.alert({message:t.errorMsg})}});var i="请选择",l="请选择",s="请选择";null!=r&&(i=r.province,l=r.city,s=r.district),new address(t,"form-control").init(i,l,s)}function viewOtherPay(e){var t=e.otherPayId,n=e.windowId,o=e.inputId,a=void 0==e.otherAmtdesc?"":e.otherAmtdesc;$(t).on("click",function(){var e=window.innerWidth-17+"px",t=$(document).height()+"px";$(n).css({width:e,height:t,display:""}),r()});var r=function(){if(""==a){var e='<div class="col-md-12 text-center"><div class="form-horizontal"><div class="form-group"><span style="font-size:18px">您没有选择非产品费用类别哦</span></div></div></div>';$(o).append(e)}else for(var t=a.split("||"),n=t.length,r=0;r<n;r++){var e='<div class="col-md-4"><div class="form-horizontal"><div class="form-group"><ul><li><input type="checkbox" checked disabled class="m-t-10"><span class="otherlabel m-l-5">'+t[r]+"</span></li></ul></div></div></div>";$(o).append(e)}};$(n).find(".cancleViewPay").on("click",function(){i()});var i=function(){$(n).css("display","none"),$(o).children().remove()}}function initOther(e,n,o,a,r){Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/ownerOtherAmt/"+a+"/"+r),type:"GET",callback:function(e){for(var t=n.split("||"),o=[],a=0;a<t.length;a++)o.push({typeValue:t[a]});i(o)},failure:function(e){}});var i=function(e){$.each(e,function(t){var n=e[t].orderFlag,o=e[t].flag,a="";a=n?o?'<span class="otherlabel m-l-5">'+e[t].typeValue+'<i class="md-edit hoverspan editOtherpay"></i></span>':'<span class="otherlabel m-l-5">'+e[t].typeValue+"</span>":'<span class="otherlabel m-l-5">'+e[t].typeValue+'<i class="md-edit hoverspan editOtherpay"></i></span>';var r='<div class="col-md-4"><div class="form-horizontal"><div class="form-group"><ul><li><input type="checkbox" data-id="'+e[t].id+'" class="m-t-10">'+a+"</li></ul></div></div></div>";$("#otherPayInput").append(r)});if($("#otherPayInput").append('<div class="col-md-4"><div class="form-horizontal"><div class="form-group"><ul><li><img src="images/common/detailimg/orderadd.png" title="新增非产品费用" alt="新增非产品费用"></li></ul></div></div></div>'),""!=n)for(var o=n.split("||"),a=o.length,r=$("#otherPayInput").find("span"),i=0;i<a;i++)$.each(r,function(){if(t=$(this),t.text()==o[i])return $(this).parent().find("input")[0].checked=!0,!1})}}function otherPay(e){var t=e.inputId,n=e.labelId,o=e.showId,a=e.otherDesc,r=void 0!=e.view&&e.view,i=e.res,l=e.mgt,s=e.ownerId,d=e.name,c=function(){if($("#otherPayModal").modal("show"),$("#otherPayInput").html(""),r)return $("#otherPayModal").find("span").text("非产品费用"),$("#saveOtherPay").hide(),void f();$("#otherPayModal").find("span").text("请选择"),$("#saveOtherPay").show(),t.indexOf("edit")>-1?initOther(!0,a,i,s,d):initOther(!1,a,null,s,d),timeOut(function(){p()},100),$("#otherPayInput").off("click").on("click",".editOtherpay",function(){var e=$(this).parent(),t=e.parent(),n=e.text(),o='<input type="text" class="form-control editOther float-right" value="'+n+'" data-blacklist=" "  style="width:87%">';e.remove(),t.append(o),u()}),$("#saveOtherPay").off("click").on("click",function(){if($("#otherPayInput").find(".s1r").length>0)return Core.alert({message:"编辑的非产品费用不能为空！"}),!1;a="";var e=[],n=[],r=$("#otherPayInput").find("input[type=checkbox]");if($.each(r,function(t){var o={},r=$(this)[0].checked,i=$(this).data("id"),l=$(this).parent(),s=l.children().eq(1).text();""==s&&(s=l.children().eq(1).val()),r&&""!=s&&(a+=s+"||",void 0==i?o.typeValue=s:(o.id=i,o.typeValue=s),n.push(o)),""!=s&&(void 0==i?o.typeValue=s:(o.id=i,o.typeValue=s),e.push(o))}),a=a.substring(0,a.length-2),l.otherAmtdesc=a,l.otherAmts=n,m(e))return Core.alert({message:"非产品费用不能重复！"}),!1;0==n.length||($(t)[0].checked=!0,$(o).parent().css("display",""))})};$(n).on("click",function(){0==$("#otherPayModal").length?$.loadModal("page/common/segment/otherPay.html",function(e){var t=$(e);$("body").append(t),c()}):c()}),$(t).on("change",function(){if(!$(this)[0].checked)return $(o).parent().css("display","none"),void $(o).val("0.00");$(o).parent().css("display",""),0==$("#otherPayModal").length?$.loadModal("page/common/segment/otherPay.html",function(e){var t=$(e);$("body").append(t),c()}):c()});var u=function(){$(".editOther").on("change keyup",function(){$.each($(".editOther"),function(){""==$(this).val().trim()?$(this).addClass("s1r"):$(this).removeClass("s1r")})})},p=function(){$("#otherPayInput").find("img").on("click",function(){$(this).parents(".col-md-4").before($('<div class="col-md-4"><div class="form-horizontal"><div class="form-group"><ul><li><input class="m-t-10" type="checkbox"><input type="text" class="addinput form-control float-right" data-blacklist=" " style="width:87%" placeholder="添加"></li></ul></div></div></div>')),$("#otherPayInput").find(".addinput:last")[0].focus()})},m=function(e){var t=[];for(o=0;o<e.length;o++)t.push(e[o].typeValue);var n={};for(var o in t){if(n[t[o]])return!0;n[t[o]]=!0}return!1},f=function(){if(""==a){var e='<div class="col-md-12 text-center"><div class="form-horizontal"><div class="form-group"><span style="font-size:18px">您没有选择非产品费用类别哦</span></div></div></div>';$(t).append(e)}else for(var n=a.split("||"),o=n.length,r=0;r<o;r++){var e='<div class="col-md-4"><div class="form-horizontal"><div class="form-group"><ul><li><input type="checkbox" checked disabled class="m-t-10"><span class="otherlabel m-l-5">'+n[r]+"</span></li></ul></div></div></div>";$(t).append(e)}}}function closeModel(){$(".btn-r").on("click",function(){var e=$(this).parent().parent().parent().parent().parent().find(".modal-body");setAddress(e,e.find(".addRessTableSelect").attr("id"))}),$(".cancleBtn").on("click",function(){var e=$(this).parent().parent();setAddress(e,e.find(".addRessTableSelect").attr("id"))})}function setAddress(e,t){var n="请选择",o="请选择",a="请选择";e.find("input").val(""),new address(t,"form-control").init(n,o,a),e.find("textarea").val("")}function showAddress(e,t,n){$(".addSomeBtn").on("click",function(){var o=e.indexOf("Ven")>-1?"供应商":"客户",a=$("#"+e).val(),r="抱歉，请先去选择"+o+"，再新增地址";if(""==a)return Core.alert({message:r}),!1;chooseAddress(t,n)})}function dragImg(e){var e=document.getElementById(e);e.onmousedown=function(t){var t=t||event,n=t.clientX-this.offsetLeft,o=t.clientY-this.offsetTop;return e.setCapture&&e.setCapture(),document.onmousemove=function(t){var t=t||event;e.style.left=t.clientX-n+"px",e.style.top=t.clientY-o+"px"},document.onmouseup=function(){document.onmousemove=null,e.releaseCapture&&e.releaseCapture()},!1}}function biggerImg(e){function t(t){var t=window.event||t,n=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));return e.style.width=Math.max(50,Math.min(800,e.width+30*n))+"px",!1}var e=document.getElementById(e);e.addEventListener?(e.addEventListener("mousewheel",t,!1),e.addEventListener("DOMMouseScroll",t,!1)):e.attachEvent("onmousewheel",t)}function addEvent(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function removeEvent(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function prEvent(e){var t=e||window.event;return t.preventDefault&&t.preventDefault(),t}function addWheelEvent(e,t){function n(e){var n=prEvent(e),o=n.detail?n.detail>0:n.wheelDelta<0;return t&&t.call(n,o),!1}-1!=window.navigator.userAgent.toLowerCase().indexOf("firefox")?addEvent(e,"DOMMouseScroll",n):addEvent(e,"mousewheel",n)}function isImgLoad(e,t){var t=null==t?"img":t;$(t).each(function(){if(1!=$(this)[0].complete)return isLoad=!1,!1}),isLoad?(clearTimeout(t_img),e()):(isLoad=!0,t_img=setTimeout(function(){isImgLoad(e)},500))}function removeArrayByIndex(e,t){if(t>e.length-1||t<0)return!1;for(var n=[],o=0;o<e.length;o++)o!=t&&n.push(e[o]);e.length=0;for(var o=0;o<n.length;o++)e[o]=n[o];return e}var currentUser,currentTheme="account",currentCulture="zh_CN",gridPageSize=20,pagesizeoptions=["10","20","50","100"],SiteName="59.151.26.11",language=["zh_CN","en_US","ja_JP"],portalIndex="/Front",platformIndex="/Front",currentCode="CN",permission="",clickUserbNumber=0,codeData=null,version_js="2017-04-25_v1",version_html="2017-04-25_v1";initCurCode(currentlang),$.visibleDoFunc=function(e,t){var n=e;$.each(n,function(){var e=$(this);e.is(":visible")&&t(e)})},$.loadModal=function(e,t){$("<div></div>").load(e+"?v="+version_html,function(e){$.timeOutCookie(e),t(e)})},$.timeOutCookie=function(e){if(e.indexOf("logInForMobile=OK")>-1)throw $("body").find("#cover_div").remove(),Core.alert({avaiable:!1,message:"缓存失效，请重新登录",callback:logout,hide:!1}),"Cookie is die"},$.openHref=function(e){var e=e,t='<a target="_blank" href="'+e+'"></a>';if(document.all)$(t)[0].click();else{var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),$(t)[0].dispatchEvent(n)}},$.checkArr=function(e){var t=[];for(a=0;a<e.length;a++)t.push(e[a].descr);var n=[],o={};for(var a in t)o[t[a]]||(o[t[a]]=!0,n.push(t[a]));return n},$.strInArr=function(e,t){for(var n=0;n<t.length;n++)if(0==e.toString().indexOf(t[n].toString()))return!0;return!1},$.strEqArr=function(e,t){for(var n=0;n<t.length;n++)if(e.toString()===t[n].toString())return!0;return!1},$.addHide=function(){for(var e=arguments.length,t=0;t<e;t++)$(arguments[t]).addClass("hide")},$.removeHide=function(){for(var e=arguments.length,t=0;t<e;t++)$(arguments[t]).removeClass("hide")};var gridLocalizationObj={pagergotopagestring:"当前页:",pagershowrowsstring:"每页显示:",pagerrangestring:" 共 ",pagernextbuttonstring:"下一页",pagerpreviousbuttonstring:"上一页",sortascendingstring:"正序",sortdescendingstring:"倒序",sortremovestring:"清除排序",firstDay:1,percentsymbol:"%",currencysymbol:"￥",currencysymbolposition:"before",decimalseparator:".",thousandsseparator:",",emptydatastring:"暂无数据",loadtext:"加载中...",days:{names:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],namesAbbr:["周日","周一","周二","周三","周四","周五","周六"],namesShort:["周日","周一","周二","周三","周四","周五","周六"]},months:{names:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],namesAbbr:["1","2","3","4","5","6","7","8","9","10","11","12",""]}};getCodeData("test");var ComboBoxSource=function(e){var t=this;this.url=e,this.source={datatype:"json",type:"GET",url:t.url},this.dataAdapter=null,this.init=function(){t.dataAdapter=new $.jqx.dataAdapter(t.source,{autoBind:!1,beforeLoadComplete:function(){return t.dataAdapter.recordids}})},this.refresh=function(e){e&&(t.source.async=!1),t.dataAdapter.dataBind()}},company=function(){Core.AjaxRequest({url:_global_settings.service.url+"/common/ownerinformation",type:"GET",showMsg:!1,callback:function(e){_global_settings.owner=e,_global_settings.owner.productunitFlag="false";getCurrentInfo();if(ComboBoxSources.map.userInfo=new ComboBoxSource(ws_url+"/CXF/rs/user/information/"+e.roleName),ComboBoxSources.init(),$("#index-companyname").text(_global_settings.owner.companyname),$("#index-username").text(_global_settings.owner.username),null!=localStorage.map&&localStorage.owner==_global_settings.owner.username){for(var t=JSON.parse(localStorage.map),n=localStorage.index,o=t.length,a=0;a<o;a++)!function(e,t){var n=e.title,o=(e.url,e.pk);e.localStorage=!0,e.read=!1,$.addTab({title:n,url:"",pk:o,map:e})}(t[a]);timeOut(function(){delete localStorage.map,delete localStorage.index,$("#zqw_tabs").find("a").eq(n).trigger("click")},50)}else $.addTab({title:"总览",url:"page/modules/home.html",reload:!0})},failure:function(){}})},ComboBoxSources={map:{taxManage:new ComboBoxSource(ws_url+"/CXF/rs/user/taxManage"),users:new ComboBoxSource(ws_url+"/CXF/rs/owner/userlist"),role:new ComboBoxSource(ws_url+"/CXF/rs/role/for/search"),allUsername:new ComboBoxSource(ws_url+"/CXF/rs/overview/searchUserName"),username:{init:function(){var e=ComboBoxSources.getRecords("allUsername"),t=[];for(var n in e[0])t.push({name:n});return t},refresh:function(e){},dataAdapter:{records:function(){return ComboBoxSources.map.username.init()}}},company:{init:function(){var e=ComboBoxSources.getRecords("allUsername"),t=[],n=e[0];for(var o in n)t.push({company:n[o]});return t},refresh:function(e){},dataAdapter:{records:function(){return ComboBoxSources.map.company.init()}}},getEmployee:new ComboBoxSource(ws_url+"/CXF/rs/overview/getEmployee")},init:function(){$.each(this.map,function(e,t){t.init(),t.refresh()})},loadAll:function(){$.each(this.map,function(e,t){t.refresh()})},getRecords:function(e){return"function"==typeof ComboBoxSources.map[e].dataAdapter.records?ComboBoxSources.map[e].dataAdapter.records():ComboBoxSources.map[e].dataAdapter.records},load:function(e,t){ComboBoxSources.map[e].refresh(t)},getAdapter:function(e){return ComboBoxSources.map[e].dataAdapter},fetchModel:function(e,t,n){var o=function(t){for(var o=ComboBoxSources.getRecords(e),a=0;a<o.length;a++){var r=o[a];if(r[n]==t)return r}return null},a=o(t);return null===a?(ComboBoxSources.load(e),o(t)):a},fetchUserinfo:function(e){return ComboBoxSources.fetchModel("userinfo",e,"id")},fetchClientInfo:function(e){return ComboBoxSources.fetchModel("clientInfo",e,"clientInfoid")},getInfoMapByKey:function(e,t,n){if("string"==typeof e)var o=ComboBoxSources.getRecords(e);else var o=e;if(null==t)return o;for(var a=o.length,r={},i=0;i<a;i++)if(null!=o[i]){r[o[i][t]]={};var l=r[o[i][t]];for(var s in o[i])l[s]=o[i][s]}return null!=t&&null!=n?null==r[n]?{}:r[n]:r},getInfoMapOrderByKey:function(e,t,n){if("string"==typeof e)var o=ComboBoxSources.getRecords(e);else var o=e;if(null==t)return o;for(var a=o.length,r={},i=0;i<a;i++)if(null!=o[i]){var l=o[i][t];l=""==l?"未分类":l,l=null==l?"未分类":l,r[l]||(r[l]=[]),r[l].push(o[i])}return null!=t&&null!=n?r[n]:r},getArrSourceOrderByKey:function(e,t,n){var o=e;if(null==e)return null;if(null==t)return o;for(var a=e.length,r={},i=0;i<a;i++){var l=o[i][t];l=""==l?"未分类":l,l=null==l?"未分类":l,r[l]||(r[l]=[]),r[l].push(o[i])}return null!=t&&null!=n?r[n]:r}};$.fn.extend({comboBoxType:function(e){var t={placeHolder:"请选择",displayMember:"typeValue",valueMember:"typeValue",searchMode:"containsignorecase",autoComplete:!0,width:"90%",height:"34px"};return e=$.extend(!0,{},t,e),$(this).jqxComboBox(e)},coaCombbox:function(e,t){var n=ComboBoxSources.getRecords("chartOfAccounts");if(void 0===t);else{var o=[];$.each(n,function(e,n){for(var a=n.ref,r=0;r<t.length;r++)0==a.indexOf(t[r])&&o.push(n)}),n=o}var a={theme:currentTheme,searchMode:"containsignorecase",autoComplete:!0,placeHolder:"请输入或选择",source:n,displayMember:"displayValue",valueMember:"id",width:200,height:25};return e=$.extend(!0,{},a,e),$(this).each(function(t,n){var o=$(n);o.jqxComboBox(e);var a=o.jqxComboBox("valueMember");$.each(o.jqxComboBox("source"),function(e,t){0==t.allowInput&&o.jqxComboBox("disableItem",t[a].toString())})})},coaCombboxOne:function(e,t){var n=[],o=ComboBoxSources.getRecords("chartOfAccounts");void 0===t||$.each(o,function(e,o){for(var a=o.ref,r=0;r<t.length;r++)0==a.indexOf(t[r])&&4==a.length&&n.push(o)});var a={theme:currentTheme,searchMode:"contains",placeHolder:"请输入或选择",source:n,displayMember:"displayValue",valueMember:"id",width:200,height:25};return e=$.extend(!0,{},a,e),$(this).each(function(t,n){$(n).jqxComboBox(e)})},coaCombboxTwo:function(e,t){var n=["全部"],o=ComboBoxSources.getRecords("chartOfAccounts");void 0===t||$.each(o,function(e,o){for(var a=o.ref,r=0;r<t.length;r++)0==a.indexOf(t[r])&&6==a.length&&n.push(o)});var a={theme:currentTheme,searchMode:"contains",placeHolder:"请输入或选择",source:n,displayMember:"displayValue",valueMember:"id",width:200,height:25};return e=$.extend(!0,{},a,e),$(this).each(function(t,n){$(n).jqxComboBox(e)})},coaCombboxChoose:function(e,t,n){var o=ComboBoxSources.getRecords("chartOfAccounts");if(n=null==n?[]:n,void 0===t);else{var a=[];$.each(o,function(e,o){for(var r=o.ref,i=0;i<t.length;i++)0!=r.indexOf(t[i])||$.strInArr(r,n)||a.push(o)}),o=a}var r={theme:currentTheme,selectedIndex:0,searchMode:"containsignorecase",autoComplete:!0,placeHolder:"请输入或选择",source:o,displayMember:"name",valueMember:"id",width:200,height:25};return e=$.extend(!0,{},r,e),$(this).each(function(t,n){var o=!0,a=$(n);a.jqxComboBox(e);var r=a.jqxComboBox("valueMember");$.each(a.jqxComboBox("source"),function(e,t){0==t.allowInput||0==t.enabled?a.jqxComboBox("disableItem",t[r].toString()):o&&(""!=t.pid&&4!=t.hardCode.length&&6!=t.hardCode.length&&8!=t.hardCode.length&&10!=t.hardCode.length||a.jqxComboBox("selectedIndex",e),o=!1)})})}}),$.fn.extend({button:function(e){var t={disabled:!1,theme:currentTheme};return e=$.extend(!0,t,e),$(this).jqxButton(e)},grid:function(e){var t={theme:currentTheme,width:"100%",enableellipsis:!0,enabletooltips:!0,columnsresize:!0,pageable:!0,pagesize:gridPageSize,pagesizeoptions:pagesizeoptions,enablebrowserselection:!0,autoheight:!0,sortable:!1,localization:gridLocalizationObj,selectionmode:"singlerow",virtualmode:!0,showtoolbar:!1};return e=$.extend(!0,t,e),$(this).jqxGrid(e)},datatable:function(e){var t={theme:currentTheme,width:"100%",enableBrowserSelection:!0,columnsResize:!0,pageable:!0,pageSize:gridPageSize,pageSizeOptions:pagesizeoptions,sortable:!0,localization:gridLocalizationObj,pagerMode:"advanced",selectionMode:"singlerow",showToolbar:!1};return e=$.extend(!0,t,e),$(this).jqxDataTable(e)},window:function(e){var t={theme:currentTheme,showCollapseButton:!1,resizable:!1,isModal:!0,autoOpen:!1};return e=$.extend(!0,t,e),$(this).jqxWindow(e)},input:function(e){var t={width:150,height:22,minLength:1,theme:currentTheme};return e=$.extend(!0,t,e),$(this).jqxInput(e)},numberinput:function(e){var t={width:150,height:22,theme:currentTheme,inputMode:"simple",spinButtons:!1};return e=$.extend(!0,t,e),$(this).jqxNumberInput(e)},textarea:function(e){var t={width:400,height:100,theme:currentTheme};return e=$.extend(!0,t,e),$(this).jqxInput(e)},dropdown:function(e){var t={selectedIndex:0};return e=$.extend(!0,t,e),$(this).jqxDropDownList(e)},datetimeinput:function(e){var t={width:"100%",height:34,showFooter:!0,todayString:"今天",clearString:"清空",culture:"zh-CN",formatString:"yyyy-MM-dd HH:mm:ss",allowNullDate:!0,value:null,showTimeButton:!0,showCalendarButton:!0};return e=$.extend(!0,{},t,e),$(this).jqxDateTimeInput(e)},datetimeinputs:function(e){var t={width:"100%",height:34,showFooter:!0,todayString:"今天",clearString:"清空",culture:"zh-CN",formatString:"yyyy-MM-dd",allowNullDate:!0,value:null};return e=$.extend(!0,{},t,e),$(this).jqxDateTimeInput(e)},fileuploader:function(e){var t={readonly:!1,filelist:null,ownerId:null,ownerName:null,orderId:null,orderType:null},n=null;n=void 0==e?ctx+"/CXF/rs/SimpleAC/file/"+(new Base64).encode("toocr/order/file/"+ownerId+"/"+ownerName):e.url,e=$.extend(!0,{},t,e);var o=1==e.avision||e.avision;if(1!=e.readonly)return $(this).each(function(t,a){var r="";1==o&&(r='<button id="scanBtn"  class="btn btn-success mg10" style="height:40px;">扫描</button><button id="scanInputBtn"  class="btn btn-success " style="height:40px;">录入数据</button>');var i=$('<div class="col-md-12"><div class="row  row-vp"><div class="float-left"><div id="picker">选择附件</div></div><div class="col-md-5"><button id="ctlBtn" class="btn btn-success mg10" style="height:40px;">开始上传</button>'+r+'</div><div class="col-md-5"><div class="error jqx-validator-error-label" id="errorMsg" style="height:36px;margin-left:50px;font-size:18px;padding-top:10px;"></div></div></div><div class="row  row-vp"><div id="uploader" class="col-md-12 wu-example"><div id="thelist" class="uploader-list"></div></div></div></div>'),l=$(this),s=$(this).attr("id");void 0===s&&(s=""),i.find("*").each(function(e,t){var n=$(this).attr("id");void 0!==n&&$(this).attr("id",s+""+n)}),i.appendTo(l);var d,c=$("#"+s+"thelist"),u=$("#"+s+"ctlBtn"),p="#"+s+"picker",m=$("#"+s+"scanBtn"),f=$("#"+s+"scanInputBtn"),v=($("#"+s+"buttonscan"),$("#"+s+"scan_callback"),"#"+s+"errorMsg"),h="pending";if(null!=e.filelist&&""!=e.filelist){var g="";g=null!=e.orderType?ws_url+"/CXF/rs/common/fileinfos/"+e.filelist:ctx+"/CXF/rs/SimpleAC/"+(new Base64).encode("toocr/order/orderfileinfo/all/sales/"+e.orderId+"/"+e.ownerId+"/"+e.ownerName),Core.AjaxRequest({type:"GET",showMsg:!1,url:g,callback:function(t){$.each(t,function(t,n){
var o=ctx+"/CXF/rs/SimpleAC/down/"+(new Base64).encode("toocr/order/downFile/"+n.id+"/"+e.ownerId+"/"+e.ownerName);c.append('<div data-id="'+n.id+'" id="'+n.id+'" class="item row col-md-12 fileListRow"  style="border-bottom:1px solid #333; padding:5px 0px;"><div class="info col-md-4"><img class="thumbnailImg" style="width:30px;height:30px;" src="'+o+'"><a class="downloadfile01" title="下载" target="_blank" href="'+o+'">'+n.showName+'</a></div><div class="state col-md-4">已上传</div><div class="operate col-md-4"><a class="delFile" href="'+o+'">删除</a></div></div>'),c.find(".operate").find(".delFile").off("click").on({click:function(e){ws_url,n.id;e.preventDefault(),Core.confirm({message:"确定要删除？",confirmCallback:function(){Core.AjaxRequest({url:ws_url+"/CXF/rs/common/file/"+n.id,type:"DELETE",showMsg:!1,callback:function(e){$("#"+n.id).remove()},failure:function(e){}})}})}})})},failure:function(e){}})}else!function(){$.loadScript("js/webuploader/webuploader.js",function(){d=WebUploader.create({resize:!1,swf:ws_url+"/js/uploader/Uploader.swf",server:n,dnd:"#"+s,pick:p,callback:function(e){},fileSingleSizeLimit:1024e4,accept:{extensions:"gif,jpg,jpeg,bmp,png,pdf,docx,doc,xlsx,xls",mimeTypes:"image/jpg,image/jpeg,image/png,image/gif,application/msexcel,application/pdf,application/msword,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),d.on("beforeFileQueued",function(e){return c.children().length>=100?($(v).text("文件数量不能超过100个！已过滤。"),!1):($(v).text(""),!0)}),d.on("fileQueued",function(e){var t='<div id="'+e.id+'" class="item row col-md-12 fileListRow" style="border-bottom:1px solid #333; padding:5px 0px;"><div class="info col-md-4 txt" title="'+e.name+'">'+e.name+'</div><div class="state col-md-4">等待上传...</div><div class="operate col-md-4"><a class="delFile" href="javascript:void(0);">删除</a></div></div>';c.append(t),$("#"+e.id).find(".operate").find(".delFile").on({click:function(t){t.preventDefault(),d.removeFile(e),$("#"+e.id).remove()}})}),d.on("uploadProgress",function(e,t){var n=$("#"+e.id),o=n.find(".operate"),a=o.find(".progress .progress-bar");a.length||(a=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(o).find(".progress-bar")),n.find(".state").text("上传中"),a.css("width",100*t+"%")}),d.on("uploadSuccess",function(t,n){switch(s){case"file-attachment":setFile(),$("#file-modal").modal("hide")}var o=ctx+"/CXF/rs/SimpleAC/down/"+(new Base64).encode("toocr/order/downFileAttachment/"+n.id+"/"+e.ownerName+"/N"),a=ctx+"/CXF/rs/SimpleAC/down/"+(new Base64).encode("toocr/order/downFileAttachment/"+n.id+"/"+e.ownerName+"/Y");$("#"+t.id).attr("data-id",n.id),$("#"+t.id).find(".info").html('<img class="thumbnailImg" style="width:30px;height:30px;" src="'+o+'"><a title="下载" target="_blank" href="'+a+'">'+t.name+"</a>"),$("#"+t.id).find(".state").text("已上传"),$("#"+t.id).find(".operate").html('<a class="delFile" href="'+ctx+"/CXF/rs/common/file/"+n.id+'">删除</a>'),$("#"+t.id).find(".operate").find(".delFile").on({click:function(e){var o=ws_url+"/CXF/rs/common/file/"+n.id;e.preventDefault(),Core.confirm({message:"确定要删除？",confirmCallback:function(){Core.AjaxRequest({url:o,showMsg:!1,type:"DELETE",callback:function(e){void 0!==t&&d.removeFile(t),$("#"+t.id).remove()},failure:function(e){}})}})}})}),d.on("uploadError",function(e,t){var n=JSON.parse(t);$("#"+e.id).find(".state").text(n.errorMsg)}),d.on("uploadComplete",function(e){$("#"+e.id).find(".progress").fadeOut()}),d.on("error",function(e){"Q_EXCEED_SIZE_LIMIT"==e&&$(v).text("文件大小不符要求！已过滤。"),"F_EXCEED_SIZE"==e&&$(v).text("文件大小不符要求！已过滤。"),"Q_EXCEED_NUM_LIMIT"==e&&$(v).text("文件数量不能超过5个！已过滤。"),"Q_TYPE_DENIED"==e&&$(v).text("文件格式不符！已过滤。")}),d.on("all",function(e){"startUpload"===e?(h="uploading",$(v).text("")):"stopUpload"===e?h="paused":"uploadFinished"===e&&(h="done"),"uploading"===h?u.text("暂停上传"):u.text("开始上传")}),u.on("click",function(){"uploading"===h?d.stop():d.upload()}),m.on("click",function(){void 0!=AVisionImg?(AVisionImg.ScanDocuments(),AVisionImg.OCRRect("\t\t<?xml version='1.0' encoding='UTF-8'?><ImageFileList RectOCR='1' OutFileFormat='0' FileCount='1'>  <ImportFile FileName=''>    <Rect RectName='登记类型' X1='329' Y1='70' X2='617' Y2='132' Value=''/>    <Rect RectName='姓名1' X1='1331' Y1='58' X2='1539' Y2='125' Value=''/>    <Rect RectName='证件种类1' X1='1218' Y1='446' X2='1407' Y2='493' Value=''/>    <Rect RectName='证件编号1' X1='1402' Y1='763' X2='1599' Y2='803' Value=''/>  </ImportFile></ImageFileList>")):Core.alert({message:"请检查扫描设备！"})}),f.on("click",function(){if(void 0!=AVisionImg){var e=null,t=AVisionImg.OCRTextCount();if(t>0)for(var n=0;n<t;n++)e=JSON.parse(AVisionImg.OCRText(0));for(var o in e)"公司名称"===e[o].RectName&&$("#rcptAdd-clientName").val(e[o].Value),"发票号码"===e[o].RectName&&$("#rcptAdd-num").val(e[o].Value),"发票日期"===e[o].RectName&&$("#rcptAdd-time").val(e[o].Value.replace("年","-").replace("月","-").replace("曰","")),"发票总金额"===e[o].RectName&&($("#rcptAdd-sum").val(e[o].Value.replace("￥","").replace(" ","")),$("#rcptAdd-nosum").val(e[o].Value.replace("￥","").replace(" ",""))),"税率"===e[o].RectName&&$("#rcptAdd-tax").val(e[o].Value+"%")}})})}()});var a=$('<div class="col-md-12"><div class="row row-vp"><div id="uploader" class="col-md-12 wu-example"><div id="thelist" class="uploader-list"></div></div></div></div>'),r=$(this),i=$(this).attr("id");if(void 0===i&&(i=""),a.find("*").each(function(e,t){var n=$(this).attr("id");void 0!==n&&$(this).attr("id",i+""+n)}),a.appendTo(r),void 0!==e.filelist&&""!=e.filelist){var l="";l=null!=e.orderType?ws_url+"/CXF/rs/common/fileinfos/"+e.filelist:ctx+"/CXF/rs/SimpleAC/"+(new Base64).encode("toocr/order/orderfileinfo/all/sales/"+e.orderId+"/"+e.ownerId+"/"+e.ownerName),Core.AjaxRequest({type:"GET",showMsg:!1,url:l,callback:function(t){var n=$("#"+i+"thelist");return $.each(t,function(t,o){var a=ctx+"/CXF/rs/SimpleAC/down/"+(new Base64).encode("toocr/order/downFile/"+o.id+"/"+e.ownerId+"/"+e.ownerName),r=a.split("=")[0],i='<div data-id="'+o.id+'" id="'+o.id+'" class="item row col-md-12 fileListRow" style="border-bottom:1px solid #333; padding:5px 0px;"><div class="info col-md-4"><img class="thumbnailImg" data-id="'+o.id+'" style="width:30px;height:30px;" src="'+a+'"><a class="downloadfile" title="下载" target="_blank" href="'+r+'">'+o.showName+'</a></div><div class="state col-md-4">已上传</div><div class="operate col-md-4"><a class="downloadfile" title="下载" target="_blank" href="'+r+'">下载</a></div></div>';n.append(i)}),void 0==e.showImg&&$("#addSO").find(".thumbnailImg").eq(0).trigger("dblclick"),r},failure:function(e){return r}})}},moneyinput:function(e){"use strict";var t={textalign:"right",defaultValue:"0.00",allowNull:!0,allowDecimal:!1,integer:!1};return e=$.extend(!0,t,e),$(this).each(function(t,n){var o=$(n),a=""==o.val()?e.defaultValue:o.val(),r=o.css("color");o.attr("type","text").css("text-align",e.textalign);var i=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},l=function(e){return/^[-]?\d+(\.\d+)?$/g.exec(e)},s=function(e){return/^[-]?\d+(\.\d{2})$/g.exec(e)?e:/^[-]?\d+(\.\d{1})$/g.exec(e)?e+"0":/^[-]?\d+(\.)$/g.exec(e)?e+"00":/^[-]?\d+$/g.exec(e)?e+".00":/^[-]?\d+(\.\d{2,})$/g.exec(e)?e.substring(0,e.indexOf(".")+3):""==e?"0":e=a};o.on({blur:function(t){var n=o.val();""==n&&(a=0),n=i(n)?!0===e.allowDecimal?parseFloat(n).toString():parseFloat(n).toString().replace("-",""):a,a=s(n),!0===e.integer&&(a=parseInt(n)),o.val(a),o.css({color:r}),o.trigger("keyup")},keyup:function(t){var n=o.val();if(""==n)return e.allowNull?void o.val(""):void o.val("0");if(n.indexOf("-")>-1){if(1==e.allowDecimal&&1==n.length)return void o.val("-");if(0==e.allowDecimal)return void o.val(n.replace(/-/g,""))}if(isNaN(n)){var a=n.toString();isNaN(parseInt(n))?o.val(0):"."!=a.substr(-1)&&(-1!=a.indexOf(".")?o.val(parseFloat(n)):o.val(parseInt(n)))}if(1==e.integer){if(isNaN(n)){var n=parseInt(n);isNaN(n)?o.val(0):o.val(parseInt(n))}n.toString().indexOf(".")>-1&&o.val(parseInt(n))}},keypress:function(t){var n=t||window.event;!0!==e.allowDecimal&&45==n.keyCode?n.returnValue=!1:n.keyCode>47&&n.keyCode<58||46===n.keyCode||45==n.keyCode?n.returnValue=!0:n.returnValue=!1},paste:function(e){var t=o.val();l(t)?o.css({color:r}):o.css({color:"red"})}})})},auditList:function(e){"use strict";var t={bpmnObj:null};e=$.extend(!0,t,e);var n=_global_settings.service.url+"/bpmn/commentvolist/processinstanceid/null",o={datatype:"json",url:n,type:"GET"},a=new $.jqx.dataAdapter(o);return $(this).grid({virtualmode:!1,source:a,pageable:!1,columns:[{text:"审批人",datafield:"username"},{text:"备注",datafield:"content"},{text:"审批时间",datafield:"time"}]})},auditWindow:function(e){"use strict";var t={pre:"",bpmnObj:null,taskId:null,processKey:null,callback:function(){}};e=$.extend(!0,t,e);var n='<div class="jqxwindow" id="'+e.pre+'winAudit" style="display:none;"><div>再次提交</div><div id="'+e.pre+'winFormAudit"><input type="hidden" id="'+e.pre+'add-taskId"/><table><tr><td>提交理由</td><td colspan="3"><textarea id="'+e.pre+'add-content"></textarea></td></tr><tr><td colspan="4" class="btn_align"><button class="btn btn-inverse" id="'+e.pre+'saveApproveBtn">确定</button><button class="btn btn-inverse" id="'+e.pre+'cancelApproveBtn" >取消</button></td></tr></table></div></div>';$(this).after(n),$("#"+e.pre+"winAudit").window({width:500,height:450,cancelButton:$("#"+e.pre+"cancelApproveBtn"),initContent:function(){$("#"+e.pre+"add-content").textarea()}}).on({open:function(){var t=$(window).width(),n=$(window).height(),o=$("#"+e.pre+"winAudit").height(),a=$("#"+e.pre+"winAudit").width();$("#"+e.pre+"winAudit").jqxWindow({position:{x:(t-a)/2,y:(n-o)/2+$(document).scrollTop()}}),$("#"+e.pre+"add-content").val("")}});var o=function(){var t=new Object;return t.content=$("#"+e.pre+"add-content").val(),t},a=function(){var t=new Object;return t.content=$("#"+e.pre+"add-content").val(),t},r=null,i=null,l=function(t){var n=t.content;return""==n?(Core.alert({message:"提交理由不能为空！"}),!1):n.length>200?(Core.alert({message:"提交理由字数最大长度为200！"}),!1):("view"==e.type?(r=_global_settings.service.url+"/"+e.url+"/commit/id/"+e.id+"/"+n,null!=e.page&&(r=r+"/"+e.page)):(i=e.json(),r=_global_settings.service.url+"/"+e.url+"/commit/"+n),void Core.AjaxRequest({url:r,type:"POST",params:i,async:!1,callback:function(t){$("#"+e.pre+"winAudit").jqxWindow("close");try{refreshDataInfo(e.parent)}catch(e){}e.callback()},failure:function(e){}}))};$("#"+e.pre+"saveApproveBtn").off("click").on({click:function(){l(o())}}),$("#"+e.pre+"saveRejectBtn").off("click").on({click:function(){l(a())}})},auditWindowSP:function(e){"use strict";var t={pre:"",bpmnObj:null,taskId:null,processKey:null,callback:function(){}};e=$.extend(!0,t,e);var n='<div class="jqxwindow" id="'+e.pre+'winAuditSP" style="display:none;"><div>审批处理</div><div id="'+e.pre+'winFormAuditSP"><input type="hidden" id="'+e.pre+'add-taskIdSP" value="'+e.value+'"/><table><tr><td>审批意见</td><td colspan="3"><textarea id="'+e.pre+'add-contentSP"></textarea></td></tr><tr><td colspan="4" class="btn_align"><button class="btn btn-inverse" id="'+e.pre+'saveApproveBtnSP">审批通过</button><button class="btn btn-inverse" id="'+e.pre+'saveRejectBtnSP" >审批不通过</button><button class="btn btn-inverse" id="'+e.pre+'cancelApproveBtnSP" >取消</button></td></tr></table></div></div>';$(this).after(n),$("#"+e.pre+"winAuditSP").window({width:500,height:450,cancelButton:$("#"+e.pre+"cancelApproveBtnSP"),initContent:function(){$("#"+e.pre+"add-contentSP").textarea()}}).on({open:function(){var t=$(window).width(),n=$(window).height(),o=$("#"+e.pre+"winAuditSP").height(),a=$("#"+e.pre+"winAuditSP").width();$("#"+e.pre+"winAuditSP").jqxWindow({position:{x:(t-a)/2,y:(n-o)/2+$(document).scrollTop()}}),$("#"+e.pre+"add-contentSP").val("")}});var o=function(){var t=new Object;return t.content=$("#"+e.pre+"add-contentSP").val(),t.taskId=$("#"+e.pre+"add-taskIdSP").val(),t.passFlag=!0,t},a=function(){var t=new Object;return t.content=$("#"+e.pre+"add-contentSP").val(),t.taskId=$("#"+e.pre+"add-taskIdSP").val(),t.passFlag=!1,t},r=function(t){""==t.content&&(t.content=" "),Core.AjaxRequest({url:_global_settings.service.url+"/bpmn/completeTask",type:"PUT",params:t,async:!1,callback:function(t){$("#"+e.pre+"winAuditSP").jqxWindow("close");try{refreshDataInfo(e.parent)}catch(e){}e.callback()},failure:function(e){}})};$("#"+e.pre+"saveApproveBtnSP").off("click").on({click:function(){r(o())}}),$("#"+e.pre+"saveRejectBtnSP").off("click").on({click:function(){if(""==$("#"+e.pre+"add-contentSP").val())return Core.alert({message:"审批意见不能为空！"}),!1;r(a())}})},easytable:function(e){var t={tr:"<tr></tr>",tr_load_func:function(){}};e=$.extend(!0,{},t,e);var n=$(this).find("tbody"),o=function(t){var o=n.children().length+1,t=$(t);t.find(".index").html(o),e.tr_load_func(t),n.append(t)};return n.on("click","tr",function(){$(this)[0]==n.find("tr").eq(-1)[0]&&n.trigger("addline")}),n.on("addline",function(){o(e.tr)}),n.on("click",".del",function(){var e=$(this).parent().parent();if(n.find("tr").length>1)return Core.confirm({message:"确定要删除？",confirmCallback:function(){e.remove(),n.children().each(function(){var e=$(this);e.find(".index").text(parseInt(e.index())+1)}),n.trigger("change")}}),!1}),n.on("click",".copy",function(){var t=$(this).parent().parent(),o=$("<tr class='cwhite'><td class='blt'><i class='md-cancel del'></i><i class='md-description copy hidden'></i></td>"+'<td class="brt brtt"><div class="time"></div></td><td class="brt brtt"><input type="text" class="receiveMoney form-control" style="width:200px"><span class="hidden recId"></span></td><td class=\'brt brtt\'><div class=\'receiveWay\'></div></td><td class=\'brt brtt br0\'><input type=\'text\' class=\'remark form-control\'></td></tr>');o.insertAfter(t);var a={time:t.find(".time").val(),receive:t.find(".receiveMoney").val(),way:t.find(".receiveWay").val(),remark:t.find(".remark").val()};e.tr_load_func(o,a),n.trigger("change")}),o(e.tr),$(this)},center:function(e){var e=$.extend({inside:window,transition:0,minX:0,minY:0,withScrolling:!0,vertical:!0,horizontal:!0,isRelative:!1},e);return this.each(function(){var t={position:"absolute"};if(e.vertical){var n=($(e.inside).height()-$(this).outerHeight())/2;e.withScrolling&&(n+=$(e.inside).scrollTop()||0),n=n>e.minY?n:e.minY,$.extend(t,{top:n+"px"})}if(e.horizontal){var o=($(e.inside).width()-$(this).outerWidth())/2;e.withScrolling&&(o+=$(e.inside).scrollLeft()||0),o=o>e.minX?o:e.minX,$.extend(t,{left:o+"px"})}return e.transition>0?$(this).animate(t,e.transition):$(this).css(t),$(this)})},focusIndex:function(e){var t=this[0];if(!t||"TEXTAREA"!=t.tagName&&"text"!=t.type.toLowerCase()){if(void 0===e)return}else{if(void 0===e)return t.selectionStart;"number"==typeof e&&(t.selectionEnd=e,t.selectionStart=e)}}});var DropDownList=function(e){var t=this,n={placeHolder:"请选择",selectedIndex:0,displayMember:"codeDisplay",valueMember:"codeValue",width:120,height:22,autoDropDownHeight:!0,dropDownWidth:120,dropDownHeight:120,checkboxes:!1,disabled:!1,filterable:!1,url:ws_url+"/CXF/rs/code/"};e.dropDownWidth&&(e.width+=6,e.dropDownWidth+=6),this.obj=$.extend(n,e),this.initOptions=function(e){e.dropDownWidth&&(e.width+=6,e.dropDownWidth+=6),t.obj=$.extend(t.obj,e)},this.codeDropDownList=function(e,n,o,a){var r=void 0==a||null==a?{}:a;r=$.extend(t.obj,r),Core.AjaxRequest({url:r.url+n,showMsg:!1,async:!1,cache:!0,type:"GET",callback:function(t){var n={datatype:"json",datafields:[{name:"codeValue"},{name:"codeDisplay"}],localdata:t},a=new $.jqx.dataAdapter(n);$("#"+e).jqxDropDownList({placeHolder:r.placeHolder,selectedIndex:r.selectedIndex,source:a,displayMember:r.displayMember,valueMember:r.valueMember,width:r.width,height:r.height,autoDropDownHeight:r.autoDropDownHeight,checkboxes:r.checkboxes,theme:currentTheme}),"boolean"==typeof o&&o&&(e.indexOf("search")>-1?$("#"+e).jqxDropDownList("insertAt",{label:"全部",value:""},0):$("#"+e).jqxDropDownList("insertAt",{label:"请选择",value:""},0))}})},this.customDropDownList=function(e,n,o,a,r,i,l,s){Core.AjaxRequest({url:n,type:null==i?"GET":i,params:null==l?{}:l,showMsg:!1,async:!1,cache:!0,callback:function(n){var i={datatype:"json",datafields:[{name:o},{name:a}],localdata:n},l=new $.jqx.dataAdapter(i);$("#"+e).jqxDropDownList({selectedIndex:t.obj.selectedIndex,source:l,displayMember:o,valueMember:a,width:t.obj.width,height:t.obj.height,autoDropDownHeight:t.obj.autoDropDownHeight,dropDownWidth:t.obj.dropDownWidth,dropDownHeight:t.obj.dropDownHeight,disabled:t.obj.disabled,checkboxes:t.obj.checkboxes,theme:currentTheme}),!0===$("#"+e).jqxDropDownList("checkboxes")&&$("#"+e).jqxDropDownList({placeHolder:"请选择"}),"boolean"==typeof r&&r?e.indexOf("search")>-1?$("#"+e).jqxDropDownList("insertAt",{label:"全部",value:""},0):$("#"+e).jqxDropDownList("insertAt",{label:"请选择",value:""},0):0==n.length&&$("#"+e).jqxDropDownList("insertAt",{label:" ",value:"0"},0),$("#"+e).jqxDropDownList("selectIndex",null==s?0:s)}})}};isCheckEd=!1,$.fn.extend({dropDownlist:function(e){var t={theme:currentTheme,placeHolder:"请选择",displayMember:"typeValue",valueMember:"typeValue",width:"100%",height:"34px"};return e=$.extend(!0,{},t,e),$(this).jqxDropDownList(e)},comboBox:function(e){var t={theme:currentTheme,searchMode:"none",enableBrowserBoundsDetection:!1,width:"100%",height:"34px",renderSelectedItem:refNameByPinyin,placeHolder:"请选择"},n=$(this),o=[],a=null;n.off("focus","input").on("focus","input",function(){n.jqxComboBox("open")}),e=$.extend(!0,{},t,e);var r=e.source,i=e.displayMember;return o=$.extend(!0,[],r),r.length>200&&(r.length=200),n.off("keyup").off("compositionstart").on("compositionend").on("keyup",function(e){if("start"===n.prop("comStart"))return void e.stopPropagation();var t=null==e.keyCode?"":e.keyCode;if($.strEqArr(t,[13,37,38,39,40]))return void(13==t&&n.jqxComboBox("close"));clearTimeout(a),a=setTimeout(function(){for(var e=n.find("input").val(),t=n.find("input").focusIndex(),a=[],r=[],l=0,s=o.length;l<s;l++){var d=void 0==o[l][i]?o[l]:o[l][i];e==d?a.unshift(o[l]):""!=e&&d.indexOf(e)>-1?a.unshift(o[l]):r.push(o[l])}a.length>=0&&a.length<200&&(a=a.concat(r)),a.length>200&&(a.length=200),n.jqxComboBox({source:a}),""!=e?(n.val(e),n.find("input").val(e),n.find("input").focusIndex(t),n.jqxComboBox("open")):(n.find("input").val(e),n.jqxComboBox("open"))},60)}).on("compositionstart",function(){n.prop("comStart","start")}).on("compositionend",function(){n.prop("comStart","end"),n.triggerHandler("keyup")}),$(this).jqxComboBox(e)},andSelf:function(){return $(this).each(function(e,t){})}});var sortData=function(){var e=[],t=arguments[0],n=arguments[1],o=arguments[2],a=t.length,r=null;if(void 0==o){for(var i=0;i<a;i++)if(t[i]==n){r=t[i],i;break}}else for(var i=0;i<a;i++)if(t[i][o]==n){r=t[i],i;break}return null==r?e=t:(t.splice(i,1),t.unshift(r),e=t),e},moneyBig=function(){var e=void 0===arguments[0]?"0":arguments[0],t=void 0===arguments[1]?"":arguments[1],n=money(e),o="";n.indexOf("-")>-1&&(o="-",n=n.replace("-",""));for(var a=n.split("").reverse().join(""),r=a.length,i=n.substring(n.indexOf("."),r),l="",s=3;s<a.length;s+=3)l+=a.substring(s,s+3)+",";return l=l.substring(0,l.length-1),l=l.split("").reverse().join(""),t+o+l+i},moneySmall=function(){var e=0;return e=money((void 0===arguments[0]?"0":arguments[0]).toString().replace(/,/g,"")),parseFloat(e)},moneyFmt=function(e,t,n,o,a,r){return'<div class="jqx-grid-cell-left-align" style="margin-top: 6px;text-align: right;">￥'+money(n)+"</div>"};lastCheckValueDefaults={category1:"",category2:"",address:"",clientPeople:""};var lastCheckValue=function(e){for(var t in e)try{var n=null==lastCheckValueDefaults[e[t]]?"":lastCheckValueDefaults[e[t]];$("#"+t).val(n),null==$("#"+t).jqxComboBox("getSelectedItem")&&$("#"+t).val("")}catch(e){}},getWindowMsgNow=function(e){return"time"===e?(new Date).getTime():"name"===e?$("#zqw_tabs").find(".active>a").text():void 0},WindowMsg={time:getWindowMsgNow("time"),name:getWindowMsgNow("name")},timeOut=function(e,t){var n=200;null!=t&&(n=t),setTimeout(e,n)},idReset=function(e){var t=(new Date).getTime();$("#"+e).find("*").each(function(){var e=$(this).attr("id");void 0!==e&&$(this).attr("id",e+t)}),$("#"+e).attr("id",e+t)},digitUppercase=function(e){var t=["角","分"],n=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],o=[["元","万","亿"],["","拾","佰","仟"]],a=e<0?"欠":"";e=Math.abs(e);for(var r="",i=0;i<t.length;i++)r+=(n[Math.floor(10*e*Math.pow(10,i))%10]+t[i]).replace(/零./,"");r=(r.indexOf("角")==r.length-1?r+"整":r)||"整",e=Math.floor(e);for(var i=0;i<o[0].length&&e>0;i++){for(var l="",s=0;s<o[1].length&&e>0;s++)l=n[e%10]+o[1][s]+l,e=Math.floor(e/10);r=l.replace(/(零.)*零$/,"").replace(/^$/,"零")+o[0][i]+r}return a+r.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")},printList=function(e){var t={btn:"",grid:"",reportName:"",idName:"",vid:"id"};e=$.extend(!0,{},t,e),$(e.btn).on("click",function(){var t=$(e.grid).jqxGrid("getselectedrowindexes"),n="";for(var o in t){var a=$(e.grid).jqxGrid("getrowdata",t[o]);null!=a&&(n+=a[e.vid]+",")}if(n=n.substring(0,n.length-1),0==n.length)return Core.alert({message:"请选择需要打印的项"}),!1;window.open("page/print/printHtml2.jsp?reportName="+e.reportName+"&"+e.idName+"="+n+"&printType=pdf")})},leftMenuHover=function(){$("#titleStyle").length>0&&$("#titleStyle").remove();var e=$('<div id="titleStyle" class="appendTitle"></div>');$(".level1 > li > a").off("mouseover").on("mouseover",function(){if(getTrueOrFalse()){var t=$(this).offset().top;e.css({top:t+"px",display:"block"}).text($(this).find("span").text()),e.appendTo($("body"))}}),$(".level1 > li > a").on("mouseout",function(){e.css({display:"none"})})};leftMenuHover();var getTrueOrFalse=function(){return 50==$("#level1_menu").width()},getCacheInfoById=function(e,t,n){var o=null;if(""==e||null==e)return{};var a=function(e,t,n){n=void 0===n?"id":n;for(var o in ComboBoxSources.getRecords(t))if(ComboBoxSources.getRecords(t)[o][n]===e)return ComboBoxSources.getRecords(t)[o]},o=a(e,t,n);return null==o?(ComboBoxSources.load(t,!0),a(e,t,n)):o},addUserLabel=function(e,t,n){var o=n,a=ComboBoxSources.getRecords(n),r=e,i=t,l=function(){var e=$("#user_label").find("input").length;$("#user_label").find("input").off("foucs").on("focus",function(){$(this).parents("tr").index()==e-1&&$("#user_label").append('<tr><td><input type="text" class="form-control addline"></td></tr>');s()})},s=function(){$("#user_label").find("input").off("focus"),l()},d=function(){if($("#user_label").find("tbody").children().remove(),$("#user_edit").jqxDropDownList({selectedIndex:-1}),$("#label_type").val("").val(o),$("#user_addLabel").modal("show"),r)$("#user_id").val(r),$("#label_span").text("修改标签"),$("#user_label").addClass("hide"),$("#user_edit").dropDownlist({source:a,valueMember:"lebal",displayMember:"lebal",dropDownHeight:130}).removeClass("hide").val(i);else{$("#label_span").text("新增标签"),$("#user_label").removeClass("hide"),$("#user_edit").addClass("hide"),$("#label_num").data("json",a),$.each(a,function(e){var t='<tr><td><input type="text" readonly class="form-control" value="'+a[e].lebal+'"></td></tr>';$("#user_label").append(t)});$("#user_label").append('<tr><td><input type="text" class="form-control addline"></td></tr>'),$("#user_label").find("input.addline").off("focus").on("focus",function(){var e=$("#user_label").find("input").length;$(this).parents("tr").index()==e-1&&$("#user_label").append('<tr><td><input type="text" class="form-control addline"></td></tr>');l()})}};0==$("#user_addLabel").length?$.loadModal("page/common/segment/addLabel.html",function(e){$("body").append(e),d()}):d()},addRemark=function(e,t,n){var o=e,a=t,r=n,i=function(){$("#user_addRemark").val(""),$("#add_remark").modal("show"),$("#userId").val(a),$("#remark_type").val("").val(r);var e={localdata:o,datatype:"array"},t=new $.jqx.dataAdapter(e),n=[{text:"更新时间",dataField:"createDate",width:"50%"},{text:"备注",dataField:"remark",width:"50%"}];r&&(n[1]={text:"备注",dataField:"comment",width:"50%"}),$("#remarkGrid").jqxGrid({source:t,width:"100%",height:160,pageable:!1,columns:n})};0==$("#add_remark").length?$.loadModal("page/common/segment/addRemark.html",function(e){$("body").append(e),i()}):i()},addRess=function(e){var t=e,n=function(){$("#addRess_modal").find("input").val(""),$("#addRess_modal").find("select").val(""),$("#addRess_modal").find("textarea").val(""),$("#addRess_modal").modal("show"),new address("address_address","form-control").init(),$("#saveAddressBtn").off("click").on("click",function(){if(!$("#addRess_modal").jqxValidator("validate"))return!1;var e=$("#address_address").children(),n=e.eq(0).val(),o=e.eq(1).val(),a=e.eq(2).val(),r=$("#address_st").val(),i=$("#address_sn").val(),l=$("#address_zc").val(),s=$("#address_rm").val(),d='<tr><td class="hidden">'+i+'</td><td><i class="glyphicon glyphicon-home"style="padding-right: 20px;"></i></td><td><font>'+n+"</font><font>"+o+"</font><font>"+a+"</font><font>"+r+'</font></td><td class="hidden">'+l+'</td><td class="hidden">'+s+'</td><td style="float:rigth;"><font class="md-rate-review edit">编辑</font><font class="md-cancel delete">删除</font></td></tr>',c=$("#address_address").children().eq(0).val(),u=$("#address_address").children().eq(1).val(),p=$("#address_st").val();if(""!=c&&""!=u&&""!=p)if(""!==$("#address_type").val()){var m=$("#address_type").val();$(t).find("tr").eq(m).replaceWith(d)}else $(t).append(d)})};0==$("#addRess_modal").length?$.loadModal("page/common/segment/addAddress.html",function(e){$("body").append(e),n()}):n()},editOrdelAddress=function(e,t,n){var o=e,a=t,r=n,i=function(){$("#addRess_modal").find("input").val(""),$("#addRess_modal").find("select").val(""),$("#addRess_modal").find("textarea").val(""),$("#addRess_modal").modal("show");var e=new address("address_address","form-control");e.init();var t=$(o).find("tr"),n=a.parent().parent().index(),r={};r={shortName:t.eq(n).find("td").eq(0).text(),province:t.eq(n).find("td").eq(2).children().eq(0).text(),city:t.eq(n).find("td").eq(2).children().eq(1).text(),district:t.eq(n).find("td").eq(2).children().eq(2).text(),street:t.eq(n).find("td").eq(2).children().eq(3).text(),zipCode:t.eq(n).find("td").eq(3).text(),remark:t.eq(n).find("td").eq(4).text()},$("#address_sn").val(r.shortName),$("#address_rm").val(r.remark),$("#address_zc").val(r.zipCode),$("#address_st").val(r.street),$("#address_type").val(n),e.setVal(r.province,r.city,r.district),$("#saveAddressBtn").off("click").on("click",function(){if(!$("#addRess_modal").jqxValidator("validate"))return!1;var e=$("#address_address").children(),t=e.eq(0).val(),n=e.eq(1).val(),a=e.eq(2).val(),r=$("#address_st").val(),i=$("#address_sn").val(),l=$("#address_zc").val(),s=$("#address_rm").val(),d='<tr><td class="hidden">'+i+'</td><td><i class="glyphicon glyphicon-home"style="padding-right: 20px;"></i></td><td><font>'+t+"</font><font>"+n+"</font><font>"+a+"</font><font>"+r+'</font></td><td class="hidden">'+l+'</td><td class="hidden">'+s+'</td><td style="float:rigth;"><font class="md-rate-review edit">编辑</font><font class="md-cancel delete">删除</font></td></tr>',c=$("#address_address").children().eq(0).val(),u=$("#address_address").children().eq(1).val(),p=$("#address_st").val();if(""!=c&&""!=u&&""!=p)if(""!==$("#address_type").val()){var m=$("#address_type").val();$(o).find("tr").eq(m).replaceWith(d)}else $(o).append(d)})};"edit"==r?0==$("#addRess_modal").length?$.loadModal("page/common/segment/addAddress.html",function(e){$("body").append(e),i()}):i():Core.confirm({message:"确认删除吗？",confirmCallback:function(){a.parent().parent().remove()}})},disabledUser=function(e,t,n){var o=e,a=t,r=n,i=function(){$("#disabled_user").modal("show"),$("#disabled_user_id").val("").val(o),$("#disabled_username").val("").val(a),$("#disabled_true").dropDownlist({source:{false:"否",true:"是"},width:"100%",dropDownHeight:100}).val(r)};0==$("#disabled_user").length?$.loadModal("page/common/segment/disabled.html",function(e){$("body").append(e),i()}):i()},allotSale=function(e,t){var n=e,o=t,a=_global_settings.owner.roleName,r=function(){var e=getCurrentInfo();void 0!=o?($("#allotSales_sale").comboBox({source:ComboBoxSources.getRecords("salesInfo_name"),displayMember:"name_user",valueMember:"id",disabled:!1,width:"100%"}).val(void 0==n.employeeCode?"":getSalesInfoById(null,n.employeeCode).id),$("#allotSales_customer").comboBox({source:ComboBoxSources.getRecords("custService_name"),displayMember:"name_user",valueMember:"id",disabled:!1,width:"100%"}).val(void 0==n.customerCode?"":getCustomerInfoById(null,n.customerCode).id),$("#allotSales_user").val("user"),$("#allotSales_ownerId").val(n.ownerId),$("#allotSales_agent").parents(".allot").removeClass("hide"),$("#allotSales_type").parents(".allot").removeClass("hide"),$("#allotSales_senior").parents(".allot").addClass("hide"),$("#allotSale_rate").parents(".allot").addClass("hide"),$("#allotSale_compname").parents(".allot").removeClass("hide"),$("#allotSales_type").dropDownlist({source:{salesDirect:"销售直销",agentDirect:"代理直销",transformation:"商机转化"},width:"100%",height:34,selectedIndex:0}).val(n.type),$("#allotSales_agent").comboBox({source:ComboBoxSources.getRecords("salesAgent_name"),displayMember:"name_user",valueMember:"id",width:"100%"}).val(void 0==n.agentCode?"":getAgentInfoById(null,n.agentCode).id),"sales"==e&&($("#allotSales_sale").comboBox({source:ComboBoxSources.getRecords("sale_name"),displayMember:"name_user",valueMember:"id",disabled:!1,width:"100%"}).val(void 0==n.employeeCode?"":getSalesInfoById(null,n.employeeCode).id),$("#allotSales_customer").jqxComboBox({disabled:!0})),$("#allotSale_compname").val(n.name),$("#allotSale_name").val(n.username),"customers"==e&&($("#allotSales_sale").jqxComboBox({disabled:!0}),$("#allotSales_agent").jqxComboBox({disabled:!0})),"salesStaff"!==a&&"customerService"!==a||($("#allotSales_sale").jqxComboBox({disabled:!0}),$("#allotSales_customer").jqxComboBox({disabled:!0}))):($("#allotSales_sale").comboBox({source:ComboBoxSources.getRecords("salesInfo_name"),displayMember:"name_user",valueMember:"id",disabled:!1,width:"100%"}).val(void 0==n.sales?"":n.sales.id),$("#allotSales_customer").comboBox({source:ComboBoxSources.getRecords("custService_name"),displayMember:"name_user",valueMember:"id",disabled:!1,width:"100%"}).val(void 0==n.customer?"":n.customer.id),$("#allotSales_user").val(""),$("#allotSales_agent").parents(".allot").addClass("hide"),$("#allotSales_type").parents(".allot").addClass("hide"),$("#allotSales_senior").parents(".allot").removeClass("hide"),$("#allotSale_rate").parents(".allot").removeClass("hide"),$("#allotSale_compname").parents(".allot").addClass("hide"),$("#allotSales_senior").dropDownlist({source:{false:"否",true:"是"},width:"100%",selectedIndex:0,dropDownHeight:100}).val(n.senior),"sales"==e&&$("#allotSales_sale").jqxComboBox({disabled:!0}),"customer"==e&&$("#allotSales_customer").jqxComboBox({disabled:!0}),"salesStaff"!==a&&"customerService"!==a||($("#allotSales_sale").jqxComboBox({disabled:!0}),$("#allotSales_customer").jqxComboBox({disabled:!0})),$("#allotSale_rate").val(n.rate),$("#allotSale_name").val(n.agentName),$("#allotSales_data").data("data",n))},i=function(){$("#allotSales_modal").modal("show"),r()};0==$("#allotSales_modal").length?$.loadModal("page/common/segment/allotSales.html",function(e){$("body").append(e),i()}):i()},getCurrentInfo=function(){var e=_global_settings.owner,t={salesStaff:"sale",salesManage:"sales",secondLevelSalesManage:"sales",customerService:"customer",customerManage:"customers",secondLevelCustomerManage:"customers",agentistrator:"agent",Sys_Admin:"sys",Ocr_Admin:"ocr_sys",Ocr_group:"ocr_grp",Ocr_createBy:"ocr_writer",Ocr_auditor:"ocr_checker"};for(var n in t)if(e.roleName==n)return t[n]},getAgentInfoById=function(e,t){var n=null,o=e,a=t,r=function(e,t){if(null==t){for(var n=ComboBoxSources.getRecords("salesAgent_name"),o=0;o<n.length;o++)if(n[o].id==e)return n[o]
}else for(var n=ComboBoxSources.getRecords("salesAgent_name"),o=0;o<n.length;o++)if(n[o].agentCode==t)return n[o]};return n=r(o,a),null==n&&(ComboBoxSources.load("salesAgent"),n=void 0==r(o,a)?{name_user:""}:getAGgentInfo(o,a)),n},getCustomerInfoById=function(e,t){var n=null,o=e,a=t,r=function(e,t){if(null==t){for(var n=ComboBoxSources.getRecords("custService_name"),o=0;o<n.length;o++)if(n[o].id==e)return n[o]}else for(var n=ComboBoxSources.getRecords("custService_name"),o=0;o<n.length;o++)if(n[o].employeeCode==t)return n[o]};return n=r(o,a),null==n&&(ComboBoxSources.load("custService",!0),n=void 0==r(o,a)?{name_user:""}:getCUstInfo(o,a)),n},getSalesInfoById=function(e,t){var n=null,o=e,a=t,r=function(e,t){if(null==t){for(var n=ComboBoxSources.getRecords("salesInfo_name"),o=0;o<n.length;o++)if(n[o].id==e)return n[o]}else for(var n=ComboBoxSources.getRecords("salesInfo_name"),o=0;o<n.length;o++)if(n[o].employeeCode==t)return n[o]};return n=r(o,a),null==n&&(ComboBoxSources.load("salesInfo",!0),n=void 0==r(o,a)?{name_user:""}:r(o,a)),n},getSalesOrCustInfoById=function(e){var t=null,n=e,o=function(e){for(var t=ComboBoxSources.getRecords("salesAndCust_name"),n=0;n<t.length;n++)if(t[n].id==e)return t[n]};return t=o(n),null==t&&(ComboBoxSources.load("salesInfo",!0),t=void 0==o(n)?{name_user:""}:o(n)),t},getAgentInfoByName=function(e){for(var t=ComboBoxSources.getRecords("salesAgent"),n=0;n<t.length;n++)if(t[n].agentName==e)return t[n];if(!e)return""},getCustomerInfoByName=function(e){for(var t=ComboBoxSources.getRecords("custService"),n=0;n<t.length;n++)if(t[n].username==e)return t[n];if(!e)return""},getSalesInfoByName=function(e){for(var t=ComboBoxSources.getRecords("salesInfo"),n=0;n<t.length;n++)if(t[n].username==e)return t[n];if(!e)return""},getSatffInfoByKey=function(e){for(var t=e.keys||"",n=e.map||"",o=e.words||"",a=ComboBoxSources.getRecords(n),r=0;r<a.length;r++)if(void 0!=a[r][t]){if(a[r][t]==o)return a[r]}else{if(void 0==a[r].userInfo)return"";if(a[r].userInfo[t]==o)return a[r]}if(!o)return""},getConditionParams=function(e,t){var n=e,t=void 0==t?20:t,o={condition:[],filterscount:0,groupscount:0,sortorder:"desc",pagenum:0,pagesize:t};for(var a in n)0!=n[a].value.length&&(n[a].key=a,o.condition.push(n[a]));return o=(new Base64).encode(JSON.stringify(o))},setUrlCondition=function(e){var t=void 0===e.beginDate||""===e.beginDate||null===e.beginDate?"2015-01-01":e.beginDate,n=void 0===e.endDate||""===e.endDate||null===e.endDate?getNowFormatDate():e.endDate,o=void 0===e.key||""===e.key||null===e.key?"o.createDate":e.key,a={condition:[],filterscount:0,groupscount:0,pagenum:0,pagesize:20},r=[],i={};return i.key=o,i.action="between",i.value=[t,n],r.push(i),a.condition=r,""===t&&""===n&&(a.condition=[]),a=(new Base64).encode(JSON.stringify(a))},ZqwTab_Mgt=function(e){var t=this;this.maxLength=10,this.tab_array=[],this.initTab=function(e){},this.addTab=function(e,n,o,a){var r=$("#zqw_tabs"),i=$("#mainTab"),l=r.find("ul li"),s=$('<li><a class="zqwTab_a" data="'+e+'" data-scrollY="0">'+n+'</a><i class="md-cancel close-tab"></i></li>');null!=a&&s.data("map",a);var d=$('<div class="zqwTab"></div>');d.html(o);var c=$(document).scrollTop();r.find("ul li.active").attr("data-scrollY",c);r.find("ul").children().length>0?(e>0?(l.eq(e).after(s),i.children(".zqwTab").eq(e).after(d)):(r.find("ul").append(s),i.append(d)),l.removeClass("active"),i.children(".zqwTab").removeClass("active"),s.addClass("active"),d.addClass("active")):(r.find("ul").append(s),i.append(d),s.addClass("active"),d.addClass("active"),s.find("i").remove());var u=$.Event("add");if(i.trigger(u,[e,n,o]),s.find("i.close-tab").on({click:function(e){var n=$(this).parent().index();e.preventDefault(),t.removeTab(n)}}),s.find("a").on({click:function(e){var n=$(this).parent().index();t.clickTab(n)}}),window.scrollTo(0,0),l.length>t.maxLength){l.eq(1).remove(),i.children(".zqwTab").eq(1).remove();var u=$.Event("removed");i.trigger(u,1)}},this.addCloseEvent=function(e,n){var o=$("#zqw_tabs");void 0===n&&(n=function(){}),n instanceof Function||(n=function(){}),void 0===e&&(e=t.selectedIndex()),0!=e&&o.find("ul li").eq(e).find("i.close-tab").off("click").on({click:function(e){setPara(),e.preventDefault();var o=$(this).parent().index();Core.confirm({message:"确定要关闭吗？",confirmCallback:function(){t.removeTab(o),n()}})}})},this.setContent=function(e,t){$("#mainTab").children().eq(e).html(t)},this.setTitle=function(e,t){$("#zqw_tabs").children("ul").children().eq(e).children().eq(0).text(t)},this.getTitle=function(e){return $("#zqw_tabs").children("ul").children().eq(e).children().eq(0).text()},this.removeTab=function(e){var n=$("#zqw_tabs"),o=$("#mainTab");n.find("ul li").eq(e).remove(),o.children(".zqwTab").eq(e).remove();var a=$.Event("removed");o.trigger(a,e);var r=e-1;r>0?t.clickTab(r):t.clickTab(0)},this.clickTab=function(e){$("#appendTitleStyle").css({display:"none"});var t=$("#mainTab"),n=$("#zqw_tabs");e!=t.find(".zqwTab.active").index()&&($("#floatImg>img").remove(),$("#floatImg").css("display","none"),$("#floatImg_rotate").addClass("hide"));var o=n.find("ul li"),a=t.children("div"),r=$(document).scrollTop();n.find("ul li.active").attr("data-scrollY",r);o.removeClass("active"),o.eq(e).addClass("active"),a.removeClass("active"),a.eq(e).addClass("active");var r=o.eq(e).attr("data-scrollY");void 0!=r&&window.scrollTo(0,r);var i=$.Event("selected");t.trigger(i,e)},this.selectedIndex=function(){$("#appendTitleStyle").css({display:"none"});return $("#zqw_tabs").find("ul li.active").index()}},chooseAddress=function(e,t){$(".addressLabel").removeClass("addSuccImg").find("img").remove(),$(t).find("input").val(""),$(t).find("textarea").val(""),$(e).on("keyup focus",function(){$(".addressLabel").removeClass("addSuccImg").find("img").remove();var e=$(this).val();$.each($(".addressLabel"),function(t,n){if(e==$(n).text().trim()){$(n).addClass("addSuccImg").append('<img alt="" src="images/common/success.png" class="succImg">')}})}),$(t).find(".addressLabel").off("click").on("click",function(){var t=$(this),n=t.text().trim(),o=t.hasClass("addSuccImg");if($(".addressLabel").removeClass("addSuccImg").find("img").remove(),o)t.find("img").remove(),t.removeClass("addSuccImg"),$(e).val("");else{t.addClass("addSuccImg").append('<img alt="" src="images/common/success.png" class="succImg">'),$(e).val(n)}})},initChoose=function(e){$(".addressLabel").removeClass("addSuccImg").find("img").remove(),$.each($(".addressLabel"),function(t,n){if(e==$(n).text().trim()){$(n).addClass("addSuccImg").append('<img alt="" src="images/common/success.png" class="succImg">')}})},getCustomerComboboxSource=function(e){var t=e.soOwnerId,n=e.userName,o=e.target,a=e.callback||function(){};Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/clientInfos/"+t+"/"+n),type:"GET",callback:function(e){var t=$.extend(!0,[],e);$.each(t,function(e,t){var n="";""!=t.telephone&&null!=t.telephone&&(n="("+t.telephone+")");var o="";""!=t.backupTelephone&&null!=t.backupTelephone&&(o="("+t.backupTelephone+")"),t.name_np=t.name,t._name=t.name+n+o;var a=void 0===t.namePinyin?"":t.namePinyin,r=void 0===t.namePy?"":t.namePy;t.name=t.name+n+o+"<VV>"+a+r+"</VV>"}),void 0!=o&&o.comboBox({renderSelectedItem:refNameByPinyin_client,source:t,displayMember:"name",valueMember:"clientInfoid",placeHolder:"请输入或选择客户",width:"90.888%",height:33,theme:currentTheme}),a(t)},failure:function(e){}})},getProductInUsePart=function(e,t,n){Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/productsVO/"+e+"/"+t),type:"GET",async:!1,callback:function(e){var t={};t.product=$.extend(!0,[],e),t.product_server=t.product;var o=$.extend(!0,[],e);$.each(o,function(e,t){var n="";""!=t.sku&&null!=t.sku&&(n="("+t.sku+")"),t.name=t.name+n,t._name=t._name+n}),t.product_Part=o;var a=$.extend(!0,[],e),r=[];$.each(a,function(e,t){t.available&&r.push(t)}),t.productsInUse_server=a,t.productsInUse=t.productsInUse_server;var i=$.extend(!0,[],e);$.each(i,function(e,t){var n="";""!=t.sku&&null!=t.sku&&(n="("+t.sku+")"),t.name=t.name+n,t._name=t._name+n}),t.productsInUse_Part=i,n(t)},failure:function(e){}})},getAcOwnerInformation=function(e,t){Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/ownerinformation/"+e+"/"+t),type:"GET",async:!1,callback:function(e){_global_settings.acOwner=e,_global_settings.acOwner.easyGridSetting=t;var t={},n={producttypeFlag:"remark",productKgFlag:"weight",productNumberFlag:"sku",productCoLorFlag:"prodColourId",productSpeFlag:"prodSpecId"};for(var o in n)"false"==e[o]&&(t[o]=n[o])},failure:function(e){}})},getACFileSrc=function(e,t,n,o){Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/down/"+(new Base64).encode("toocr/order/downFile/"+e+"/"+t+"/"+n),type:"GET",showMsg:!1,dataType:"text",callback:function(e){o(e)},failure:function(e){}})},initOcrOrderFileList=function(e){var t=e.soOwnerId,n=e.userName,o=e.orderId,a=e.attachmentEl,r=e.listEl,i=e.type;""!=id&&((i="photo")?Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/orderfileinfo/"+i+"/sales/"+o+"/"+t+"/"+n),type:"GET",showMsg:!1,callback:function(e){var t=[];for(var n in e)t.push(e[n].id);loadImgSpan(t,r,a)},failure:function(e){}}):(i="other")&&Core.AjaxRequest({url:_global_settings.service.url+"/SimpleAC/"+(new Base64).encode("toocr/order/orderfileinfo/"+i+"/sales/"+o+"/"+t+"/"+n),type:"GET",showMsg:!1,callback:function(e){var t=[];for(var n in e)t.push(e[n].id);$(a).fileuploader({readonly:!0,filelist:t.toString()})},failure:function(e){}}))},loadImgSpan=function(e,t,n,o,a){for(var r in e){var i='<div data-id="'+e[r]+'"  class="item col-md-2 viewimgDetailRow p-t-15"> <form class="imgFile">                                                                                                                         \t       <div class="col-md-12">                                                                                                                      \t\t\t  <div class="viewimgDetailRowImgCell" style="height:100pt">                                                                                                                    \t\t\t      <img class="viewimgDetailRowImg" src="" style="width: 100%; height: 100%;position: relative; cursor:pointer;" class="img0" alt="双击查看大图" title="双击查看大图"> \t\t\t  </div>                                                                                                                                    \t\t\t  </div>                                                                                                                                    \t       </div>                                                                                                                                       \t   </form></div>';$(t).append(i)}$(t).removeClass("viewimgDetailRowList").addClass("viewimgDetailRowList")},clearTimeOutList=function(e){var t={not:[]};if(e=$.extend(!0,t,e),window.timeOutList){for(var n in window.timeOutList){var o=window.timeOutList[n];$.strInArr(o,e.not)||clearTimeout(o)}window.timeOutList=[]}},getgridcheckedsum=function(e,t){var n=t.getData(),o=ComboBoxSources.getArrSourceOrderByKey(n,"waitdel",!0),a=0;for(var r in o){var i=o[r];null!=i[e]&&""!=i[e]&&(a+=parseFloat(i[e]))}return a},refNameByPinyin=function(e,t){var t=t.originalItem;if(null!=t&&null!=(t=t.name)){return t}},refNameByPinyin_client=function(e,t){var t=t.originalItem;if(null!=t&&null!=(t=t._name)){return t}},t_img,isLoad=!0;$(document).on("keyup","input",function(e){var t=$(this).parents(".jqx-combobox"),n=$(this).data("blacklist"),o=$(this).val(),a=/ /;null!=n&&a.test(o)&&($(this).val(o.replace(/ /g,"")),$(this).trigger("keyup")),t.length>0&&(a.test(o)&&($(this).val(o.replace(/ /g,"")),$(this).trigger("keyup")),0==$(this).val().length&&8==e.keyCode&&$(this).prev().length>0&&-1==$(this).prev().attr("class").indexOf("jqx-combobox-multi-item")&&(t.jqxComboBox("clearSelection"),t.trigger("change")))});var getUploadFileIcon=function(e,t,n){var o=e.lastIndexOf(".");if(o>-1){var e=e.substring(o+1,e.length).toLocaleUpperCase();return $.strInArr(e,["JPG","JPEG","PNG","GIF","BMP"])?'<img class="thumbnailImg" style="width:30px;height:30px;" src="'+n+'">':'<img style="width:30px;height:30px;" src="images/common/filetypeicon/'+e+'.png">'}return""};$.keepCookie=function(e){e=null==e?10:e,Core.AjaxRequest({url:ws_url+"/CXF/rs/common/nothing",type:"GET",showMsg:!1,callback:function(t){setTimeout(function(){$.keepCookie(e)},6e4*e)}})};var grid_renders=function(e){var t={localdata:e,datatype:"json",datafields:[{name:"orderNumber",type:"string"},{name:"serviceType",type:"string"},{name:"orderType",type:"bool"},{name:"telephone",type:"string"},{name:"userName",type:"string"},{name:"ownerName",type:"string"},{name:"submitDate",type:"string"},{name:"id",type:"string"},{name:"soOwnerId",type:"string"},{name:"boundindex",type:"string"},{name:"uid",type:"string"},{name:"uniqueid",type:"string"},{name:"visibleindex",type:"string"}],addrow:function(e,t,n,o){o(!0)},deleterow:function(e,t){t(!0)},updaterow:function(e,t,n){n(!0)}};return new $.jqx.dataAdapter(t)},connectWebsocket=function(e){var t=null,n=null,e=e||function(){};if(null!=n){if(n.readyState<=1)return;n=null}var o="ws://"+window.location.host+ws_url+"/websocket/ocrreq";if("WebSocket"in window)n=new WebSocket(o);else{if(!("MozWebSocket"in window))return void Core.alert({message:"请改用支持WebSocket的浏览器"});n=new MozWebSocket(o)}n.onopen=function(e){t&&(clearInterval(t),t=null)},n.onclose=function(n){null==t&&(t=setTimeout(function(){connectWebsocket(e)},3e3))},n.onerror=function(n){null==t&&(t=setTimeout(function(){connectWebsocket(e)},3e3))},n.onmessage=function(n){t&&(clearInterval(t),t=null);var o=JSON.parse(n.data);if("error"==o.type){if(Core.alert({message:o.data.errorMsg}),401==o.data.errorCode)return void(window.location.href=ws_url+"/page/login/login.jsp");Core.alert({message:o.data.errorMsg})}else"newOcrReq"==o.type&&e(o)},window.onbeforeunload=function(){n.close()}};connectWebsocket(function(e){""!=e&&void 0!=e&&void 0!=e.data&&("ocr:checkOrder"==e.data&&"Ocr_auditor"==_global_settings.owner.roleName&&($("#userInformationGrid").length>=0&&($("#userInformationGrid").jqxGrid("updatebounddata","cells"),window.initPlaceOrders()),popNotice("images/1014.mp3")),"ocr:stayOrder"==e.data&&"Ocr_createBy"==_global_settings.owner.roleName&&($("#userInformationGrid").length>=0&&($("#userInformationGrid").jqxGrid("updatebounddata","cells"),window.initPlaceOrders()),popNotice("images/1014.mp3")))});var setPara=function(){$("#floatImg>img").remove(),$("#floatImg").css("display","none"),$("#floatImg_rotate").addClass("hide")},rejectOcrOrder=function(e){var t=function(){$("#unkownWriting").data({type:"kfRejectFont",uuid:e}),$("#unkownInformation").data({type:"kfRejectInfo",uuid:e})},n=function(){$("#unkownWriting")[0].checked=!0,$("#unkownInformation")[0].checked=!1,$("#ocrOrderReject").modal("show"),t()};0==$("#ocrOrderReject").length?$.loadModal("page/common/segment/ocrOrderReject.html",function(e){$("body").append(e),n()}):n()},popNotice=function(e){var t,n=document.createElement("audio");if("[object Array]"===Object.prototype.toString.call(e)&&e.length>0)for(var o=0;o<e.length;o++)t=document.createElement("source"),t.src=e[o],t.type="audio/"+e[o].match(/\.([^\.]+)$/)[1],n.appendChild(t);else n.src=e;void 0!=e&&n.play();var a=window.Notification||window.mozNotification||window.webkitNotification;if(a)if("granted"==a.permission){var r=new a("新通知",{body:"您有新的单子来了,请留意总览信息！",icon:document.querySelectorAll("link[rel~=shortcut]")[0].href});r.onshow=function(){setTimeout(function(){r.close()},1e4)},r.onclick=function(){window.focus(),setTimeout(function(){r.close()},5e3)}}else"granted"!=a.permission&&a.requestPermission(function(e){a.permission!==e&&(a.permission=e);new a("新通知",{body:"您有新的单子来了,请留意总览信息！",icon:document.querySelectorAll("link[rel~=shortcut]")[0].href})})};