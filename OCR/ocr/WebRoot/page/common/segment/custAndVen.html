<meta charset="utf-8">
<!-- 编辑客户和供应商 -->
<div id="editCustAndVen" class="modal fade"
	tabindex="-1" role="dialog" aria-labelledby="full-width-modalLabel"
	aria-hidden="true">
	<div class="modal-dialog ">
		<div class="modal-content">
			<!--模态框头部-->
			<div class="modal-header">
				<div class="quotation-nav">
					<div class="row">
						<div class="quotation-nav-left" style="">
							<b id="showHead" style="margin-left: 20px;"></b>
						</div>
						<div class="quotation-nav-right">
							<button type="button" class="close-modal btn-r"
								data-dismiss="modal" aria-hidden="true">
								<i class="glyphicon glyphicon-remove" style="padding: 0;"></i>
							</button>
						</div>
					</div>
				</div>
			</div>
			<!--模态框body-->
			<div class="modal-body">
				<div class="row container">
					<input class="hide" type="text" id="custAndVen-id">
					<input class="hide" type="text" id="custAndVen-selectId">
					<div class="col-sm-offset-2 col-sm-8 p-t-30">
						<div class="row">
							<div class="form-horizontal">
								<div class="form-group">
									<label id="custVenName" class="control-label col-sm-3"></label>
									<div class="col-sm-8">
										<input data-blacklist=' ' id='custAndVenName' type="text"
											class="form-control">
										<!-- input-group -->
									</div>
									<label class="mustword">*</label>
								</div>
							</div>
						</div>
					</div>
					<div class="col-sm-offset-2 col-sm-8 p-t-10">
						<div class="row">
							<div class="form-horizontal">
								<div class="form-group">
									<label class="control-label col-sm-3">电话</label>
									<div class="col-sm-8">
										<input id='custAndVenPhone' type="text"
											class="form-control">
										<!-- input-group -->
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-sm-offset-2 col-sm-8 p-t-10">
						<div class="row">
							<div class="form-horizontal">
								<div class="form-group">
									<label class="control-label col-sm-3">备用电话</label>
									<div class="col-sm-8">
										<input id='custAndVenPhone2' type="text"
											class="form-control">
										<!-- input-group -->
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-sm-offset-9 col-sm-3 p-t-10 text-right">
						<a class="editCustAndVendor hoverspan" data-dismiss="modal">详情设置》</a>
					</div>
				</div>
			</div>
			<!--模态框脚页-->
			<div class="modal-footer p-t-10" style="padding: 20px;">
				<!-- <button type="button" class="btn btn-success cancleBtn" data-dismiss="modal">取消</button> -->
				<button type="button" id='custAndVenBtn'
					class="btn btn-success" style="width:75px">保存</button>  <!-- data-dismiss="modal" -->
			</div>
		</div>
	</div>
	<!-- /.modal-dialog -->
</div>

<script>
	$('#custAndVenBtn').on('click',function(){
		if(!$("#editCustAndVen").jqxValidator("validate")){
			return false;
		}
		
		var selectId=$('#custAndVen-selectId').val();
		var type='clientInfo_p';
		
		var json=$('#custAndVen-id').data('json');
		json.userInfo.name=$('#custAndVenName').val();
		json.userInfo.telephone=$('#custAndVenPhone').val();
		json.userInfo.backupTelephone=$('#custAndVenPhone2').val();
		/* console.log(json); */
		
		Core.AjaxRequest({            
			url:_global_settings.service.url+'/clientinfo/update',
			type: "PUT",
            params:json,
            async:false,
            callback: function(res) {
            	
            	ComboBoxSources.load('vendor',true);          
        		ComboBoxSources.load('customer',true);
        		ComboBoxSources.load('clientInfo',true);   
        		ComboBoxSources.load('userinfo'); 
            	
        		//setTimeout(function(){
            		try{
            			//debugger
            			//if(selectId.indexOf('PO')>-1){
            				//type='vendor_p';
            			//}
       					$('#'+selectId).jqxComboBox({
           					source:ComboBoxSources.getRecords(type),
           					displayMember: "name", 
           					valueMember: "clientInfoid"
           				});
           				$('#'+selectId).val(json.id);
            		}catch(e){}
            		
            		try{
            			CPload(json.id,new Date().getTime());
            		}catch(e){}
            		
					try{
						verdorM(json.id,new Date().getTime());
            		}catch(e){}
            		
            		try{
            			$('#customer-cust').comboBox({
            	            source: ComboBoxSources.getRecords('customer_all_p'),
            	            theme: currentTheme,
            	            displayMember: 'name',
            	            valueMember: 'name_np',
            	            width: '100%',
            	            height: '34px',
            	            placeHolder: '请输入客户名或电话'
            	        });
            		}catch(e){}
        		//},50);
            		
        		$("#editCustAndVen").modal("hide");
            },
            failure:function(res){
            }
        });
		
	})
</script>


